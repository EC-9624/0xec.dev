{
  "version": 3,
  "sources": ["../src/utils.js", "../src/validation.js", "../src/prefetch.js", "../src/progress-bar.js", "../src/filter.js", "../src/expandable-row.js", "../src/masonry.js", "../src/kanban.js", "../src/components/ec-toast-container.js", "../src/components/ec-dropdown.js", "../src/components/ec-drawer.js", "../src/components/ec-tag-select.js", "../src/components/ec-mobile-nav.js", "../src/components/ec-markdown-toolbar.js", "../src/editor/editor-core.js", "../src/editor/markdown-editor.js", "../src/editor/post-editor.js", "../src/editor/split-editor.js"],
  "sourcesContent": ["/**\n * Shared Utilities Module\n * Common helper functions used across JavaScript components\n */\n\n/**\n * Execute callback when DOM is ready\n * @param {Function} callback - Function to execute when DOM is ready\n */\nexport function onReady(callback) {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', callback);\n  } else {\n    callback();\n  }\n}\n\n/**\n * Setup click outside handler with cleanup capability\n * @param {HTMLElement[]} elements - Elements to check if click is inside\n * @param {Function} callback - Callback when click is outside all elements\n * @returns {Function} Cleanup function to remove the listener\n */\nexport function onClickOutside(elements, callback) {\n  const handler = (e) => {\n    const isOutside = elements.every(el => !el?.contains(e.target));\n    if (isOutside) callback(e);\n  };\n  document.addEventListener('click', handler);\n  return () => document.removeEventListener('click', handler);\n}\n\n/**\n * Initialize components on HTMX content updates\n * @param {string} selector - CSS selector for elements to initialize\n * @param {Function} initFn - Initialization function for each element\n * @param {Object} options - Options\n * @param {string} options.event - HTMX event to listen for (default: 'htmx:afterSettle')\n */\nexport function initOnHtmx(selector, initFn, options = {}) {\n  const event = options.event || 'htmx:afterSettle';\n  document.addEventListener(event, (e) => {\n    const target = e.detail?.elt;\n    if (!target) return;\n\n    // Check if target itself matches\n    if (target.matches?.(selector)) {\n      initFn(target);\n    }\n\n    // Check children\n    if (target.querySelectorAll) {\n      target.querySelectorAll(selector).forEach(initFn);\n    }\n  });\n}\n\n/**\n * Cleanup components before HTMX swaps content\n * @param {string} selector - CSS selector for elements to cleanup\n * @param {Function} cleanupFn - Cleanup function for each element\n */\nexport function cleanupOnHtmx(selector, cleanupFn) {\n  document.addEventListener('htmx:beforeSwap', (e) => {\n    const target = e.detail?.elt;\n    if (!target?.querySelectorAll) return;\n\n    target.querySelectorAll(selector).forEach(cleanupFn);\n  });\n}\n\n/**\n * Escape HTML to prevent XSS\n * @param {string} text - Text to escape\n * @returns {string} Escaped HTML string\n */\nexport function escapeHtml(text) {\n  const div = document.createElement('div');\n  div.textContent = text;\n  return div.innerHTML;\n}\n\n/**\n * Debounce function execution\n * @param {Function} fn - Function to debounce\n * @param {number} delay - Delay in milliseconds\n * @returns {Function} Debounced function\n */\nexport function debounce(fn, delay) {\n  let timeoutId;\n  return function (...args) {\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(() => fn.apply(this, args), delay);\n  };\n}\n\n/**\n * Generate unique ID\n * @param {string} prefix - Optional prefix for the ID\n * @returns {string} Unique ID string\n */\nexport function uniqueId(prefix = 'uid') {\n  return `${prefix}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// Expose globally for backward compatibility\nwindow.Utils = {\n  onReady,\n  onClickOutside,\n  initOnHtmx,\n  cleanupOnHtmx,\n  escapeHtml,\n  debounce,\n  uniqueId,\n};\n", "/**\n * Client-side form validation for admin forms.\n * Works with data-validate attribute on forms.\n * Uses data-error-* attributes on inputs for custom error messages.\n *\n * Supported validations:\n * - required: data-error-required=\"Custom message\"\n * - maxlength: data-error-maxlength=\"Custom message\"\n * - pattern: data-error-pattern=\"Custom message\"\n * - url: data-error-url=\"Custom message\" (for type=\"url\" inputs)\n */\n\nimport { onReady } from './utils.js';\n\n// URL pattern for validation\nconst URL_PATTERN = /^https?:\\/\\/.+/i;\n\n/**\n * Validate a single input field\n * @param {HTMLInputElement|HTMLTextAreaElement} input\n * @returns {string|null} Error message or null if valid\n */\nexport function validateField(input) {\n  const value = input.value.trim();\n  const type = input.type;\n\n  // Required validation\n  if (input.hasAttribute('required') && value === '') {\n    return input.dataset.errorRequired || 'This field is required';\n  }\n\n  // Skip other validations if empty and not required\n  if (value === '') {\n    return null;\n  }\n\n  // Maxlength validation\n  if (input.hasAttribute('maxlength')) {\n    const maxLen = parseInt(input.getAttribute('maxlength'), 10);\n    if (value.length > maxLen) {\n      return input.dataset.errorMaxlength || `Cannot exceed ${maxLen} characters`;\n    }\n  }\n\n  // Pattern validation\n  if (input.hasAttribute('pattern')) {\n    const pattern = new RegExp('^' + input.getAttribute('pattern') + '$');\n    if (!pattern.test(value)) {\n      return input.dataset.errorPattern || 'Invalid format';\n    }\n  }\n\n  // URL validation (for type=\"url\" inputs)\n  if (type === 'url' && value !== '') {\n    if (!URL_PATTERN.test(value)) {\n      return input.dataset.errorUrl || 'Must be a valid URL';\n    }\n  }\n\n  return null;\n}\n\n/**\n * Show error for a field\n * @param {HTMLInputElement|HTMLTextAreaElement} input\n * @param {string} message\n */\nexport function showError(input, message) {\n  // Add error class to input\n  input.classList.add('input-error');\n  input.classList.remove('input-valid');\n\n  // Find or create error element\n  let errorEl = input.parentElement.querySelector('.field-error');\n  if (!errorEl) {\n    errorEl = document.createElement('p');\n    errorEl.className = 'field-error';\n    // Insert after the input (or after any existing elements in the space-y-2 container)\n    input.parentElement.appendChild(errorEl);\n  }\n\n  errorEl.textContent = message;\n  errorEl.style.display = 'block';\n}\n\n/**\n * Clear error for a field\n * @param {HTMLInputElement|HTMLTextAreaElement} input\n * @param {boolean} showValid - Whether to show valid state\n */\nexport function clearError(input, showValid = false) {\n  input.classList.remove('input-error');\n\n  if (showValid && input.value.trim() !== '') {\n    input.classList.add('input-valid');\n  } else {\n    input.classList.remove('input-valid');\n  }\n\n  // Hide error element (but don't remove - it might be server-rendered)\n  const errorEl = input.parentElement.querySelector('.field-error');\n  if (errorEl) {\n    errorEl.style.display = 'none';\n  }\n}\n\n/**\n * Validate all fields in a form\n * @param {HTMLFormElement} form\n * @returns {boolean} True if all fields are valid\n */\nexport function validateForm(form) {\n  let isValid = true;\n  const inputs = form.querySelectorAll('input, textarea, select');\n\n  inputs.forEach((input) => {\n    // Skip hidden inputs and buttons\n    if (input.type === 'hidden' || input.type === 'submit' || input.type === 'button') {\n      return;\n    }\n\n    const error = validateField(input);\n    if (error) {\n      showError(input, error);\n      isValid = false;\n    } else {\n      clearError(input);\n    }\n  });\n\n  // If invalid, scroll to first error\n  if (!isValid) {\n    const firstError = form.querySelector('.input-error');\n    if (firstError) {\n      firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      firstError.focus();\n    }\n  }\n\n  return isValid;\n}\n\n/**\n * Initialize validation for a form\n * @param {HTMLFormElement} form\n */\nexport function initForm(form) {\n  // Validate on blur\n  form.addEventListener(\n    'blur',\n    function (e) {\n      const input = e.target;\n      if (input.tagName === 'INPUT' || input.tagName === 'TEXTAREA') {\n        const error = validateField(input);\n        if (error) {\n          showError(input, error);\n        } else {\n          clearError(input, true);\n        }\n      }\n    },\n    true\n  );\n\n  // Clear error on input (gives immediate feedback as user types)\n  form.addEventListener(\n    'input',\n    function (e) {\n      const input = e.target;\n      if (input.classList.contains('input-error')) {\n        const error = validateField(input);\n        if (!error) {\n          clearError(input, true);\n        }\n      }\n    },\n    true\n  );\n\n  // Validate on submit\n  form.addEventListener('submit', function (e) {\n    if (!validateForm(form)) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  });\n}\n\n/**\n * Initialize all forms with data-validate attribute\n */\nexport function init() {\n  const forms = document.querySelectorAll('form[data-validate]');\n  forms.forEach(initForm);\n}\n\n// Initialize on DOM ready\nonReady(init);\n\n// Re-initialize after HTMX swaps (for dynamic content)\ndocument.addEventListener('htmx:afterSwap', function (e) {\n  if (e.detail && e.detail.target) {\n    const forms = e.detail.target.querySelectorAll('form[data-validate]');\n    forms.forEach(initForm);\n  }\n});\n\n// Export for manual initialization\nwindow.FormValidation = {\n  init,\n  initForm,\n  validateForm,\n  validateField,\n};\n", "/**\n * Smart Prefetching - Aggressive prefetch strategy for instant navigation\n *\n * Combines three prefetch strategies:\n * 1. Intersection Observer - prefetch links as they enter viewport (background)\n * 2. Touchstart - prefetch on mobile touch before tap completes\n * 3. Mouseenter - prefetch on desktop hover\n *\n * All methods share a deduplication set to avoid redundant requests.\n */\n\nimport { onReady } from './utils.js';\n\n// Track prefetched URLs to avoid duplicates\nconst prefetched = new Set();\n\n// Track observed links for cleanup\nlet observer = null;\n\n/**\n * Check if a URL should be prefetched\n */\nfunction shouldPrefetch(url) {\n  // Must be a string\n  if (typeof url !== 'string') return false;\n\n  // Skip if already prefetched\n  if (prefetched.has(url)) return false;\n\n  // Only internal links (start with /)\n  if (!url.startsWith('/')) return false;\n\n  // Skip static assets\n  if (url.startsWith('/static/')) return false;\n\n  // Skip admin routes\n  if (url.startsWith('/admin')) return false;\n\n  // Skip feed/XML files\n  if (url.endsWith('.xml')) return false;\n\n  // Skip hash links\n  if (url.includes('#')) return false;\n\n  // Skip current page\n  if (url === window.location.pathname) return false;\n\n  return true;\n}\n\n/**\n * Prefetch a URL using <link rel=\"prefetch\">\n * @param {string} url - The URL to prefetch\n * @param {string} source - The source that triggered the prefetch (viewport, touch, hover)\n */\nexport function prefetch(url, source) {\n  if (!shouldPrefetch(url)) return;\n\n  prefetched.add(url);\n\n  // Use <link rel=\"prefetch\"> for browser-optimized caching\n  const link = document.createElement('link');\n  link.rel = 'prefetch';\n  link.href = url;\n  link.as = 'document';\n  document.head.appendChild(link);\n}\n\n/**\n * Get the href from a link element or its parent\n */\nfunction getLinkHref(element) {\n  const link = element.closest('a[href]');\n  return link ? link.getAttribute('href') : null;\n}\n\n/**\n * Initialize Intersection Observer for viewport prefetching\n */\nfunction initViewportPrefetch() {\n  // Check for IntersectionObserver support\n  if (typeof IntersectionObserver === 'undefined') return;\n\n  // Disconnect existing observer if any\n  if (observer) {\n    observer.disconnect();\n  }\n\n  observer = new IntersectionObserver(\n    function (entries) {\n      entries.forEach(function (entry) {\n        if (entry.isIntersecting) {\n          const href = entry.target.getAttribute('href');\n          prefetch(href, 'viewport');\n          observer.unobserve(entry.target);\n        }\n      });\n    },\n    {\n      // Start prefetching when link is 100px from viewport\n      rootMargin: '100px',\n    }\n  );\n\n  // Observe all internal links\n  observeLinks();\n}\n\n/**\n * Observe all prefetchable links on the page\n */\nexport function observeLinks() {\n  if (!observer) return;\n\n  document.querySelectorAll('a[href^=\"/\"]').forEach(function (link) {\n    const href = link.getAttribute('href');\n    if (shouldPrefetch(href)) {\n      observer.observe(link);\n    }\n  });\n}\n\n/**\n * Initialize touchstart prefetching for mobile\n */\nfunction initTouchPrefetch() {\n  document.addEventListener(\n    'touchstart',\n    function (e) {\n      const href = getLinkHref(e.target);\n      if (href) {\n        prefetch(href, 'touch');\n      }\n    },\n    { passive: true }\n  );\n}\n\n/**\n * Initialize mouseenter prefetching for desktop\n */\nfunction initHoverPrefetch() {\n  document.addEventListener(\n    'mouseenter',\n    function (e) {\n      if (e.target.tagName === 'A') {\n        const href = e.target.getAttribute('href');\n        prefetch(href, 'hover');\n      }\n    },\n    { capture: true, passive: true }\n  );\n}\n\n/**\n * Initialize all prefetch strategies\n */\nexport function init() {\n  initViewportPrefetch();\n  initTouchPrefetch();\n  initHoverPrefetch();\n}\n\n// Initialize HTMX listener\nfunction initHTMXListener() {\n  document.body.addEventListener('htmx:afterSettle', function () {\n    // Small delay to ensure DOM is fully updated\n    setTimeout(observeLinks, 100);\n  });\n}\n\n// Initialize when DOM is ready\nonReady(function () {\n  init();\n  initHTMXListener();\n});\n\n// Expose for debugging\nwindow.prefetchDebug = {\n  prefetched: prefetched,\n  prefetch: prefetch,\n  observeLinks: observeLinks,\n};\n", "/**\n * Progress Bar - NProgress-style loading indicator\n *\n * Shows a subtle animated bar at the top of the page during navigation.\n * Integrates with HTMX events and regular page loads.\n */\n\nimport { onReady } from './utils.js';\n\nlet bar = null;\nlet timeout = null;\nlet isRunning = false;\nlet currentProgress = 0;\n\n// Configuration\nconst CONFIG = {\n  minimum: 0.1, // Start at 10%\n  trickleSpeed: 200, // Trickle every 200ms\n  trickleAmount: 0.02, // Increase by 2% each trickle\n  speed: 200, // Animation speed\n  easing: 'ease-out',\n};\n\n/**\n * Create the progress bar element\n */\nfunction createBar() {\n  if (bar) return bar;\n\n  bar = document.createElement('div');\n  bar.className = 'progress-bar';\n  bar.innerHTML = '<div class=\"progress-bar-inner\"></div>';\n  document.body.appendChild(bar);\n\n  return bar;\n}\n\n/**\n * Set the progress (0 to 1)\n */\nexport function setProgress(n) {\n  n = Math.max(0, Math.min(1, n));\n  currentProgress = n;\n\n  const inner = bar.querySelector('.progress-bar-inner');\n  if (inner) {\n    inner.style.transform = 'translateX(' + (-100 + n * 100) + '%)';\n  }\n}\n\n/**\n * Increment progress by a random small amount\n */\nfunction trickle() {\n  if (currentProgress >= 1) return;\n\n  // Slow down as we get closer to complete\n  let amount = CONFIG.trickleAmount;\n  if (currentProgress > 0.5) amount = 0.01;\n  if (currentProgress > 0.8) amount = 0.005;\n\n  setProgress(currentProgress + Math.random() * amount);\n}\n\n/**\n * Start the progress bar\n */\nexport function start() {\n  if (isRunning) return;\n  isRunning = true;\n\n  createBar();\n  setProgress(CONFIG.minimum);\n  bar.classList.add('active');\n\n  // Start trickling\n  timeout = setInterval(trickle, CONFIG.trickleSpeed);\n}\n\n/**\n * Complete the progress bar\n */\nexport function done() {\n  if (!isRunning) return;\n\n  clearInterval(timeout);\n  setProgress(1);\n\n  // Fade out after completing\n  setTimeout(function () {\n    bar.classList.remove('active');\n    isRunning = false;\n\n    // Reset for next use\n    setTimeout(function () {\n      setProgress(0);\n    }, CONFIG.speed);\n  }, CONFIG.speed);\n}\n\n// HTMX Integration\nfunction initHTMXListeners() {\n  document.body.addEventListener('htmx:beforeRequest', function (e) {\n    // Show for boosted navigation or elements with hx-indicator\n    if (e.detail.boosted || e.detail.elt.hasAttribute('hx-indicator')) {\n      start();\n    }\n  });\n\n  document.body.addEventListener('htmx:afterSettle', function () {\n    done();\n  });\n\n  document.body.addEventListener('htmx:responseError', function () {\n    done();\n  });\n\n  document.body.addEventListener('htmx:sendError', function () {\n    done();\n  });\n}\n\n// Regular page load integration\nwindow.addEventListener('beforeunload', function () {\n  start();\n});\n\n// Initialize HTMX listeners when DOM is ready\nonReady(initHTMXListeners);\n\n// Expose globally for manual control if needed\nwindow.progressBar = {\n  start: start,\n  done: done,\n  set: setProgress,\n};\n", "/**\n * TableFilter - Reusable client-side table filtering\n *\n * Usage:\n *   const filter = new TableFilter({\n *     tableBodyId: 'bookmarks-tbody',\n *     searchId: 'bookmark-search',\n *     filters: [\n *       { id: 'status-filter', dataAttr: 'isPublic', match: (value, filterValue) => ... },\n *       { id: 'collection-filter', dataAttr: 'collectionId' }\n *     ],\n *     searchFields: ['title', 'url', 'domain'],\n *     storageKey: 'bookmarkFilters',\n *     tableCardSelector: '.card:has(#bookmarks-table)'\n *   });\n */\nexport class TableFilter {\n  /**\n   * @param {Object} options\n   * @param {string} options.tableBodyId - ID of the table tbody element\n   * @param {string} options.searchId - ID of the search input\n   * @param {Array<Object>} options.filters - Array of filter configurations\n   * @param {Array<string>} options.searchFields - Data attributes to search in\n   * @param {string} options.storageKey - Session storage key for persistence\n   * @param {string} options.tableCardSelector - CSS selector for table container (for hide/show)\n   */\n  constructor(options) {\n    this.tableBodyId = options.tableBodyId;\n    this.searchId = options.searchId;\n    this.filters = options.filters || [];\n    this.searchFields = options.searchFields || [];\n    this.storageKey = options.storageKey;\n    this.tableCardSelector = options.tableCardSelector;\n\n    this._initialized = false;\n  }\n\n  /**\n   * Initialize the filter - call after DOM is ready\n   */\n  init() {\n    if (this._initialized) return;\n    this._initialized = true;\n\n    // Restore saved filters\n    this.restore();\n\n    // Set up search input listener\n    const searchInput = document.getElementById(this.searchId);\n    if (searchInput) {\n      searchInput.addEventListener('input', () => this.apply());\n    }\n\n    // Set up filter dropdowns - listen for changes on hidden inputs\n    this.filters.forEach((filter) => {\n      const input = document.getElementById(filter.id);\n      if (input) {\n        input.addEventListener('change', () => this.apply());\n      }\n    });\n\n    // Initial filter application\n    this.apply();\n  }\n\n  /**\n   * Apply all filters to the table\n   * @returns {number} Count of visible rows\n   */\n  apply() {\n    const searchValue = document.getElementById(this.searchId)?.value.toLowerCase() || '';\n    const rows = document.querySelectorAll(`#${this.tableBodyId} tr`);\n    let visibleCount = 0;\n\n    // Get current filter values\n    const filterValues = {};\n    this.filters.forEach((filter) => {\n      filterValues[filter.id] = document.getElementById(filter.id)?.value || '';\n    });\n\n    rows.forEach((row) => {\n      let visible = true;\n\n      // Search filter\n      if (searchValue) {\n        const searchMatch = this.searchFields.some((field) => {\n          const value = row.dataset[field]?.toLowerCase() || '';\n          return value.includes(searchValue);\n        });\n        if (!searchMatch) visible = false;\n      }\n\n      // Apply each filter\n      if (visible) {\n        this.filters.forEach((filter) => {\n          const filterValue = filterValues[filter.id];\n          if (!filterValue) return; // Empty filter = no filtering\n\n          if (filter.match) {\n            // Custom match function\n            if (!filter.match(row, filterValue)) {\n              visible = false;\n            }\n          } else {\n            // Default: exact match on data attribute\n            const dataValue = row.dataset[filter.dataAttr] || '';\n            if (dataValue !== filterValue) {\n              visible = false;\n            }\n          }\n        });\n      }\n\n      row.style.display = visible ? '' : 'none';\n      if (visible) visibleCount++;\n    });\n\n    // Show/hide no results message and table\n    this._updateVisibility(visibleCount, rows.length);\n\n    // Save state\n    this.save();\n\n    return visibleCount;\n  }\n\n  /**\n   * Clear all filters\n   */\n  clear() {\n    // Clear search\n    const searchInput = document.getElementById(this.searchId);\n    if (searchInput) searchInput.value = '';\n\n    // Reset dropdowns\n    if (window.dropdowns) {\n      this.filters.forEach((filter) => {\n        const dropdown = window.dropdowns.get(filter.id);\n        if (dropdown) dropdown.reset('');\n      });\n    }\n\n    // Clear storage\n    if (this.storageKey) {\n      sessionStorage.removeItem(this.storageKey);\n    }\n\n    // Re-apply (will show all)\n    this.apply();\n  }\n\n  /**\n   * Save current filter state to session storage\n   */\n  save() {\n    if (!this.storageKey) return;\n\n    const state = {\n      search: document.getElementById(this.searchId)?.value || '',\n    };\n\n    this.filters.forEach((filter) => {\n      state[filter.id] = document.getElementById(filter.id)?.value || '';\n    });\n\n    sessionStorage.setItem(this.storageKey, JSON.stringify(state));\n  }\n\n  /**\n   * Restore filter state from session storage\n   */\n  restore() {\n    if (!this.storageKey) return;\n\n    const saved = sessionStorage.getItem(this.storageKey);\n    if (!saved) return;\n\n    try {\n      const state = JSON.parse(saved);\n\n      // Restore search\n      const searchInput = document.getElementById(this.searchId);\n      if (searchInput && state.search) {\n        searchInput.value = state.search;\n      }\n\n      // Restore dropdowns - need to wait for dropdown.js to initialize\n      setTimeout(() => {\n        if (window.dropdowns) {\n          this.filters.forEach((filter) => {\n            const value = state[filter.id];\n            if (value) {\n              const dropdown = window.dropdowns.get(filter.id);\n              if (dropdown) dropdown.reset(value);\n            }\n          });\n        }\n        this.apply();\n      }, 10);\n    } catch (e) {\n      console.warn('Failed to restore filter state:', e);\n    }\n  }\n\n  /**\n   * Update visibility of table and no-results message\n   * @private\n   */\n  _updateVisibility(visibleCount, totalCount) {\n    const noResults = document.getElementById('no-results');\n    const table = this.tableCardSelector ? document.querySelector(this.tableCardSelector) : null;\n\n    if (visibleCount === 0 && totalCount > 0) {\n      noResults?.classList.remove('hidden');\n      table?.classList.add('hidden');\n    } else {\n      noResults?.classList.add('hidden');\n      table?.classList.remove('hidden');\n    }\n  }\n}\n\n// ============================================\n// COMMON FILTER MATCHERS\n// ============================================\n\n/**\n * Matcher for boolean data attributes\n * @param {string} dataAttr - The data attribute name (e.g., 'isPublic')\n * @param {Object} valueMap - Maps filter values to expected boolean strings\n */\nTableFilter.booleanMatcher = function (dataAttr, valueMap) {\n  return function (row, filterValue) {\n    const dataValue = row.dataset[dataAttr];\n    if (valueMap && valueMap[filterValue] !== undefined) {\n      return dataValue === String(valueMap[filterValue]);\n    }\n    return dataValue === filterValue;\n  };\n};\n\n/**\n * Matcher for public/private status\n * Expects data-is-public=\"true\" or \"false\"\n */\nTableFilter.publicPrivateMatcher = function (row, filterValue) {\n  const isPublic = row.dataset.isPublic === 'true';\n  if (filterValue === 'public') return isPublic;\n  if (filterValue === 'private') return !isPublic;\n  return true;\n};\n\n/**\n * Matcher for draft/published status\n * Expects data-is-draft=\"true\" or \"false\"\n */\nTableFilter.draftPublishedMatcher = function (row, filterValue) {\n  const isDraft = row.dataset.isDraft === 'true';\n  if (filterValue === 'published') return !isDraft;\n  if (filterValue === 'draft') return isDraft;\n  return true;\n};\n\n/**\n * Matcher for bookmark status (public/private/favorite)\n */\nTableFilter.bookmarkStatusMatcher = function (row, filterValue) {\n  const isPublic = row.dataset.isPublic === 'true';\n  const isFavorite = row.dataset.isFavorite === 'true';\n\n  if (filterValue === 'public') return isPublic;\n  if (filterValue === 'private') return !isPublic;\n  if (filterValue === 'favorite') return isFavorite;\n  return true;\n};\n\n/**\n * Matcher for collection filter with \"none\" support\n * Expects data-collection-id=\"\" for unsorted, or a numeric ID\n */\nTableFilter.collectionMatcher = function (row, filterValue) {\n  const collectionId = row.dataset.collectionId || '';\n\n  if (filterValue === 'none') return collectionId === '';\n  return collectionId === filterValue;\n};\n\n// Export for use\nwindow.TableFilter = TableFilter;\n", "/**\n * Expandable Row Module\n * Reusable expand/collapse functionality for table rows with lazy-loaded content.\n * Used by Tags admin page for treeview patterns.\n *\n * Usage:\n * 1. Add data attributes to your rows:\n *    - data-expandable-id=\"<id>\" on the main row\n *    - data-expandable-type=\"<type>\" (e.g., \"tag\")\n *    - role=\"button\" for expandable rows\n *\n * 2. Add content container with:\n *    - id=\"<type>-content-<id>\"\n *    - hx-get=\"<endpoint>\"\n *    - hx-trigger=\"fetchContent\"\n *\n * 3. Add hidden details row with:\n *    - id=\"<type>-details-<id>\"\n *    - class=\"hidden\"\n *\n * 4. Add expand button with:\n *    - class=\"expand-btn\" inside the main row\n */\n\nimport { onReady } from './utils.js';\n\n/**\n * Configuration constants\n */\nconst CONFIG = {\n  /** CSS class for expand button */\n  EXPAND_BTN_CLASS: 'expand-btn',\n  /** CSS class for rotation animation */\n  ROTATE_CLASS: 'rotate-90',\n  /** CSS class to hide elements */\n  HIDDEN_CLASS: 'hidden',\n  /** Data attribute for expanded state */\n  EXPANDED_ATTR: 'data-expanded',\n  /** Data attribute for expandable ID */\n  ID_ATTR: 'data-expandable-id',\n  /** Data attribute for expandable type */\n  TYPE_ATTR: 'data-expandable-type',\n  /** Data attribute to mark content as loaded */\n  LOADED_ATTR: 'data-loaded',\n  /** HTMX trigger event name for lazy loading */\n  FETCH_TRIGGER: 'fetchContent',\n};\n\n/**\n * Track initialized rows to prevent duplicate setup\n * @type {Set<string>}\n */\nconst initializedRows = new Set();\n\n/**\n * Prefetch content for a row (only once)\n * @param {string} type - The type of expandable (e.g., \"tag\")\n * @param {string} id - The unique ID of the row\n */\nexport function prefetchRow(type, id) {\n  const contentDiv = document.getElementById(`${type}-content-${id}`);\n  if (contentDiv && !contentDiv.hasAttribute(CONFIG.LOADED_ATTR)) {\n    contentDiv.setAttribute(CONFIG.LOADED_ATTR, 'true');\n    if (typeof htmx !== 'undefined') {\n      htmx.trigger(contentDiv, CONFIG.FETCH_TRIGGER);\n    }\n  }\n}\n\n/**\n * Toggle expand/collapse for a row\n * @param {string} type - The type of expandable (e.g., \"tag\")\n * @param {string} id - The unique ID of the row\n */\nexport function toggleRow(type, id) {\n  const row = document.querySelector(`[${CONFIG.ID_ATTR}=\"${id}\"][${CONFIG.TYPE_ATTR}=\"${type}\"]`);\n  const detailsRow = document.getElementById(`${type}-details-${id}`);\n\n  if (!row || !detailsRow) {\n    console.warn(`[ExpandableRow] Missing elements for ${type}-${id}`);\n    return;\n  }\n\n  const expandBtn = row.querySelector(`.${CONFIG.EXPAND_BTN_CLASS}`);\n  const isExpanded = row.getAttribute(CONFIG.EXPANDED_ATTR) === 'true';\n\n  if (isExpanded) {\n    // Collapse\n    row.setAttribute(CONFIG.EXPANDED_ATTR, 'false');\n    row.setAttribute('aria-expanded', 'false');\n    detailsRow.classList.add(CONFIG.HIDDEN_CLASS);\n    if (expandBtn) {\n      expandBtn.classList.remove(CONFIG.ROTATE_CLASS);\n    }\n  } else {\n    // Expand - trigger fetch if not already loaded\n    prefetchRow(type, id);\n    row.setAttribute(CONFIG.EXPANDED_ATTR, 'true');\n    row.setAttribute('aria-expanded', 'true');\n    detailsRow.classList.remove(CONFIG.HIDDEN_CLASS);\n    if (expandBtn) {\n      expandBtn.classList.add(CONFIG.ROTATE_CLASS);\n    }\n  }\n}\n\n/**\n * Handle keyboard events for expandable rows\n * @param {KeyboardEvent} event - The keyboard event\n * @param {string} type - The type of expandable\n * @param {string} id - The unique ID\n */\nexport function handleKeydown(event, type, id) {\n  if (event.key === 'Enter' || event.key === ' ') {\n    event.preventDefault();\n    toggleRow(type, id);\n  }\n}\n\n/**\n * Setup prefetch on hover/focus for a row\n * @param {HTMLElement} row - The row element\n * @param {string} type - The type of expandable\n * @param {string} id - The unique ID\n */\nfunction setupPrefetch(row, type, id) {\n  const key = `${type}-${id}`;\n  if (initializedRows.has(key)) return;\n\n  // Only add listeners if row is expandable\n  if (row.getAttribute('role') === 'button') {\n    row.addEventListener(\n      'mouseenter',\n      function () {\n        prefetchRow(type, id);\n      },\n      { once: true }\n    );\n\n    row.addEventListener(\n      'focus',\n      function () {\n        prefetchRow(type, id);\n      },\n      { once: true }\n    );\n\n    initializedRows.add(key);\n  }\n}\n\n/**\n * Initialize all expandable rows of a given type\n * @param {string} type - The type of expandable (e.g., \"tag\")\n */\nexport function initType(type) {\n  const rows = document.querySelectorAll(`[${CONFIG.TYPE_ATTR}=\"${type}\"]`);\n  rows.forEach((row) => {\n    const id = row.getAttribute(CONFIG.ID_ATTR);\n    if (id) {\n      setupPrefetch(row, type, id);\n    }\n  });\n}\n\n/**\n * Initialize all expandable rows on the page\n */\nexport function init() {\n  // Find all types currently on the page\n  const rows = document.querySelectorAll(`[${CONFIG.TYPE_ATTR}]`);\n  const types = new Set();\n\n  rows.forEach((row) => {\n    const type = row.getAttribute(CONFIG.TYPE_ATTR);\n    if (type) types.add(type);\n  });\n\n  types.forEach((type) => initType(type));\n}\n\n// Initialize on DOM ready\nonReady(init);\n\n// Re-initialize after HTMX swaps (for dynamic content)\ndocument.addEventListener('htmx:afterSettle', function (e) {\n  if (e.detail?.elt) {\n    const rows = e.detail.elt.querySelectorAll?.(`[${CONFIG.TYPE_ATTR}]`) || [];\n    rows.forEach((row) => {\n      const type = row.getAttribute(CONFIG.TYPE_ATTR);\n      const id = row.getAttribute(CONFIG.ID_ATTR);\n      if (type && id) {\n        setupPrefetch(row, type, id);\n      }\n    });\n  }\n});\n\n// Export to window for use by templ onclick handlers\nwindow.ExpandableRow = {\n  toggle: toggleRow,\n  prefetch: prefetchRow,\n  handleKeydown: handleKeydown,\n  init: init,\n  initType: initType,\n};\n", "/**\n * SimpleMasonry - Lightweight masonry layout for HTMX\n * Designed for append-only infinite scroll without reflowing existing items\n * Handles lazy-loaded images via ResizeObserver\n */\n\nimport { onReady } from './utils.js';\n\nexport class SimpleMasonry {\n  constructor(container, options = {}) {\n    this.container = container;\n    this.gap = options.gap || 16;\n    // Responsive min column width - smaller on mobile\n    this.minColumnWidthDesktop = options.minColumnWidth || 300;\n    this.minColumnWidthMobile = options.minColumnWidthMobile || 280;\n    this.columnHeights = [];\n    this.resizeTimeout = null;\n    this.layoutTimeout = null;\n    this.itemHeights = new Map(); // Track item heights to detect changes\n\n    this.init();\n  }\n\n  // Get responsive min column width based on viewport\n  get minColumnWidth() {\n    // Use smaller columns on mobile (< 640px)\n    if (window.innerWidth < 640) {\n      return this.minColumnWidthMobile;\n    }\n    return this.minColumnWidthDesktop;\n  }\n\n  init() {\n    this.container.style.position = 'relative';\n\n    // Store bound handler for cleanup\n    this._resizeHandler = () => {\n      clearTimeout(this.resizeTimeout);\n      this.resizeTimeout = setTimeout(() => this.layout(), 150);\n    };\n\n    // Debounced window resize handler\n    window.addEventListener('resize', this._resizeHandler);\n\n    // Use ResizeObserver to detect when items change size (e.g., lazy images load)\n    this.resizeObserver = new ResizeObserver((entries) => {\n      let needsRelayout = false;\n\n      for (const entry of entries) {\n        const item = entry.target;\n        const oldHeight = this.itemHeights.get(item) || 0;\n        const newHeight = item.offsetHeight;\n\n        // Only relayout if height changed significantly (more than 5px)\n        if (Math.abs(newHeight - oldHeight) > 5) {\n          needsRelayout = true;\n          this.itemHeights.set(item, newHeight);\n        }\n      }\n\n      if (needsRelayout) {\n        // Debounce relayout to batch multiple image loads\n        clearTimeout(this.layoutTimeout);\n        this.layoutTimeout = setTimeout(() => this.layout(), 100);\n      }\n    });\n\n    // Mark existing items and start observing\n    const items = this.container.querySelectorAll('.masonry-item');\n    items.forEach((item) => {\n      item.setAttribute('data-laid-out', 'true');\n      this.resizeObserver.observe(item);\n    });\n\n    this.layout();\n  }\n\n  getColumnCount() {\n    const containerWidth = this.container.offsetWidth;\n    return Math.max(1, Math.floor((containerWidth + this.gap) / (this.minColumnWidth + this.gap)));\n  }\n\n  getColumnWidth() {\n    const columnCount = this.getColumnCount();\n    const containerWidth = this.container.offsetWidth;\n    return (containerWidth - (columnCount - 1) * this.gap) / columnCount;\n  }\n\n  // Full layout - used on init, resize, and when items change size\n  layout() {\n    const items = [...this.container.querySelectorAll('.masonry-item')];\n    const columnCount = this.getColumnCount();\n    const columnWidth = this.getColumnWidth();\n\n    // Reset column heights\n    this.columnHeights = Array(columnCount).fill(0);\n\n    items.forEach((item) => {\n      this.positionItem(item, columnWidth);\n      // Update tracked height\n      this.itemHeights.set(item, item.offsetHeight);\n    });\n\n    this.updateContainerHeight();\n  }\n\n  // Position a single item in the shortest column\n  positionItem(item, columnWidth) {\n    // Find shortest column\n    const minHeight = Math.min(...this.columnHeights);\n    const columnIndex = this.columnHeights.indexOf(minHeight);\n\n    // Position item absolutely\n    item.style.position = 'absolute';\n    item.style.width = `${columnWidth}px`;\n    item.style.left = `${columnIndex * (columnWidth + this.gap)}px`;\n    item.style.top = `${minHeight}px`;\n\n    // Update column height\n    this.columnHeights[columnIndex] += item.offsetHeight + this.gap;\n  }\n\n  // Append new items without reflowing existing ones\n  append(newItems) {\n    const columnWidth = this.getColumnWidth();\n\n    newItems.forEach((item) => {\n      item.setAttribute('data-laid-out', 'true');\n      this.positionItem(item, columnWidth);\n      this.itemHeights.set(item, item.offsetHeight);\n      // Start observing new items for size changes\n      this.resizeObserver.observe(item);\n    });\n\n    this.updateContainerHeight();\n  }\n\n  updateContainerHeight() {\n    const maxHeight = Math.max(...this.columnHeights, 0);\n    this.container.style.height = `${maxHeight}px`;\n  }\n\n  // Clean up observers and event listeners\n  destroy() {\n    this.resizeObserver.disconnect();\n    clearTimeout(this.resizeTimeout);\n    clearTimeout(this.layoutTimeout);\n\n    // Remove window resize listener\n    if (this._resizeHandler) {\n      window.removeEventListener('resize', this._resizeHandler);\n      this._resizeHandler = null;\n    }\n  }\n}\n\n// Export for use\nwindow.SimpleMasonry = SimpleMasonry;\n\n/**\n * Initialize masonry for a grid element\n */\nexport function initMasonry() {\n  const grid = document.getElementById('bookmark-grid');\n  if (!grid) return;\n\n  // If masonry already exists for this grid, destroy it first\n  if (window.bookmarkMasonry) {\n    // Check if it's the same grid element\n    if (window.bookmarkMasonry.container === grid) {\n      return; // Already initialized for this grid\n    }\n    // Different grid (page navigation), destroy old instance\n    window.bookmarkMasonry.destroy();\n    window.bookmarkMasonry = null;\n  }\n\n  // Initialize masonry - ResizeObserver will handle lazy images\n  // Responsive column widths: 350px on desktop, 280px on mobile\n  window.bookmarkMasonry = new SimpleMasonry(grid, {\n    gap: 16,\n    minColumnWidth: 350,\n    minColumnWidthMobile: 280,\n  });\n}\n\n/**\n * Auto-initialize masonry for bookmark grid\n */\nonReady(function () {\n  initMasonry();\n\n  // Handle HTMX appends (OOB swaps to bookmark-grid)\n  document.body.addEventListener('htmx:oobAfterSwap', function (e) {\n    // Only handle swaps to bookmark grid\n    if (e.detail.target.id !== 'bookmark-grid') return;\n    if (!window.bookmarkMasonry) return;\n\n    const grid = document.getElementById('bookmark-grid');\n    // Find new items (ones without data-laid-out attribute)\n    const newItems = [...grid.querySelectorAll('.masonry-item:not([data-laid-out])')];\n\n    if (newItems.length === 0) return;\n\n    // Append new items - ResizeObserver will handle when images load\n    window.bookmarkMasonry.append(newItems);\n  });\n\n  // Handle HTMX navigation - re-initialize masonry when content is swapped in\n  document.body.addEventListener('htmx:afterSettle', function (e) {\n    const grid = document.getElementById('bookmark-grid');\n    if (!grid) return;\n\n    // Always destroy old instance and reinitialize\n    // After HTMX swap, the grid is a new DOM element even if it has the same ID\n    if (window.bookmarkMasonry) {\n      window.bookmarkMasonry.destroy();\n      window.bookmarkMasonry = null;\n    }\n\n    initMasonry();\n  });\n});\n", "/**\n * Kanban Board Component\n * Native HTML5 Drag-and-Drop with keyboard accessibility\n */\n(function () {\n  \"use strict\";\n\n  // ============================================\n  // CONFIGURATION\n  // ============================================\n\n  const SCROLL_CONFIG = {\n    edgeThreshold: 60,    // px from edge to start scrolling\n    maxScrollSpeed: 15,   // max px per frame\n    minScrollSpeed: 3,    // min px per frame\n  };\n\n  const SELECTION_CONFIG = {\n    maxSelection: 50,     // Maximum cards that can be selected\n  };\n\n  // ============================================\n  // STATE FACTORY FUNCTIONS\n  // ============================================\n\n  function createDragState() {\n    return {\n      isDragging: false,\n      draggedCard: null,\n      draggedCards: [],\n      sourceColumn: null,\n      sourceIndex: null,\n      sourcePositions: [],\n      placeholder: null,\n      isMultiDrag: false\n    };\n  }\n\n  function createScrollState() {\n    return {\n      animationId: null,\n      horizontalSpeed: 0,\n      verticalSpeed: 0,\n      boardContainer: null,\n      columnContainer: null,\n    };\n  }\n\n  function createKeyboardDragState() {\n    return {\n      isActive: false,\n      card: null,\n      originalColumn: null,\n      originalNextSibling: null,\n      originalIndex: null\n    };\n  }\n\n  function createSelectionState() {\n    return {\n      selectedIds: new Set(),\n      lastSelectedId: null,\n      columnId: null,\n    };\n  }\n\n  function createMoveMenuState() {\n    return {\n      isOpen: false,\n      focusedIndex: 0,\n      collections: [],\n      previousFocus: null,\n    };\n  }\n\n  // ============================================\n  // STATE OBJECTS\n  // ============================================\n\n  const dragState = createDragState();\n  const scrollState = createScrollState();\n  const keyboardDragState = createKeyboardDragState();\n  const selectionState = createSelectionState();\n  const moveMenuState = createMoveMenuState();\n\n  // ============================================\n  // STATE RESET FUNCTIONS\n  // ============================================\n\n  function resetDragState() {\n    Object.assign(dragState, createDragState());\n  }\n\n  function resetScrollState() {\n    Object.assign(scrollState, createScrollState());\n  }\n\n  function resetKeyboardDragState() {\n    Object.assign(keyboardDragState, createKeyboardDragState());\n  }\n\n  function resetSelectionState() {\n    Object.assign(selectionState, createSelectionState());\n  }\n\n  function resetMoveMenuState() {\n    Object.assign(moveMenuState, createMoveMenuState());\n  }\n\n  // ============================================\n  // UTILITY FUNCTIONS\n  // ============================================\n\n  /**\n   * Show error toast or fallback to alert\n   */\n  function showErrorToast(message) {\n    if (typeof window.showToast === \"function\") {\n      window.showToast(message, \"error\");\n    } else {\n      alert(message);\n    }\n  }\n\n  /**\n   * Pluralize a word based on count\n   */\n  function pluralize(count, singular, plural) {\n    return count === 1 ? singular : (plural || singular + \"s\");\n  }\n\n  /**\n   * Announce a count-based message\n   */\n  function announceCount(count, action, noun = \"item\") {\n    announce(`${count} ${pluralize(count, noun)} ${action}`);\n  }\n\n  /**\n   * Get a card element by bookmark ID\n   */\n  function getCardById(bookmarkId) {\n    return document.querySelector(`.kanban-card[data-bookmark-id=\"${bookmarkId}\"]`);\n  }\n\n  /**\n   * Get the column content element containing a card\n   */\n  function getColumnContent(card) {\n    return card.closest(\".kanban-column-content\");\n  }\n\n  /**\n   * Get all cards in a column\n   */\n  function getColumnCards(columnContent) {\n    return Array.from(columnContent.querySelectorAll(\".kanban-card\"));\n  }\n\n  /**\n   * Get CSRF token from page (hx-headers or cookie)\n   */\n  function getCSRFToken() {\n    const body = document.body;\n    const headers = body.getAttribute(\"hx-headers\");\n    \n    if (headers) {\n      try {\n        const parsed = JSON.parse(headers);\n        if (parsed[\"X-CSRF-Token\"]) {\n          return parsed[\"X-CSRF-Token\"];\n        }\n      } catch (e) {\n        // Ignore parse errors\n      }\n    }\n    \n    // Fallback: try to get from cookie\n    const cookies = document.cookie.split(';');\n    for (const cookie of cookies) {\n      const [name, value] = cookie.trim().split('=');\n      if (name === 'csrf_token') {\n        return value;\n      }\n    }\n    \n    return \"\";\n  }\n\n  /**\n   * Bulk move bookmarks API call (consolidated)\n   * @param {number[]} bookmarkIds - Array of bookmark IDs to move\n   * @param {string} collectionId - Target collection ID (empty string for unsorted)\n   * @param {Object} options - Optional settings\n   * @param {string|null} options.afterBookmarkId - Insert after this bookmark ID\n   * @param {Function} options.onSuccess - Callback on success\n   * @param {Function} options.onError - Callback on error\n   * @returns {Promise}\n   */\n  function bulkMoveBookmarksAPI(bookmarkIds, collectionId, options = {}) {\n    const { afterBookmarkId = null, onSuccess = null, onError = null } = options;\n    const csrfToken = getCSRFToken();\n    \n    const payload = {\n      bookmark_ids: bookmarkIds,\n      collection_id: collectionId === \"\" ? null : parseInt(collectionId, 10),\n    };\n    \n    if (afterBookmarkId) {\n      payload.after_id = parseInt(afterBookmarkId, 10);\n    }\n\n    return fetch(\"/admin/htmx/bookmarks/bulk/move\", {\n      method: \"POST\",\n      headers: {\n        \"X-CSRF-Token\": csrfToken,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(payload),\n    })\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(`Failed to move bookmarks: ${response.status}`);\n        }\n        if (onSuccess) onSuccess();\n        return response;\n      })\n      .catch((error) => {\n        console.error(\"[Kanban] Error moving bookmarks:\", error);\n        if (onError) onError(error);\n        showErrorToast(\"Failed to move bookmarks. Please try again.\");\n        throw error;\n      });\n  }\n\n  // ============================================\n  // SCREEN READER ANNOUNCEMENTS\n  // ============================================\n\n  /**\n   * Announce message to screen readers via live region\n   */\n  function announce(message) {\n    const liveRegion = document.getElementById(\"kanban-live-region\");\n    if (liveRegion) {\n      liveRegion.textContent = \"\";\n      requestAnimationFrame(() => {\n        liveRegion.textContent = message;\n      });\n    }\n  }\n\n  // ============================================\n  // MULTI-SELECT FUNCTIONS\n  // ============================================\n\n  /**\n   * Get the column ID from a card or column element\n   */\n  function getColumnId(element) {\n    const column = element.closest(\".kanban-column\");\n    return column ? (column.dataset.collectionId || null) : null;\n  }\n\n  /**\n   * Get bookmark ID from a card element\n   */\n  function getBookmarkId(card) {\n    return card.dataset.bookmarkId;\n  }\n\n  /**\n   * Check if a card is selected\n   */\n  function isSelected(card) {\n    return selectionState.selectedIds.has(getBookmarkId(card));\n  }\n\n  /**\n   * Update visual selection state on a card\n   */\n  function updateCardSelectionVisual(card) {\n    if (isSelected(card)) {\n      card.classList.add(\"selected\");\n      card.setAttribute(\"aria-selected\", \"true\");\n    } else {\n      card.classList.remove(\"selected\");\n      card.setAttribute(\"aria-selected\", \"false\");\n    }\n  }\n\n  /**\n   * Clear all selections\n   */\n  function clearSelection() {\n    // Remove visual state from all previously selected cards\n    selectionState.selectedIds.forEach((id) => {\n      const card = getCardById(id);\n      if (card) {\n        card.classList.remove(\"selected\");\n        card.setAttribute(\"aria-selected\", \"false\");\n      }\n    });\n\n    selectionState.selectedIds = new Set();\n    selectionState.lastSelectedId = null;\n    selectionState.columnId = null;\n\n    updateSelectionToolbar();\n  }\n\n  /**\n   * Select a single card (optionally clearing others)\n   */\n  function selectCard(card, options = {}) {\n    const { toggle = false, addToSelection = false } = options;\n    const bookmarkId = getBookmarkId(card);\n    const columnId = getColumnId(card);\n\n    // If clicking in a different column, clear selection first\n    if (selectionState.columnId !== null && selectionState.columnId !== columnId && selectionState.selectedIds.size > 0) {\n      clearSelection();\n    }\n\n    if (toggle) {\n      // Toggle mode (Cmd/Ctrl+Click)\n      if (selectionState.selectedIds.has(bookmarkId)) {\n        selectionState.selectedIds.delete(bookmarkId);\n        if (selectionState.selectedIds.size === 0) {\n          selectionState.columnId = null;\n          selectionState.lastSelectedId = null;\n        }\n      } else {\n        if (selectionState.selectedIds.size < SELECTION_CONFIG.maxSelection) {\n          selectionState.selectedIds.add(bookmarkId);\n          selectionState.lastSelectedId = bookmarkId;\n          selectionState.columnId = columnId;\n        }\n      }\n    } else if (addToSelection) {\n      // Add to selection (used by range select)\n      if (selectionState.selectedIds.size < SELECTION_CONFIG.maxSelection) {\n        selectionState.selectedIds.add(bookmarkId);\n        selectionState.columnId = columnId;\n      }\n    } else {\n      // Exclusive selection (plain click)\n      clearSelection();\n      selectionState.selectedIds.add(bookmarkId);\n      selectionState.lastSelectedId = bookmarkId;\n      selectionState.columnId = columnId;\n    }\n\n    updateCardSelectionVisual(card);\n    updateSelectionToolbar();\n  }\n\n  /**\n   * Select a range of cards between lastSelectedId and the target card\n   */\n  function selectRange(targetCard) {\n    const columnId = getColumnId(targetCard);\n\n    // If no previous selection or different column, just select the target\n    if (!selectionState.lastSelectedId || selectionState.columnId !== columnId) {\n      selectCard(targetCard);\n      return;\n    }\n\n    const column = targetCard.closest(\".kanban-column-content\");\n    const cards = Array.from(column.querySelectorAll(\".kanban-card\"));\n    const targetId = getBookmarkId(targetCard);\n\n    // Find indices\n    const lastIndex = cards.findIndex((c) => getBookmarkId(c) === selectionState.lastSelectedId);\n    const targetIndex = cards.findIndex((c) => getBookmarkId(c) === targetId);\n\n    if (lastIndex === -1 || targetIndex === -1) {\n      selectCard(targetCard);\n      return;\n    }\n\n    // Select all cards in range\n    const startIndex = Math.min(lastIndex, targetIndex);\n    const endIndex = Math.max(lastIndex, targetIndex);\n\n    for (let i = startIndex; i <= endIndex && selectionState.selectedIds.size < SELECTION_CONFIG.maxSelection; i++) {\n      const card = cards[i];\n      selectionState.selectedIds.add(getBookmarkId(card));\n      updateCardSelectionVisual(card);\n    }\n\n    selectionState.columnId = columnId;\n    updateSelectionToolbar();\n\n    const count = selectionState.selectedIds.size;\n    announce(`${count} item${count !== 1 ? \"s\" : \"\"} selected`);\n  }\n\n  /**\n   * Extend selection in a direction (for Shift+Arrow keys)\n   * direction: -1 for up, 1 for down\n   */\n  function extendSelectionInDirection(card, direction) {\n    const column = card.closest(\".kanban-column-content\");\n    const columnId = getColumnId(card);\n    const cards = Array.from(column.querySelectorAll(\".kanban-card\"));\n    const currentIndex = cards.indexOf(card);\n    const targetIndex = currentIndex + direction;\n\n    if (targetIndex < 0 || targetIndex >= cards.length) {\n      announce(direction < 0 ? \"At top of column\" : \"At bottom of column\");\n      return;\n    }\n\n    const targetCard = cards[targetIndex];\n    const targetId = getBookmarkId(targetCard);\n\n    // If selecting in a different column, clear and start fresh\n    if (selectionState.columnId !== null && selectionState.columnId !== columnId) {\n      clearSelection();\n    }\n\n    // Ensure current card is selected\n    if (!selectionState.selectedIds.has(getBookmarkId(card))) {\n      selectionState.selectedIds.add(getBookmarkId(card));\n      selectionState.lastSelectedId = getBookmarkId(card);\n      selectionState.columnId = columnId;\n      updateCardSelectionVisual(card);\n    }\n\n    // Toggle or add target card to selection\n    if (selectionState.selectedIds.has(targetId)) {\n      // If target already selected, we might be contracting selection\n      // Check if current card should be deselected (contracting)\n      const currentId = getBookmarkId(card);\n      // Only deselect current if we're moving back toward anchor\n      // For simplicity, just move focus without deselecting\n      selectionState.selectedIds.delete(currentId);\n      updateCardSelectionVisual(card);\n    } else {\n      // Extend selection to include target\n      if (selectionState.selectedIds.size < SELECTION_CONFIG.maxSelection) {\n        selectionState.selectedIds.add(targetId);\n        updateCardSelectionVisual(targetCard);\n      }\n    }\n\n    selectionState.lastSelectedId = targetId;\n    updateSelectionToolbar();\n\n    // Move focus to target\n    targetCard.focus();\n    scrollCardIntoView(targetCard);\n\n    const count = selectionState.selectedIds.size;\n    announce(`${count} item${count !== 1 ? \"s\" : \"\"} selected`);\n  }\n\n  /**\n   * Select all cards in the current column\n   */\n  function selectAllInColumn(card) {\n    const column = card.closest(\".kanban-column-content\");\n    const columnId = getColumnId(card);\n    const cards = Array.from(column.querySelectorAll(\".kanban-card\"));\n\n    clearSelection();\n\n    const maxToSelect = Math.min(cards.length, SELECTION_CONFIG.maxSelection);\n    for (let i = 0; i < maxToSelect; i++) {\n      selectionState.selectedIds.add(getBookmarkId(cards[i]));\n      updateCardSelectionVisual(cards[i]);\n    }\n\n    selectionState.columnId = columnId;\n    if (cards.length > 0) {\n      selectionState.lastSelectedId = getBookmarkId(cards[maxToSelect - 1]);\n    }\n\n    updateSelectionToolbar();\n\n    const count = selectionState.selectedIds.size;\n    announce(`${count} item${count !== 1 ? \"s\" : \"\"} selected`);\n  }\n\n  /**\n   * Get all selected card elements\n   */\n  function getSelectedCards() {\n    const cards = [];\n    selectionState.selectedIds.forEach((id) => {\n      const card = getCardById(id);\n      if (card) cards.push(card);\n    });\n    return cards;\n  }\n\n  /**\n   * Get selected bookmark IDs as array of integers\n   */\n  function getSelectedBookmarkIds() {\n    return Array.from(selectionState.selectedIds).map((id) => parseInt(id, 10));\n  }\n\n  /**\n   * Update the selection toolbar visibility and count\n   */\n  function updateSelectionToolbar() {\n    const toolbar = document.getElementById(\"kanban-selection-toolbar\");\n    if (!toolbar) return;\n\n    const count = selectionState.selectedIds.size;\n\n    if (count === 0) {\n      toolbar.classList.add(\"hidden\");\n    } else {\n      toolbar.classList.remove(\"hidden\");\n      const countEl = toolbar.querySelector(\".selection-count\");\n      if (countEl) {\n        countEl.textContent = `${count} selected`;\n      }\n    }\n  }\n\n  /**\n   * Handle card click for selection\n   */\n  function handleCardClick(e) {\n    const card = e.target.closest(\".kanban-card\");\n    if (!card) return;\n\n    // Don't handle selection if clicking on interactive elements inside the card\n    if (e.target.closest(\"button, a, [data-dropdown-trigger], [data-dropdown-option]\")) {\n      return;\n    }\n\n    // Don't handle if we're in keyboard drag mode\n    if (keyboardDragState.isActive) return;\n\n    const isMac = navigator.platform.toUpperCase().indexOf(\"MAC\") >= 0;\n    const isModifierPressed = isMac ? e.metaKey : e.ctrlKey;\n    const isShiftPressed = e.shiftKey;\n\n    if (isShiftPressed) {\n      e.preventDefault();\n      selectRange(card);\n    } else if (isModifierPressed) {\n      e.preventDefault();\n      selectCard(card, { toggle: true });\n    } else {\n      // Plain click - select only this card\n      selectCard(card);\n    }\n  }\n\n  /**\n   * Handle click on empty space to clear selection\n   */\n  function handleBoardClick(e) {\n    // If click was on empty space (not on a card), clear selection\n    if (!e.target.closest(\".kanban-card\") && \n        !e.target.closest(\"#kanban-selection-toolbar\") &&\n        !e.target.closest(\"#kanban-move-menu\")) {\n      clearSelection();\n    }\n  }\n\n  // ============================================\n  // KEYBOARD MOVE MENU\n  // ============================================\n\n  /**\n   * Open the keyboard-navigable move menu\n   */\n  function openMoveMenu() {\n    if (selectionState.selectedIds.size < 2) return;\n\n    // Store current focus to return to later\n    moveMenuState.previousFocus = document.activeElement;\n\n    // Build collections list from existing selection toolbar dropdown\n    const collections = [];\n    const currentColumnId = selectionState.columnId;\n\n    // Add Unsorted first\n    collections.push({\n      id: \"\",\n      name: \"Unsorted\",\n      color: null,\n      isCurrent: currentColumnId === null || currentColumnId === \"\",\n    });\n\n    // Get collections from existing dropdown\n    document.querySelectorAll(\"[data-selection-move-menu] [data-move-collection-id]\").forEach((el) => {\n      const id = el.dataset.moveCollectionId;\n      if (id !== \"\") {\n        const colorEl = el.querySelector(\".selection-move-option-color\");\n        collections.push({\n          id: id,\n          name: el.querySelector(\"span:last-child\")?.textContent.trim() || \"Collection\",\n          color: colorEl ? colorEl.style.backgroundColor : null,\n          isCurrent: id === currentColumnId,\n        });\n      }\n    });\n\n    moveMenuState.collections = collections;\n    // Set initial focus to first non-current item, or first item\n    moveMenuState.focusedIndex = collections.findIndex((c) => !c.isCurrent);\n    if (moveMenuState.focusedIndex === -1) moveMenuState.focusedIndex = 0;\n\n    // Render and show menu\n    renderMoveMenu();\n    \n    const menu = document.getElementById(\"kanban-move-menu\");\n    const backdrop = document.getElementById(\"kanban-move-menu-backdrop\");\n    if (menu) {\n      menu.classList.remove(\"hidden\");\n      moveMenuState.isOpen = true;\n      // Focus the menu for keyboard events\n      menu.focus();\n    }\n    if (backdrop) {\n      backdrop.classList.remove(\"hidden\");\n    }\n\n    // Update count in header\n    const countEl = document.getElementById(\"move-menu-count\");\n    if (countEl) {\n      countEl.textContent = selectionState.selectedIds.size;\n    }\n\n    announce(`Move menu opened. ${collections.length} options. Use arrow keys to navigate.`);\n  }\n\n  /**\n   * Close the move menu\n   */\n  function closeMoveMenu() {\n    const menu = document.getElementById(\"kanban-move-menu\");\n    const backdrop = document.getElementById(\"kanban-move-menu-backdrop\");\n    \n    if (menu) {\n      menu.classList.add(\"hidden\");\n    }\n    if (backdrop) {\n      backdrop.classList.add(\"hidden\");\n    }\n    \n    moveMenuState.isOpen = false;\n\n    // Return focus to previous element\n    if (moveMenuState.previousFocus && moveMenuState.previousFocus.focus) {\n      moveMenuState.previousFocus.focus();\n    }\n    moveMenuState.previousFocus = null;\n  }\n\n  /**\n   * Render the move menu items\n   */\n  function renderMoveMenu() {\n    const list = document.querySelector(\".kanban-move-menu-list\");\n    if (!list) return;\n\n    list.innerHTML = moveMenuState.collections\n      .map((item, index) => {\n        const isFocused = index === moveMenuState.focusedIndex;\n        const shortcut = index < 9 ? index + 1 : null;\n\n        return `\n          <div class=\"kanban-move-menu-item ${item.isCurrent ? \"current\" : \"\"} ${isFocused ? \"focused\" : \"\"}\"\n               role=\"option\"\n               data-index=\"${index}\"\n               data-collection-id=\"${item.id}\"\n               aria-selected=\"${isFocused}\"\n               ${item.isCurrent ? 'aria-disabled=\"true\"' : \"\"}>\n            ${\n              item.color\n                ? `<span class=\"kanban-move-menu-item-color\" style=\"background-color: ${item.color}\"></span>`\n                : `<svg class=\"kanban-move-menu-item-icon\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polyline points=\"22 12 16 12 14 15 10 15 8 12 2 12\"></polyline><path d=\"M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z\"></path></svg>`\n            }\n            <span class=\"kanban-move-menu-item-name\">${item.name}</span>\n            ${shortcut ? `<span class=\"kanban-move-menu-item-shortcut\">${shortcut}</span>` : \"\"}\n          </div>\n        `;\n      })\n      .join(\"\");\n\n    // Add click handlers to items\n    list.querySelectorAll(\".kanban-move-menu-item:not(.current)\").forEach((el) => {\n      el.addEventListener(\"click\", () => {\n        const index = parseInt(el.dataset.index, 10);\n        moveMenuState.focusedIndex = index;\n        selectMoveMenuItem();\n      });\n    });\n  }\n\n  /**\n   * Navigate the move menu (up/down)\n   */\n  function navigateMoveMenu(direction) {\n    const { collections, focusedIndex } = moveMenuState;\n    let newIndex = focusedIndex;\n\n    // Find next non-current item in direction\n    let attempts = 0;\n    do {\n      newIndex = newIndex + direction;\n      // Wrap around\n      if (newIndex < 0) newIndex = collections.length - 1;\n      if (newIndex >= collections.length) newIndex = 0;\n      attempts++;\n    } while (collections[newIndex].isCurrent && attempts < collections.length);\n\n    moveMenuState.focusedIndex = newIndex;\n    updateMoveMenuFocus();\n\n    const item = collections[newIndex];\n    announce(`${item.name}${item.isCurrent ? \" (current)\" : \"\"}`);\n  }\n\n  /**\n   * Update visual focus indicator in move menu\n   */\n  function updateMoveMenuFocus() {\n    const list = document.querySelector(\".kanban-move-menu-list\");\n    if (!list) return;\n\n    list.querySelectorAll(\".kanban-move-menu-item\").forEach((el, index) => {\n      const isFocused = index === moveMenuState.focusedIndex;\n      el.classList.toggle(\"focused\", isFocused);\n      el.setAttribute(\"aria-selected\", isFocused);\n    });\n\n    // Scroll focused item into view\n    const focusedEl = list.querySelector(\".kanban-move-menu-item.focused\");\n    if (focusedEl) {\n      focusedEl.scrollIntoView({ block: \"nearest\" });\n    }\n  }\n\n  /**\n   * Select the currently focused menu item and move bookmarks\n   */\n  function selectMoveMenuItem() {\n    const item = moveMenuState.collections[moveMenuState.focusedIndex];\n    if (!item || item.isCurrent) return;\n\n    closeMoveMenu();\n    handleBulkMove(item.id);\n  }\n\n  /**\n   * Handle quick select by number (1-9)\n   */\n  function quickSelectMoveItem(number) {\n    const index = number - 1; // 1 = index 0\n    if (index < 0 || index >= moveMenuState.collections.length) return;\n\n    const item = moveMenuState.collections[index];\n    if (item.isCurrent) {\n      announce(`${item.name} is the current column`);\n      return;\n    }\n\n    moveMenuState.focusedIndex = index;\n    selectMoveMenuItem();\n  }\n\n  /**\n   * Handle keyboard events for move menu\n   */\n  function handleMoveMenuKeydown(e) {\n    if (!moveMenuState.isOpen) return;\n\n    switch (e.key) {\n      case \"ArrowUp\":\n        e.preventDefault();\n        navigateMoveMenu(-1);\n        break;\n\n      case \"ArrowDown\":\n        e.preventDefault();\n        navigateMoveMenu(1);\n        break;\n\n      case \"Enter\":\n        e.preventDefault();\n        selectMoveMenuItem();\n        break;\n\n      case \"Escape\":\n        e.preventDefault();\n        closeMoveMenu();\n        announce(\"Move menu closed\");\n        break;\n\n      case \"1\":\n      case \"2\":\n      case \"3\":\n      case \"4\":\n      case \"5\":\n      case \"6\":\n      case \"7\":\n      case \"8\":\n      case \"9\":\n        e.preventDefault();\n        quickSelectMoveItem(parseInt(e.key, 10));\n        break;\n\n      case \"Tab\":\n        // Trap focus within menu\n        e.preventDefault();\n        break;\n    }\n  }\n\n  /**\n   * Handle backdrop click to close menu\n   */\n  function handleMoveMenuBackdropClick() {\n    if (moveMenuState.isOpen) {\n      closeMoveMenu();\n      announce(\"Move menu closed\");\n    }\n  }\n\n  // ============================================\n  // HELPER FUNCTIONS\n  // ============================================\n\n  /**\n   * Get column name from column element\n   */\n  function getColumnName(column) {\n    const header = column.querySelector(\".kanban-column-title h3\");\n    return header ? header.textContent.trim() : \"Unknown\";\n  }\n\n  /**\n   * Get card position info within its column\n   */\n  function getCardPosition(card) {\n    const column = card.closest(\".kanban-column-content\");\n    const cards = Array.from(column.querySelectorAll(\".kanban-card\"));\n    const index = cards.indexOf(card);\n    return { index: index + 1, total: cards.length };\n  }\n\n  /**\n   * Get card title for announcements\n   */\n  function getCardTitle(card) {\n    return card.getAttribute(\"aria-label\") || \"Bookmark\";\n  }\n\n  /**\n   * Get index of card within its column\n   */\n  function getCardIndex(card) {\n    const column = card.closest(\".kanban-column-content\");\n    const cards = Array.from(column.querySelectorAll(\".kanban-card\"));\n    return cards.indexOf(card);\n  }\n\n  // ============================================\n  // AUTO-SCROLL DURING DRAG\n  // ============================================\n\n  /**\n   * Calculate scroll speed based on distance from edge\n   * Closer to edge = faster scroll\n   */\n  function calculateScrollSpeed(distanceFromEdge) {\n    const { edgeThreshold, maxScrollSpeed, minScrollSpeed } = SCROLL_CONFIG;\n    if (distanceFromEdge >= edgeThreshold) return 0;\n    \n    // Linear interpolation: closer to edge = faster\n    const ratio = 1 - (distanceFromEdge / edgeThreshold);\n    return minScrollSpeed + (maxScrollSpeed - minScrollSpeed) * ratio;\n  }\n\n  /**\n   * Update scroll direction based on cursor position\n   */\n  function updateScrollDirection(clientX, clientY) {\n    const board = document.getElementById(\"kanban-board\");\n    if (!board) return;\n\n    const boardRect = board.getBoundingClientRect();\n    const { edgeThreshold } = SCROLL_CONFIG;\n\n    // Horizontal scroll (board level)\n    let horizontalSpeed = 0;\n    const distanceFromLeft = clientX - boardRect.left;\n    const distanceFromRight = boardRect.right - clientX;\n\n    if (distanceFromLeft < edgeThreshold && board.scrollLeft > 0) {\n      // Near left edge - scroll left\n      horizontalSpeed = -calculateScrollSpeed(distanceFromLeft);\n    } else if (distanceFromRight < edgeThreshold && \n               board.scrollLeft < board.scrollWidth - board.clientWidth) {\n      // Near right edge - scroll right\n      horizontalSpeed = calculateScrollSpeed(distanceFromRight);\n    }\n\n    // Vertical scroll (column level)\n    let verticalSpeed = 0;\n    let columnContainer = null;\n    const column = document.elementFromPoint(clientX, clientY)?.closest(\".kanban-column-content\");\n    \n    if (column) {\n      const columnRect = column.getBoundingClientRect();\n      const distanceFromTop = clientY - columnRect.top;\n      const distanceFromBottom = columnRect.bottom - clientY;\n\n      if (distanceFromTop < edgeThreshold && column.scrollTop > 0) {\n        // Near top edge - scroll up\n        verticalSpeed = -calculateScrollSpeed(distanceFromTop);\n        columnContainer = column;\n      } else if (distanceFromBottom < edgeThreshold && \n                 column.scrollTop < column.scrollHeight - column.clientHeight) {\n        // Near bottom edge - scroll down\n        verticalSpeed = calculateScrollSpeed(distanceFromBottom);\n        columnContainer = column;\n      }\n    }\n\n    scrollState.horizontalSpeed = horizontalSpeed;\n    scrollState.verticalSpeed = verticalSpeed;\n    scrollState.boardContainer = board;\n    scrollState.columnContainer = columnContainer;\n\n    // Start or stop animation based on whether we need to scroll\n    if (horizontalSpeed !== 0 || verticalSpeed !== 0) {\n      startAutoScroll();\n    } else {\n      stopAutoScroll();\n    }\n  }\n\n  /**\n   * Start the auto-scroll animation loop\n   */\n  function startAutoScroll() {\n    if (scrollState.animationId !== null) return; // Already running\n\n    function scrollFrame() {\n      const { horizontalSpeed, verticalSpeed, boardContainer, columnContainer } = scrollState;\n\n      if (boardContainer && horizontalSpeed !== 0) {\n        boardContainer.scrollLeft += horizontalSpeed;\n      }\n\n      if (columnContainer && verticalSpeed !== 0) {\n        columnContainer.scrollTop += verticalSpeed;\n      }\n\n      // Continue animation if still dragging and need to scroll\n      if (dragState.isDragging && (horizontalSpeed !== 0 || verticalSpeed !== 0)) {\n        scrollState.animationId = requestAnimationFrame(scrollFrame);\n      } else {\n        scrollState.animationId = null;\n      }\n    }\n\n    scrollState.animationId = requestAnimationFrame(scrollFrame);\n  }\n\n  /**\n   * Stop the auto-scroll animation\n   */\n  function stopAutoScroll() {\n    if (scrollState.animationId !== null) {\n      cancelAnimationFrame(scrollState.animationId);\n      scrollState.animationId = null;\n    }\n    scrollState.horizontalSpeed = 0;\n    scrollState.verticalSpeed = 0;\n    scrollState.boardContainer = null;\n    scrollState.columnContainer = null;\n  }\n\n  // ============================================\n  // NATIVE DRAG AND DROP\n  // ============================================\n\n  /**\n   * Create placeholder element for drop position indicator\n   */\n  function createPlaceholder() {\n    const el = document.createElement(\"div\");\n    el.className = \"kanban-drop-placeholder\";\n    el.setAttribute(\"aria-hidden\", \"true\");\n    return el;\n  }\n\n  /**\n   * Remove placeholder from DOM\n   */\n  function removePlaceholder() {\n    if (dragState.placeholder && dragState.placeholder.parentNode) {\n      dragState.placeholder.remove();\n    }\n  }\n\n  /**\n   * Remove all drag-over classes from columns\n   */\n  function removeAllDragOverClasses() {\n    document.querySelectorAll(\".drag-over\").forEach((el) => {\n      el.classList.remove(\"drag-over\");\n    });\n  }\n\n  /**\n   * Calculate drop position based on mouse Y coordinate\n   * Returns the card element to insert before, or null to append at end\n   */\n  function getDropPosition(container, mouseY) {\n    const cards = Array.from(\n      container.querySelectorAll(\".kanban-card:not(.dragging)\")\n    );\n\n    for (const card of cards) {\n      const rect = card.getBoundingClientRect();\n      const cardMiddle = rect.top + rect.height / 2;\n\n      if (mouseY < cardMiddle) {\n        return card; // Insert before this card\n      }\n    }\n\n    return null; // Insert at end\n  }\n\n  /**\n   * Update placeholder position in the column\n   */\n  function updatePlaceholder(column, beforeCard) {\n    const { placeholder } = dragState;\n    if (!placeholder) return;\n\n    // Remove empty state if present\n    const emptyState = column.querySelector(\".kanban-empty\");\n    if (emptyState) {\n      emptyState.remove();\n    }\n\n    if (beforeCard) {\n      beforeCard.parentNode.insertBefore(placeholder, beforeCard);\n    } else {\n      column.appendChild(placeholder);\n    }\n  }\n\n  /**\n   * Handle drag start event\n   */\n  function handleDragStart(e) {\n    const card = e.target.closest(\".kanban-card\");\n    if (!card) return;\n\n    const bookmarkId = card.dataset.bookmarkId;\n    const isCardSelected = selectionState.selectedIds.has(bookmarkId);\n    const hasMultipleSelected = selectionState.selectedIds.size > 1;\n\n    // If dragging a card that's NOT selected, clear selection and do single drag\n    if (!isCardSelected) {\n      clearSelection();\n    }\n\n    dragState.isDragging = true;\n    dragState.draggedCard = card;\n    dragState.sourceColumn = card.closest(\".kanban-column-content\");\n    dragState.sourceIndex = getCardIndex(card);\n\n    // Check if this is a multi-drag scenario\n    if (isCardSelected && hasMultipleSelected) {\n      dragState.isMultiDrag = true;\n      \n      // Get all selected cards in DOM order (important for maintaining relative positions)\n      const column = card.closest(\".kanban-column-content\");\n      const allCardsInColumn = Array.from(column.querySelectorAll(\".kanban-card\"));\n      dragState.draggedCards = allCardsInColumn.filter((c) => \n        selectionState.selectedIds.has(c.dataset.bookmarkId)\n      );\n\n      // Store original positions for potential revert\n      dragState.sourcePositions = dragState.draggedCards.map((c) => ({\n        card: c,\n        column: c.closest(\".kanban-column-content\"),\n        nextSibling: c.nextElementSibling\n      }));\n\n      // Add dragging class to all selected cards (with delay to not affect drag image)\n      setTimeout(() => {\n        dragState.draggedCards.forEach((c, i) => {\n          c.classList.add(\"dragging\");\n          // Mark secondary cards for hiding\n          if (c !== card) {\n            c.classList.add(\"multi-drag-secondary\");\n          }\n        });\n        // Add multi-drag badge to primary card\n        addMultiDragBadge(card, dragState.draggedCards.length);\n      }, 0);\n    } else {\n      dragState.isMultiDrag = false;\n      dragState.draggedCards = [card];\n      dragState.sourcePositions = [{\n        card: card,\n        column: card.closest(\".kanban-column-content\"),\n        nextSibling: card.nextElementSibling\n      }];\n\n      // Visual feedback (use timeout to avoid affecting drag image)\n      setTimeout(() => {\n        card.classList.add(\"dragging\");\n      }, 0);\n    }\n\n    // Set drag data\n    e.dataTransfer.setData(\"text/plain\", bookmarkId);\n    e.dataTransfer.effectAllowed = \"move\";\n\n    // Create placeholder\n    dragState.placeholder = createPlaceholder();\n  }\n\n  /**\n   * Add multi-drag badge showing count of cards being dragged\n   */\n  function addMultiDragBadge(card, count) {\n    // Remove any existing badge\n    removeMultiDragBadge();\n    \n    const badge = document.createElement(\"div\");\n    badge.className = \"multi-drag-badge\";\n    badge.textContent = count;\n    badge.id = \"multi-drag-badge\";\n    card.style.position = \"relative\";\n    card.appendChild(badge);\n  }\n\n  /**\n   * Remove multi-drag badge from card\n   */\n  function removeMultiDragBadge() {\n    const badge = document.getElementById(\"multi-drag-badge\");\n    if (badge) {\n      badge.remove();\n    }\n  }\n\n  /**\n   * Handle drag end event\n   */\n  function handleDragEnd(e) {\n    const card = e.target.closest(\".kanban-card\");\n    if (!card) return;\n\n    // Clean up all dragged cards\n    dragState.draggedCards.forEach((c) => {\n      c.classList.remove(\"dragging\");\n      c.classList.remove(\"multi-drag-secondary\");\n    });\n\n    removeMultiDragBadge();\n    removePlaceholder();\n    removeAllDragOverClasses();\n    stopAutoScroll();\n    resetDragState();\n  }\n\n  /**\n   * Handle drag over event - calculate and show drop position\n   */\n  function handleDragOver(e) {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = \"move\";\n\n    // Update auto-scroll based on cursor position\n    if (dragState.isDragging) {\n      updateScrollDirection(e.clientX, e.clientY);\n    }\n\n    const column = e.target.closest(\".kanban-column-content\");\n    if (!column || !dragState.isDragging) return;\n\n    // Calculate drop position and show placeholder\n    const afterCard = getDropPosition(column, e.clientY);\n    updatePlaceholder(column, afterCard);\n  }\n\n  /**\n   * Handle drag enter event - add visual feedback to column\n   */\n  function handleDragEnter(e) {\n    const column = e.target.closest(\".kanban-column-content\");\n    if (!column || !dragState.isDragging) return;\n\n    column.classList.add(\"drag-over\");\n  }\n\n  /**\n   * Handle drag leave event - remove visual feedback from column\n   */\n  function handleDragLeave(e) {\n    const column = e.target.closest(\".kanban-column-content\");\n    if (!column) return;\n\n    // Only remove if actually leaving the column (not entering a child)\n    const relatedTarget = e.relatedTarget;\n    if (!column.contains(relatedTarget)) {\n      column.classList.remove(\"drag-over\");\n    }\n  }\n\n  /**\n   * Handle drop event - move card to new position\n   */\n  function handleDrop(e) {\n    e.preventDefault();\n    stopAutoScroll();\n\n    const column = e.target.closest(\".kanban-column-content\");\n    if (!column || !dragState.draggedCard) return;\n\n    const { draggedCard, draggedCards, sourceColumn, sourceIndex, placeholder, isMultiDrag } = dragState;\n\n    // Get the insert position (the element to insert before)\n    const insertBefore = placeholder ? placeholder.nextElementSibling : null;\n\n    // Remove placeholder first\n    removePlaceholder();\n    removeAllDragOverClasses();\n\n    if (isMultiDrag && draggedCards.length > 1) {\n      // Multi-drag: insert all cards at the drop position\n      // First, remove secondary cards from their hiding\n      draggedCards.forEach((c) => {\n        c.classList.remove(\"dragging\");\n        c.classList.remove(\"multi-drag-secondary\");\n      });\n      removeMultiDragBadge();\n\n      // Insert all cards at the position (in order)\n      draggedCards.forEach((c) => {\n        if (insertBefore) {\n          column.insertBefore(c, insertBefore);\n        } else {\n          column.appendChild(c);\n        }\n      });\n\n      // Calculate after_id (bookmark ID of card before our first inserted card)\n      const firstInsertedCard = draggedCards[0];\n      const afterBookmarkId = getAfterBookmarkId(firstInsertedCard);\n      const newCollectionId = column.dataset.collectionId || \"\";\n\n      // Check if position changed\n      const positionChanged = column !== sourceColumn || \n        draggedCards.some((c, i) => getCardIndex(c) !== (sourceIndex + i));\n\n      if (positionChanged) {\n        // Call bulk move API with position\n        const bookmarkIds = draggedCards.map((c) => parseInt(c.dataset.bookmarkId, 10));\n        bulkMoveBookmarksWithPosition(bookmarkIds, newCollectionId, afterBookmarkId, draggedCards, sourceColumn);\n      }\n\n      // Clear selection after drop\n      clearSelection();\n    } else {\n      // Single card drag (existing behavior)\n      draggedCard.classList.remove(\"dragging\");\n\n      // Insert card at placeholder position\n      if (insertBefore) {\n        column.insertBefore(draggedCard, insertBefore);\n      } else {\n        column.appendChild(draggedCard);\n      }\n\n      // Calculate the new position (after which bookmark)\n      const afterBookmarkId = getAfterBookmarkId(draggedCard);\n      const newIndex = getCardIndex(draggedCard);\n\n      // Check if position actually changed (different column OR different position in same column)\n      const positionChanged = column !== sourceColumn || newIndex !== sourceIndex;\n\n      if (positionChanged) {\n        const bookmarkId = draggedCard.dataset.bookmarkId;\n        const newCollectionId = column.dataset.collectionId || \"\";\n\n        moveBookmark(bookmarkId, newCollectionId, afterBookmarkId, draggedCard, sourceColumn, sourceIndex);\n      }\n    }\n\n    // Update counts\n    updateColumnCounts();\n  }\n\n  /**\n   * Bulk move bookmarks with position support (for multi-drag)\n   */\n  function bulkMoveBookmarksWithPosition(bookmarkIds, collectionId, afterBookmarkId) {\n    bulkMoveBookmarksAPI(bookmarkIds, collectionId, {\n      afterBookmarkId,\n      onSuccess: () => {\n        announceCount(bookmarkIds.length, \"moved\", \"bookmark\");\n      },\n      onError: () => {\n        revertCardsToOriginalPositions();\n      }\n    });\n  }\n\n  /**\n   * Revert cards to their original positions (used on error)\n   */\n  function revertCardsToOriginalPositions() {\n    dragState.sourcePositions.forEach(({ card, column, nextSibling }) => {\n      if (nextSibling && nextSibling.parentNode === column) {\n        column.insertBefore(card, nextSibling);\n      } else {\n        column.appendChild(card);\n      }\n    });\n    updateColumnCounts();\n  }\n\n  // ============================================\n  // KEYBOARD DRAG AND DROP\n  // ============================================\n\n  /**\n   * Start keyboard drag mode\n   */\n  function startKeyboardDrag(card) {\n    const column = card.closest(\".kanban-column-content\");\n\n    keyboardDragState.isActive = true;\n    keyboardDragState.card = card;\n    keyboardDragState.originalColumn = column;\n    keyboardDragState.originalNextSibling = card.nextElementSibling;\n    keyboardDragState.originalIndex = Array.from(\n      column.querySelectorAll(\".kanban-card\")\n    ).indexOf(card);\n\n    card.classList.add(\"keyboard-dragging\");\n    card.setAttribute(\"aria-grabbed\", \"true\");\n    column.classList.add(\"keyboard-drop-target\");\n\n    const title = getCardTitle(card);\n    announce(\n      `Grabbed ${title}. Use arrow keys to move, Enter or Space to drop, Escape to cancel.`\n    );\n  }\n\n  /**\n   * End keyboard drag mode and commit the move\n   */\n  function endKeyboardDrag(cancelled = false) {\n    if (!keyboardDragState.isActive) return;\n\n    const { card, originalColumn, originalNextSibling } = keyboardDragState;\n    const currentColumn = card.closest(\".kanban-column-content\");\n    const title = getCardTitle(card);\n\n    if (cancelled) {\n      // Restore original position\n      if (originalNextSibling) {\n        originalColumn.insertBefore(card, originalNextSibling);\n      } else {\n        originalColumn.appendChild(card);\n      }\n      announce(`Move cancelled. ${title} returned to original position.`);\n    } else {\n      // Commit the move\n      const columnName = getColumnName(currentColumn.closest(\".kanban-column\"));\n      const position = getCardPosition(card);\n      const currentIndex = getCardIndex(card);\n\n      // Check if position actually changed\n      const positionChanged = currentColumn !== originalColumn || currentIndex !== keyboardDragState.originalIndex;\n\n      if (positionChanged) {\n        const bookmarkId = card.dataset.bookmarkId;\n        const newCollectionId = currentColumn.dataset.collectionId || \"\";\n        const afterBookmarkId = getAfterBookmarkId(card);\n\n        moveBookmark(\n          bookmarkId,\n          newCollectionId,\n          afterBookmarkId,\n          card,\n          originalColumn,\n          keyboardDragState.originalIndex\n        );\n      }\n\n      announce(\n        `${title} dropped in ${columnName} at position ${position.index} of ${position.total}.`\n      );\n    }\n\n    // Clean up state\n    card.classList.remove(\"keyboard-dragging\");\n    card.setAttribute(\"aria-grabbed\", \"false\");\n    document.querySelectorAll(\".keyboard-drop-target\").forEach((el) => {\n      el.classList.remove(\"keyboard-drop-target\");\n    });\n\n    // Update column counts\n    updateColumnCounts();\n\n    resetKeyboardDragState();\n    card.focus();\n  }\n\n  /**\n   * Move card up within column\n   */\n  function moveCardUp(card) {\n    const prev = card.previousElementSibling;\n    if (prev && prev.classList.contains(\"kanban-card\")) {\n      card.parentNode.insertBefore(card, prev);\n      const position = getCardPosition(card);\n      announce(`Moved to position ${position.index} of ${position.total}`);\n      card.focus();\n    } else {\n      announce(\"Already at top of column\");\n    }\n  }\n\n  /**\n   * Move card down within column\n   */\n  function moveCardDown(card) {\n    const next = card.nextElementSibling;\n    if (next && next.classList.contains(\"kanban-card\")) {\n      card.parentNode.insertBefore(next, card);\n      const position = getCardPosition(card);\n      announce(`Moved to position ${position.index} of ${position.total}`);\n      card.focus();\n    } else {\n      announce(\"Already at bottom of column\");\n    }\n  }\n\n  /**\n   * Move card to adjacent column (left or right)\n   */\n  function moveCardToColumn(card, direction) {\n    const currentColumnEl = card.closest(\".kanban-column\");\n    const columns = Array.from(\n      document.querySelectorAll(\".kanban-column:not(.kanban-new-column)\")\n    );\n    const currentIndex = columns.indexOf(currentColumnEl);\n    const targetIndex = currentIndex + direction;\n\n    if (targetIndex < 0 || targetIndex >= columns.length) {\n      announce(direction < 0 ? \"Already in first column\" : \"Already in last column\");\n      return;\n    }\n\n    const targetColumnEl = columns[targetIndex];\n    const targetContent = targetColumnEl.querySelector(\".kanban-column-content\");\n    const currentContent = currentColumnEl.querySelector(\".kanban-column-content\");\n\n    // Get current position to maintain same index\n    const currentCards = Array.from(currentContent.querySelectorAll(\".kanban-card\"));\n    const currentPos = currentCards.indexOf(card);\n\n    // Remove empty state from target if present\n    const emptyState = targetContent.querySelector(\".kanban-empty\");\n    if (emptyState) {\n      emptyState.remove();\n    }\n\n    // Find target position (same index or end if fewer cards)\n    const targetCards = Array.from(targetContent.querySelectorAll(\".kanban-card\"));\n    const targetPos = Math.min(currentPos, targetCards.length);\n\n    // Move the card\n    if (targetPos < targetCards.length) {\n      targetContent.insertBefore(card, targetCards[targetPos]);\n    } else {\n      targetContent.appendChild(card);\n    }\n\n    // Update visual feedback\n    currentContent.classList.remove(\"keyboard-drop-target\");\n    targetContent.classList.add(\"keyboard-drop-target\");\n\n    const columnName = getColumnName(targetColumnEl);\n    const position = getCardPosition(card);\n    announce(`Moved to ${columnName}, position ${position.index} of ${position.total}`);\n    card.focus();\n  }\n\n  /**\n   * Move card to top of its column\n   */\n  function moveCardToTop(card) {\n    const column = getColumnContent(card);\n    const firstCard = column.querySelector(\".kanban-card\");\n    if (firstCard && firstCard !== card) {\n      column.insertBefore(card, firstCard);\n      announcePosition(card, \"Moved to top\");\n      scrollCardIntoView(card);\n    }\n  }\n\n  /**\n   * Move card to bottom of its column\n   */\n  function moveCardToBottom(card) {\n    const column = getColumnContent(card);\n    column.appendChild(card);\n    announcePosition(card, \"Moved to bottom\");\n    scrollCardIntoView(card);\n  }\n\n  /**\n   * Announce card position with prefix\n   */\n  function announcePosition(card, prefix) {\n    const position = getCardPosition(card);\n    announce(`${prefix}, position ${position.index} of ${position.total}`);\n  }\n\n  // ============================================\n  // KEYBOARD NAVIGATION (WITHOUT GRAB MODE)\n  // ============================================\n\n  /**\n   * Scroll a card into view smoothly\n   */\n  function scrollCardIntoView(card) {\n    if (!card) return;\n\n    // Scroll the card into view within its column\n    card.scrollIntoView({ behavior: \"smooth\", block: \"nearest\", inline: \"nearest\" });\n\n    // Also ensure the column is visible in the board\n    const column = card.closest(\".kanban-column\");\n    if (column) {\n      const board = document.getElementById(\"kanban-board\");\n      if (board) {\n        const columnRect = column.getBoundingClientRect();\n        const boardRect = board.getBoundingClientRect();\n\n        // If column is partially off-screen horizontally, scroll board\n        if (columnRect.left < boardRect.left) {\n          board.scrollLeft -= (boardRect.left - columnRect.left + 20);\n        } else if (columnRect.right > boardRect.right) {\n          board.scrollLeft += (columnRect.right - boardRect.right + 20);\n        }\n      }\n    }\n  }\n\n  /**\n   * Get all columns (excluding the \"new column\" button)\n   */\n  function getAllColumns() {\n    return Array.from(\n      document.querySelectorAll(\".kanban-column:not(.kanban-new-column)\")\n    );\n  }\n\n  /**\n   * Get all cards in a column\n   */\n  function getCardsInColumn(column) {\n    const content = column.querySelector(\".kanban-column-content\");\n    if (!content) return [];\n    return Array.from(content.querySelectorAll(\".kanban-card\"));\n  }\n\n  /**\n   * Focus card in vertical direction (up/down within column)\n   */\n  function focusCardInDirection(card, direction) {\n    const column = card.closest(\".kanban-column\");\n    const cards = getCardsInColumn(column);\n    const currentIndex = cards.indexOf(card);\n    const targetIndex = currentIndex + direction;\n\n    if (targetIndex >= 0 && targetIndex < cards.length) {\n      const targetCard = cards[targetIndex];\n      targetCard.focus();\n      scrollCardIntoView(targetCard);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Focus card in adjacent column (left/right)\n   */\n  function focusCardInAdjacentColumn(card, direction) {\n    const columns = getAllColumns();\n    const currentColumn = card.closest(\".kanban-column\");\n    const currentColumnIndex = columns.indexOf(currentColumn);\n    const targetColumnIndex = currentColumnIndex + direction;\n\n    if (targetColumnIndex < 0 || targetColumnIndex >= columns.length) {\n      return false;\n    }\n\n    const targetColumn = columns[targetColumnIndex];\n    const currentCards = getCardsInColumn(currentColumn);\n    const targetCards = getCardsInColumn(targetColumn);\n\n    if (targetCards.length === 0) {\n      // No cards in target column, try next column in same direction\n      // Or just stay where we are\n      return false;\n    }\n\n    // Try to maintain same index, or go to last card if target has fewer\n    const currentIndex = currentCards.indexOf(card);\n    const targetIndex = Math.min(currentIndex, targetCards.length - 1);\n    const targetCard = targetCards[targetIndex];\n\n    targetCard.focus();\n    scrollCardIntoView(targetCard);\n    return true;\n  }\n\n  /**\n   * Focus first card in first column\n   */\n  function focusFirstCard() {\n    const columns = getAllColumns();\n    for (const column of columns) {\n      const cards = getCardsInColumn(column);\n      if (cards.length > 0) {\n        cards[0].focus();\n        scrollCardIntoView(cards[0]);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Focus last card in last column\n   */\n  function focusLastCard() {\n    const columns = getAllColumns();\n    for (let i = columns.length - 1; i >= 0; i--) {\n      const cards = getCardsInColumn(columns[i]);\n      if (cards.length > 0) {\n        const lastCard = cards[cards.length - 1];\n        lastCard.focus();\n        scrollCardIntoView(lastCard);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  // ============================================\n  // QUICK ACTIONS\n  // ============================================\n\n  /**\n   * Trigger edit action for a card\n   */\n  function triggerEditAction(card) {\n    const editBtn = card.querySelector('[hx-get*=\"/edit-drawer\"]');\n    if (editBtn) {\n      editBtn.click();\n    }\n  }\n\n  /**\n   * Open URL for a card\n   */\n  function triggerOpenUrl(card) {\n    // Get URL from card's data or find the link in the dropdown\n    const openUrlLink = card.querySelector('a[target=\"_blank\"]');\n    if (openUrlLink) {\n      window.open(openUrlLink.href, \"_blank\", \"noopener,noreferrer\");\n    }\n  }\n\n  /**\n   * Trigger delete action for a card\n   */\n  function triggerDeleteAction(card) {\n    const deleteBtn = card.querySelector('[hx-delete]');\n    if (deleteBtn) {\n      deleteBtn.click();\n    }\n  }\n\n  // ============================================\n  // HELP MODAL\n  // ============================================\n\n  /**\n   * Toggle help modal visibility\n   */\n  function toggleHelpModal() {\n    const modal = document.getElementById(\"kanban-help-modal\");\n    if (!modal) return;\n\n    const isHidden = modal.classList.contains(\"hidden\");\n    if (isHidden) {\n      modal.classList.remove(\"hidden\");\n      // Focus the close button\n      const closeBtn = modal.querySelector(\"[data-close-modal]\");\n      if (closeBtn) closeBtn.focus();\n    } else {\n      modal.classList.add(\"hidden\");\n      // Return focus to the board\n      const firstCard = document.querySelector(\".kanban-card\");\n      if (firstCard) firstCard.focus();\n    }\n  }\n\n  /**\n   * Close help modal\n   */\n  function closeHelpModal() {\n    const modal = document.getElementById(\"kanban-help-modal\");\n    if (modal && !modal.classList.contains(\"hidden\")) {\n      modal.classList.add(\"hidden\");\n      // Return focus to the board\n      const firstCard = document.querySelector(\".kanban-card\");\n      if (firstCard) firstCard.focus();\n    }\n  }\n\n  /**\n   * Handle keyboard events on cards\n   */\n  function handleCardKeydown(e) {\n    const card = e.target.closest(\".kanban-card\");\n    if (!card) return;\n\n    const isOnCard = e.target === card;\n    const isOnDragHandle = e.target.closest(\".kanban-card-drag-handle\");\n    const isOnInteractiveElement = !isOnCard && !isOnDragHandle;\n    const isGrabbed = keyboardDragState.isActive && keyboardDragState.card === card;\n    const hasModifier = e.metaKey || e.ctrlKey;\n    const hasMultiSelection = selectionState.selectedIds.size > 1;\n\n    switch (e.key) {\n      case \" \":\n      case \"Enter\":\n        if (isOnInteractiveElement) return;\n        e.preventDefault();\n        isGrabbed ? endKeyboardDrag(false) : startKeyboardDrag(card);\n        break;\n\n      case \"ArrowUp\":\n        e.preventDefault();\n        if (hasModifier) {\n          isGrabbed ? moveCardToTop(card) : focusFirstCard();\n        } else if (e.shiftKey && !isGrabbed) {\n          extendSelectionInDirection(card, -1);\n        } else if (isGrabbed) {\n          moveCardUp(card);\n          scrollCardIntoView(card);\n        } else {\n          focusCardInDirection(card, -1);\n        }\n        break;\n\n      case \"ArrowDown\":\n        e.preventDefault();\n        if (hasModifier) {\n          isGrabbed ? moveCardToBottom(card) : focusLastCard();\n        } else if (e.shiftKey && !isGrabbed) {\n          extendSelectionInDirection(card, 1);\n        } else if (isGrabbed) {\n          moveCardDown(card);\n          scrollCardIntoView(card);\n        } else {\n          focusCardInDirection(card, 1);\n        }\n        break;\n\n      case \"ArrowLeft\":\n        e.preventDefault();\n        isGrabbed ? moveCardToColumn(card, -1) : focusCardInAdjacentColumn(card, -1);\n        if (isGrabbed) scrollCardIntoView(card);\n        break;\n\n      case \"ArrowRight\":\n        e.preventDefault();\n        isGrabbed ? moveCardToColumn(card, 1) : focusCardInAdjacentColumn(card, 1);\n        if (isGrabbed) scrollCardIntoView(card);\n        break;\n\n      case \"Home\":\n        e.preventDefault();\n        if (isGrabbed && hasModifier) {\n          moveCardToTop(card);\n        } else if (!isGrabbed) {\n          focusFirstCard();\n        }\n        break;\n\n      case \"End\":\n        e.preventDefault();\n        if (isGrabbed && hasModifier) {\n          moveCardToBottom(card);\n        } else if (!isGrabbed) {\n          focusLastCard();\n        }\n        break;\n\n      case \"Escape\":\n        if (isGrabbed) {\n          e.preventDefault();\n          endKeyboardDrag(true);\n        } else if (selectionState.selectedIds.size > 0) {\n          e.preventDefault();\n          clearSelection();\n          announce(\"Selection cleared\");\n        }\n        break;\n\n      case \"a\":\n      case \"A\":\n        if (hasModifier && !isGrabbed && isOnCard) {\n          e.preventDefault();\n          selectAllInColumn(card);\n        }\n        break;\n\n      case \"e\":\n      case \"E\":\n        if (!isGrabbed && isOnCard) {\n          e.preventDefault();\n          triggerEditAction(card);\n        }\n        break;\n\n      case \"o\":\n      case \"O\":\n        if (!isGrabbed && isOnCard) {\n          e.preventDefault();\n          triggerOpenUrl(card);\n        }\n        break;\n\n      case \"Delete\":\n      case \"Backspace\":\n        if (!isGrabbed && isOnCard) {\n          e.preventDefault();\n          hasMultiSelection ? handleBulkDelete() : triggerDeleteAction(card);\n        }\n        break;\n\n      case \"m\":\n      case \"M\":\n        if (!isGrabbed && hasMultiSelection) {\n          e.preventDefault();\n          openMoveMenu();\n        }\n        break;\n    }\n  }\n\n  // ============================================\n  // API AND STATE UPDATES\n  // ============================================\n\n  /**\n   * Get the bookmark ID of the card before the given card (for position tracking)\n   * Returns empty string if card is at the beginning of the column\n   */\n  function getAfterBookmarkId(card) {\n    const prevSibling = card.previousElementSibling;\n    if (prevSibling && prevSibling.classList.contains(\"kanban-card\")) {\n      return prevSibling.dataset.bookmarkId || \"\";\n    }\n    return \"\";\n  }\n\n  /**\n   * Move a bookmark to a new position (possibly in a different collection)\n   * afterBookmarkId: ID of the bookmark to insert after (empty = insert at start)\n   */\n  function moveBookmark(bookmarkId, collectionId, afterBookmarkId, item, fromColumn, oldIndex) {\n    const url = `/admin/htmx/bookmarks/${bookmarkId}/collection`;\n    const csrfToken = getCSRFToken();\n\n    // Build request body with collection_id and after_id\n    let body = `collection_id=${encodeURIComponent(collectionId)}`;\n    if (afterBookmarkId) {\n      body += `&after_id=${encodeURIComponent(afterBookmarkId)}`;\n    }\n\n    fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"X-CSRF-Token\": csrfToken,\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n      },\n      body: body,\n    })\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(`Failed to move bookmark: ${response.status}`);\n        }\n        // Update column counts\n        updateColumnCounts();\n        // Show success feedback\n        showMoveSuccess(item);\n      })\n      .catch((error) => {\n        console.error(\"[Kanban] Error moving bookmark:\", error);\n        revertMove(item, fromColumn, oldIndex);\n        updateColumnCounts();\n        showErrorToast(\"Failed to move bookmark. Please try again.\");\n      });\n  }\n\n  /**\n   * Revert a failed move\n   */\n  function revertMove(item, fromColumn, oldIndex) {\n    const children = Array.from(fromColumn.querySelectorAll(\".kanban-card\"));\n    if (oldIndex >= children.length) {\n      fromColumn.appendChild(item);\n    } else {\n      fromColumn.insertBefore(item, children[oldIndex]);\n    }\n  }\n\n  /**\n   * Update column counts after move\n   */\n  function updateColumnCounts() {\n    const columns = document.querySelectorAll(\".kanban-column\");\n    columns.forEach((column) => {\n      const content = column.querySelector(\".kanban-column-content\");\n      const countEl = column.querySelector(\".kanban-column-count\");\n      if (content && countEl) {\n        const cards = content.querySelectorAll(\".kanban-card\");\n        countEl.textContent = cards.length.toString();\n\n        // Update empty state\n        const emptyState = content.querySelector(\".kanban-empty\");\n        if (cards.length === 0 && !emptyState) {\n          const isUnsorted = column.dataset.unsorted === \"true\";\n          const emptyDiv = document.createElement(\"div\");\n          emptyDiv.className = \"kanban-empty\";\n          emptyDiv.innerHTML = `<p class=\"kanban-empty-text\">${\n            isUnsorted ? \"No unsorted bookmarks\" : \"Drop bookmarks here\"\n          }</p>`;\n          content.appendChild(emptyDiv);\n        } else if (cards.length > 0 && emptyState) {\n          emptyState.remove();\n        }\n      }\n    });\n  }\n\n  /**\n   * Show success feedback on moved item\n   */\n  function showMoveSuccess(item) {\n    item.classList.add(\"bg-green-50\");\n    setTimeout(() => {\n      item.classList.remove(\"bg-green-50\");\n    }, 500);\n  }\n\n  // ============================================\n  // BULK OPERATIONS\n  // ============================================\n\n  /**\n   * Handle bulk delete of selected cards\n   */\n  function handleBulkDelete() {\n    const count = selectionState.selectedIds.size;\n    if (count === 0) return;\n\n    const confirmed = confirm(`Are you sure you want to delete ${count} ${pluralize(count, \"bookmark\")}?`);\n    if (!confirmed) return;\n\n    const bookmarkIds = getSelectedBookmarkIds();\n    const csrfToken = getCSRFToken();\n\n    fetch(\"/admin/htmx/bookmarks/bulk/delete\", {\n      method: \"DELETE\",\n      headers: {\n        \"X-CSRF-Token\": csrfToken,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ bookmark_ids: bookmarkIds }),\n    })\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error(`Failed to delete bookmarks: ${response.status}`);\n        }\n        // Remove cards from DOM\n        bookmarkIds.forEach((id) => {\n          const card = getCardById(id);\n          if (card) card.remove();\n        });\n        clearSelection();\n        updateColumnCounts();\n        announceCount(count, \"deleted\", \"bookmark\");\n      })\n      .catch((error) => {\n        console.error(\"[Kanban] Error deleting bookmarks:\", error);\n        showErrorToast(\"Failed to delete bookmarks. Please try again.\");\n      });\n  }\n\n  /**\n   * Handle bulk move of selected cards to a collection\n   */\n  function handleBulkMove(collectionId) {\n    const count = selectionState.selectedIds.size;\n    if (count === 0) return;\n\n    const bookmarkIds = getSelectedBookmarkIds();\n\n    bulkMoveBookmarksAPI(bookmarkIds, collectionId, {\n      onSuccess: () => {\n        // Move cards in DOM to target column\n        const targetColumn = collectionId === \"\"\n          ? document.querySelector('.kanban-column[data-unsorted=\"true\"] .kanban-column-content')\n          : document.querySelector(`.kanban-column[data-collection-id=\"${collectionId}\"] .kanban-column-content`);\n\n        if (targetColumn) {\n          // Remove empty state from target if present\n          const emptyState = targetColumn.querySelector(\".kanban-empty\");\n          if (emptyState) emptyState.remove();\n\n          bookmarkIds.forEach((id) => {\n            const card = getCardById(id);\n            if (card) {\n              targetColumn.appendChild(card);\n            }\n          });\n        }\n\n        clearSelection();\n        updateColumnCounts();\n        announceCount(count, \"moved\", \"bookmark\");\n      }\n    });\n  }\n\n  // ============================================\n  // INITIALIZATION\n  // ============================================\n\n  /**\n   * Handle global keyboard events (for help modal, move menu, etc.)\n   */\n  function handleGlobalKeydown(e) {\n    // Move menu keyboard handling (highest priority when open)\n    if (moveMenuState.isOpen) {\n      handleMoveMenuKeydown(e);\n      return;\n    }\n\n    // Help modal toggle with ?\n    if (e.key === \"?\" && !e.target.closest(\"input, textarea, select\")) {\n      e.preventDefault();\n      toggleHelpModal();\n      return;\n    }\n\n    // Close help modal with Escape\n    if (e.key === \"Escape\") {\n      const modal = document.getElementById(\"kanban-help-modal\");\n      if (modal && !modal.classList.contains(\"hidden\")) {\n        e.preventDefault();\n        closeHelpModal();\n        return;\n      }\n    }\n  }\n\n  /**\n   * Initialize the Kanban board\n   */\n  function init() {\n    const board = document.getElementById(\"kanban-board\");\n    if (!board) return;\n\n    // Native drag and drop events (delegated)\n    board.addEventListener(\"dragstart\", handleDragStart);\n    board.addEventListener(\"dragend\", handleDragEnd);\n    board.addEventListener(\"dragover\", handleDragOver);\n    board.addEventListener(\"dragenter\", handleDragEnter);\n    board.addEventListener(\"dragleave\", handleDragLeave);\n    board.addEventListener(\"drop\", handleDrop);\n\n    // Keyboard navigation on cards\n    board.addEventListener(\"keydown\", handleCardKeydown);\n\n    // Multi-select click handling\n    board.addEventListener(\"click\", handleCardClick);\n\n    // Clear selection when clicking empty space\n    document.addEventListener(\"click\", handleBoardClick);\n\n    // Global keyboard events (help modal, etc.)\n    document.addEventListener(\"keydown\", handleGlobalKeydown);\n\n    // Help modal event handlers\n    const helpModal = document.getElementById(\"kanban-help-modal\");\n    if (helpModal) {\n      // Close when clicking backdrop\n      helpModal.addEventListener(\"click\", (e) => {\n        if (e.target === helpModal) {\n          closeHelpModal();\n        }\n      });\n      // Close button\n      const closeBtn = helpModal.querySelector(\"[data-close-modal]\");\n      if (closeBtn) {\n        closeBtn.addEventListener(\"click\", closeHelpModal);\n      }\n    }\n\n    // Selection toolbar event handlers\n    initSelectionToolbar();\n\n    // Move menu backdrop click handler\n    const moveMenuBackdrop = document.getElementById(\"kanban-move-menu-backdrop\");\n    if (moveMenuBackdrop) {\n      moveMenuBackdrop.addEventListener(\"click\", handleMoveMenuBackdropClick);\n    }\n\n    // Listen for HTMX events to reinitialize after content changes\n    document.body.addEventListener(\"htmx:afterSwap\", handleAfterSwap);\n  }\n\n  /**\n   * Initialize selection toolbar event handlers\n   */\n  function initSelectionToolbar() {\n    const toolbar = document.getElementById(\"kanban-selection-toolbar\");\n    if (!toolbar) return;\n\n    // Clear selection button\n    const clearBtn = toolbar.querySelector(\".clear-selection\");\n    if (clearBtn) {\n      clearBtn.addEventListener(\"click\", clearSelection);\n    }\n\n    // Delete selected button\n    const deleteBtn = toolbar.querySelector(\".delete-selected\");\n    if (deleteBtn) {\n      deleteBtn.addEventListener(\"click\", handleBulkDelete);\n    }\n\n    // Move dropdown\n    const moveDropdown = toolbar.querySelector(\"[data-selection-move-dropdown]\");\n    if (moveDropdown) {\n      const trigger = moveDropdown.querySelector(\"[data-selection-move-trigger]\");\n      const menu = moveDropdown.querySelector(\"[data-selection-move-menu]\");\n\n      if (trigger && menu) {\n        // Toggle dropdown on trigger click\n        trigger.addEventListener(\"click\", (e) => {\n          e.stopPropagation();\n          const isOpen = menu.classList.contains(\"open\");\n          if (isOpen) {\n            menu.classList.remove(\"open\");\n            trigger.setAttribute(\"aria-expanded\", \"false\");\n          } else {\n            menu.classList.add(\"open\");\n            trigger.setAttribute(\"aria-expanded\", \"true\");\n          }\n        });\n\n        // Handle move option clicks\n        menu.querySelectorAll(\"[data-move-collection-id]\").forEach((option) => {\n          option.addEventListener(\"click\", () => {\n            const collectionId = option.dataset.moveCollectionId;\n            handleBulkMove(collectionId);\n            menu.classList.remove(\"open\");\n            trigger.setAttribute(\"aria-expanded\", \"false\");\n          });\n        });\n\n        // Close dropdown when clicking outside\n        document.addEventListener(\"click\", (e) => {\n          if (!moveDropdown.contains(e.target)) {\n            menu.classList.remove(\"open\");\n            trigger.setAttribute(\"aria-expanded\", \"false\");\n          }\n        });\n      }\n    }\n  }\n\n  /**\n   * Handle HTMX afterSwap to reinitialize if needed\n   */\n  function handleAfterSwap(evt) {\n    // If the kanban board was replaced, reinitialize\n    if (\n      evt.detail.target.id === \"kanban-board\" ||\n      evt.detail.target.id === \"bookmarks-content\"\n    ) {\n      cleanup();\n      init();\n    }\n  }\n\n  /**\n   * Cleanup event listeners\n   */\n  function cleanup() {\n    const board = document.getElementById(\"kanban-board\");\n    if (board) {\n      board.removeEventListener(\"dragstart\", handleDragStart);\n      board.removeEventListener(\"dragend\", handleDragEnd);\n      board.removeEventListener(\"dragover\", handleDragOver);\n      board.removeEventListener(\"dragenter\", handleDragEnter);\n      board.removeEventListener(\"dragleave\", handleDragLeave);\n      board.removeEventListener(\"drop\", handleDrop);\n      board.removeEventListener(\"keydown\", handleCardKeydown);\n      board.removeEventListener(\"click\", handleCardClick);\n    }\n\n    // Remove global listeners\n    document.removeEventListener(\"keydown\", handleGlobalKeydown);\n    document.removeEventListener(\"click\", handleBoardClick);\n\n    // Close help modal if open\n    closeHelpModal();\n\n    // Clear selection\n    clearSelection();\n\n    // Cancel any active keyboard drag\n    if (keyboardDragState.isActive) {\n      endKeyboardDrag(true);\n    }\n\n    // Stop auto-scroll\n    stopAutoScroll();\n\n    // Clean up drag state\n    removePlaceholder();\n    removeAllDragOverClasses();\n    dragState.isDragging = false;\n    dragState.draggedCard = null;\n    dragState.sourceColumn = null;\n    dragState.sourceIndex = null;\n    dragState.placeholder = null;\n  }\n\n  // Export for global access\n  window.kanban = {\n    init: init,\n    cleanup: cleanup,\n    announce: announce,\n  };\n\n  // Initialize on DOM ready\n  document.addEventListener(\"DOMContentLoaded\", init);\n})();\n", "/**\n * ec-toast-container - Toast notifications Web Component\n *\n * Provides toast notifications with HTMX error handling integration.\n *\n * Usage:\n * <ec-toast-container></ec-toast-container>\n *\n * API:\n * Toast.show('Message', 'error');   // Error toast (default)\n * Toast.show('Message', 'success'); // Success toast\n * Toast.show('Message', 'warning'); // Warning toast\n * Toast.show('Message', 'info');    // Info toast\n * Toast.error('Message');           // Shorthand\n * Toast.success('Message');         // Shorthand\n */\n\nclass EcToastContainer extends HTMLElement {\n  // ============================================\n  // CONFIGURATION\n  // ============================================\n\n  static CONFIG = {\n    /** Auto-dismiss delay in milliseconds */\n    DISMISS_DELAY: 3000,\n    /** Exit animation duration in milliseconds */\n    EXIT_ANIMATION_DURATION: 200,\n    /** Request timeout for inline content areas */\n    RETRY_TIMEOUT: 10000,\n  };\n\n  static ICONS = {\n    error: '<span class=\"toast-icon\" aria-hidden=\"true\">&#x2717;</span>',\n    success: '<span class=\"toast-icon\" aria-hidden=\"true\">&#x2713;</span>',\n    warning: '<span class=\"toast-icon\" aria-hidden=\"true\">&#x26A0;</span>',\n    info: '<span class=\"toast-icon\" aria-hidden=\"true\">&#x2139;</span>',\n  };\n\n  // ============================================\n  // PRIVATE STATE\n  // ============================================\n\n  #abortController = null;\n  #requestTimeouts = new WeakMap();\n\n  // ============================================\n  // LIFECYCLE\n  // ============================================\n\n  connectedCallback() {\n    // Set up container attributes\n    this.setAttribute(\"role\", \"status\");\n    this.setAttribute(\"aria-live\", \"polite\");\n    this.setAttribute(\"aria-label\", \"Notifications\");\n\n    // Setup event listeners with AbortController\n    this.#abortController = new AbortController();\n    this.#setupHtmxHandlers(this.#abortController.signal);\n\n    // Register global instance\n    window.Toast = this;\n  }\n\n  disconnectedCallback() {\n    this.#abortController?.abort();\n\n    // Clear global reference if it points to this instance\n    if (window.Toast === this) {\n      window.Toast = null;\n    }\n  }\n\n  // ============================================\n  // PUBLIC API\n  // ============================================\n\n  /**\n   * Show a toast notification\n   * @param {string} message - The message to display\n   * @param {string} [type='error'] - Toast type: error, success, warning, info\n   * @returns {HTMLElement} The toast element\n   */\n  show(message, type = \"error\") {\n    const toast = document.createElement(\"div\");\n    toast.className = `toast toast-${type}`;\n    toast.setAttribute(\"role\", \"alert\");\n    toast.setAttribute(\"aria-live\", \"polite\");\n\n    const icon = EcToastContainer.ICONS[type] || EcToastContainer.ICONS.error;\n    toast.innerHTML = `${icon} ${this.#escapeHtml(message)}`;\n\n    // Click to dismiss\n    toast.addEventListener(\"click\", () => this.dismiss(toast));\n\n    this.appendChild(toast);\n\n    // Auto-dismiss\n    setTimeout(\n      () => this.dismiss(toast),\n      EcToastContainer.CONFIG.DISMISS_DELAY\n    );\n\n    return toast;\n  }\n\n  /**\n   * Dismiss a toast with animation\n   * @param {HTMLElement} toast - The toast element to dismiss\n   */\n  dismiss(toast) {\n    if (!toast || toast.classList.contains(\"toast-exit\")) {\n      return; // Already dismissing\n    }\n\n    toast.classList.add(\"toast-exit\");\n    setTimeout(() => {\n      if (toast.parentNode) {\n        toast.remove();\n      }\n    }, EcToastContainer.CONFIG.EXIT_ANIMATION_DURATION);\n  }\n\n  // Convenience methods\n  error(msg) {\n    return this.show(msg, \"error\");\n  }\n  success(msg) {\n    return this.show(msg, \"success\");\n  }\n  warning(msg) {\n    return this.show(msg, \"warning\");\n  }\n  info(msg) {\n    return this.show(msg, \"info\");\n  }\n\n  // ============================================\n  // PRIVATE METHODS\n  // ============================================\n\n  /**\n   * Escape HTML to prevent XSS\n   * @param {string} text\n   * @returns {string}\n   */\n  #escapeHtml(text) {\n    const div = document.createElement(\"div\");\n    div.textContent = text;\n    return div.innerHTML;\n  }\n\n  /**\n   * Generate inline spinner HTML\n   * @returns {string}\n   */\n  #inlineSpinnerHtml() {\n    return `\n      <div class=\"flex items-center justify-center py-4 text-muted-foreground\">\n        <svg class=\"animate-spin\" xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n          <path d=\"M21 12a9 9 0 1 1-6.219-8.56\"></path>\n        </svg>\n      </div>\n    `;\n  }\n\n  /**\n   * Generate inline error HTML for network errors\n   * @param {string} message - Error message\n   * @param {string} retryUrl - URL to retry\n   * @returns {string}\n   */\n  #inlineErrorHtml(message, retryUrl) {\n    return `\n      <div class=\"flex items-center justify-center gap-2 py-4 text-sm text-destructive\" data-inline-error>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n          <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n          <line x1=\"12\" x2=\"12\" y1=\"8\" y2=\"12\"></line>\n          <line x1=\"12\" x2=\"12.01\" y1=\"16\" y2=\"16\"></line>\n        </svg>\n        <span>${this.#escapeHtml(message)}</span>\n        <button type=\"button\" class=\"btn-ghost btn-sm\" data-retry-url=\"${this.#escapeHtml(retryUrl)}\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n            <path d=\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\"></path>\n            <path d=\"M21 3v5h-5\"></path>\n            <path d=\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\"></path>\n            <path d=\"M8 16H3v5\"></path>\n          </svg>\n        </button>\n      </div>\n    `;\n  }\n\n  /**\n   * Find the container for inline error display\n   * @param {HTMLElement} element\n   * @returns {HTMLElement|null}\n   */\n  #findErrorContainer(element) {\n    // If this is inside an inline error, find the parent container\n    const inlineError = element.closest(\"[data-inline-error]\");\n    if (inlineError) {\n      const container = inlineError.closest('[hx-get][hx-swap=\"innerHTML\"]');\n      if (container) return container;\n    }\n\n    // Check if the element itself is a valid container\n    const swapAttr = element.getAttribute(\"hx-swap\");\n    if (swapAttr && swapAttr.includes(\"innerHTML\")) {\n      return element;\n    }\n\n    return null;\n  }\n\n  /**\n   * Setup HTMX event handlers\n   * @param {AbortSignal} signal\n   */\n  #setupHtmxHandlers(signal) {\n    // Track request start and set timeout for inline content areas\n    document.body.addEventListener(\n      \"htmx:beforeRequest\",\n      (event) => {\n        const target = event.detail.elt;\n        const swapAttr = target.getAttribute(\"hx-swap\");\n        const retryUrl = target.getAttribute(\"hx-get\");\n\n        // Only set timeout for inline content areas\n        if (swapAttr && swapAttr.includes(\"innerHTML\") && retryUrl) {\n          const timeoutId = setTimeout(() => {\n            // Abort the request\n            if (event.detail.xhr) {\n              event.detail.xhr.abort();\n            }\n            target.innerHTML = this.#inlineErrorHtml(\n              \"Request timed out\",\n              retryUrl\n            );\n          }, EcToastContainer.CONFIG.RETRY_TIMEOUT);\n\n          this.#requestTimeouts.set(target, timeoutId);\n        }\n      },\n      { signal }\n    );\n\n    // Clear timeout when request completes (success or error)\n    document.body.addEventListener(\n      \"htmx:afterRequest\",\n      (event) => {\n        const target = event.detail.elt;\n        const timeoutId = this.#requestTimeouts.get(target);\n        if (timeoutId) {\n          clearTimeout(timeoutId);\n          this.#requestTimeouts.delete(target);\n        }\n      },\n      { signal }\n    );\n\n    // Handle server errors (4xx/5xx)\n    document.body.addEventListener(\n      \"htmx:responseError\",\n      (event) => {\n        const target = event.detail.elt;\n        const swapAttr = target.getAttribute(\"hx-swap\");\n\n        // Don't show toast if this is an inline content area\n        if (swapAttr && swapAttr.includes(\"innerHTML\")) {\n          return;\n        }\n\n        this.show(\"Failed to save\", \"error\");\n      },\n      { signal }\n    );\n\n    // Handle network errors (offline, timeout, etc.)\n    document.body.addEventListener(\n      \"htmx:sendError\",\n      (event) => {\n        const target = event.detail.elt;\n        const container = this.#findErrorContainer(target);\n        const retryUrl =\n          target.getAttribute(\"hx-get\") ||\n          target.getAttribute(\"data-retry-url\");\n\n        if (container && retryUrl) {\n          container.innerHTML = this.#inlineErrorHtml(\n            \"Connection error\",\n            retryUrl\n          );\n        } else {\n          this.show(\"Connection error\", \"error\");\n        }\n      },\n      { signal }\n    );\n\n    // Handle retry button clicks (using event delegation)\n    document.body.addEventListener(\n      \"click\",\n      (event) => {\n        const retryBtn = event.target.closest(\"[data-retry-url]\");\n        if (!retryBtn) return;\n\n        const retryUrl = retryBtn.getAttribute(\"data-retry-url\");\n        const container = retryBtn.closest('[hx-get][hx-swap=\"innerHTML\"]');\n\n        if (container && retryUrl) {\n          // Show spinner while retrying\n          container.innerHTML = this.#inlineSpinnerHtml();\n\n          // Set timeout to show error if request takes too long\n          const timeoutId = setTimeout(() => {\n            container.innerHTML = this.#inlineErrorHtml(\n              \"Request timed out\",\n              retryUrl\n            );\n          }, EcToastContainer.CONFIG.RETRY_TIMEOUT);\n\n          // Trigger the HTMX request\n          htmx\n            .ajax(\"GET\", retryUrl, { target: container, swap: \"innerHTML\" })\n            .then(() => {\n              clearTimeout(timeoutId);\n            })\n            .catch(() => {\n              clearTimeout(timeoutId);\n              container.innerHTML = this.#inlineErrorHtml(\n                \"Connection error\",\n                retryUrl\n              );\n            });\n        }\n      },\n      { signal }\n    );\n  }\n}\n\n// ============================================\n// REGISTER CUSTOM ELEMENT\n// ============================================\n\ncustomElements.define(\"ec-toast-container\", EcToastContainer);\n\n// ============================================\n// BACKWARD COMPATIBILITY\n// ============================================\n\n// Expose class for external use\nwindow.EcToastContainer = EcToastContainer;\n", "/**\n * ec-dropdown - Custom dropdown Web Component (Light DOM)\n *\n * Features:\n * - Portal rendering (escapes overflow:hidden)\n * - Smart dropup detection (opens upward if near viewport bottom)\n * - Close on scroll (except within dropdown)\n * - Close on click outside\n * - Keyboard navigation (Arrow keys, Enter, Escape)\n * - HTMX integration (auto cleanup on swap)\n * - Full ARIA support\n *\n * @example\n * <ec-dropdown>\n *   <input type=\"hidden\" id=\"my-dropdown\" value=\"\">\n *   <button data-trigger>\n *     <span data-label>Select...</span>\n *   </button>\n *   <div data-menu class=\"hidden\">\n *     <button data-option data-value=\"1\">Option 1</button>\n *     <button data-option data-value=\"2\">Option 2</button>\n *   </div>\n * </ec-dropdown>\n */\n\n// ============================================\n// CONFIGURATION\n// ============================================\n\nconst CONFIG = {\n  /** Maximum height of dropdown menu in pixels */\n  DEFAULT_MAX_HEIGHT: 240,\n  /** Minimum height to ensure dropdown is usable */\n  MIN_HEIGHT: 100,\n  /** Margin from viewport edge in pixels */\n  VIEWPORT_MARGIN: 4,\n  /** Gap between trigger and menu in pixels */\n  TRIGGER_GAP: 2,\n  /** Z-index for dropdown menu */\n  Z_INDEX: 100,\n};\n\n// ============================================\n// GLOBAL REGISTRY\n// ============================================\n\n/** @type {Map<string, EcDropdown>} Store dropdown instances for external access */\nconst dropdownRegistry = new Map();\n\n// ============================================\n// WEB COMPONENT\n// ============================================\n\nclass EcDropdown extends HTMLElement {\n  // Private state\n  #abortController = null;\n  #scrollAbortController = null;\n  #isOpen = false;\n\n  // Element references\n  #trigger = null;\n  #menu = null;\n  #input = null;\n  #labelEl = null;\n  #options = [];\n  #portal = null;\n  #menuOriginalParent = null;\n\n  // ============================================\n  // LIFECYCLE\n  // ============================================\n\n  connectedCallback() {\n    // Find child elements\n    this.#trigger = this.querySelector(\"[data-trigger]\");\n    this.#menu = this.querySelector(\"[data-menu]\");\n    this.#input = this.querySelector('input[type=\"hidden\"]');\n    this.#labelEl = this.querySelector(\"[data-label]\");\n    this.#options = [...this.querySelectorAll(\"[data-option]\")];\n    this.#portal = document.getElementById(\"dropdown-portal\");\n\n    // Validate required elements\n    if (!this.#trigger || !this.#menu) {\n      console.warn(\"ec-dropdown: Missing [data-trigger] or [data-menu]\", this);\n      return;\n    }\n\n    // Setup with AbortController for easy cleanup\n    this.#abortController = new AbortController();\n    const { signal } = this.#abortController;\n\n    this.#initAria();\n    this.#setupListeners(signal);\n    this.#moveToPortal();\n\n    // Register in global registry\n    const id = this.#input?.id;\n    if (id) {\n      dropdownRegistry.set(id, this);\n    }\n  }\n\n  disconnectedCallback() {\n    // Abort all listeners\n    this.#abortController?.abort();\n    this.#scrollAbortController?.abort();\n\n    // Restore menu from portal before element is removed\n    this.#restoreFromPortal();\n\n    // Close if open\n    if (this.#isOpen) {\n      this.#isOpen = false;\n    }\n\n    // Unregister from global registry\n    const id = this.#input?.id;\n    if (id) {\n      dropdownRegistry.delete(id);\n    }\n  }\n\n  // ============================================\n  // INITIALIZATION\n  // ============================================\n\n  #initAria() {\n    // Generate unique IDs for ARIA references\n    const baseId = this.#input?.id || `dropdown-${Date.now()}`;\n    const menuId = `${baseId}-listbox`;\n\n    // Set up trigger as a combobox/listbox opener\n    this.#trigger.setAttribute(\"aria-haspopup\", \"listbox\");\n    this.#trigger.setAttribute(\"aria-controls\", menuId);\n    this.#trigger.setAttribute(\"aria-expanded\", \"false\");\n\n    // Set up menu as listbox\n    this.#menu.setAttribute(\"role\", \"listbox\");\n    this.#menu.setAttribute(\"id\", menuId);\n    this.#menu.setAttribute(\"tabindex\", \"-1\");\n\n    // Set up each option\n    this.#options.forEach((opt, index) => {\n      const optionId = `${baseId}-option-${index}`;\n      opt.setAttribute(\"role\", \"option\");\n      opt.setAttribute(\"id\", optionId);\n\n      // Set aria-selected based on data-selected attribute\n      const isSelected = opt.getAttribute(\"data-selected\") === \"true\";\n      opt.setAttribute(\"aria-selected\", isSelected ? \"true\" : \"false\");\n    });\n\n    // Set initial aria-activedescendant on trigger\n    const selectedOption = this.#options.find(\n      (o) => o.getAttribute(\"data-selected\") === \"true\"\n    );\n    if (selectedOption) {\n      this.#trigger.setAttribute(\"aria-activedescendant\", selectedOption.id);\n    }\n  }\n\n  #setupListeners(signal) {\n    // Toggle on trigger click\n    this.#trigger.addEventListener(\n      \"click\",\n      (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.toggle();\n      },\n      { signal }\n    );\n\n    // Handle option selection\n    this.#options.forEach((opt) => {\n      opt.addEventListener(\n        \"click\",\n        (e) => {\n          // Check if this option has HTMX attributes - if so, let HTMX handle the click\n          const hasHtmx =\n            opt.hasAttribute(\"hx-post\") ||\n            opt.hasAttribute(\"hx-get\") ||\n            opt.hasAttribute(\"hx-put\") ||\n            opt.hasAttribute(\"hx-delete\") ||\n            opt.hasAttribute(\"hx-patch\");\n\n          if (!hasHtmx) {\n            e.preventDefault();\n          }\n\n          this.select(opt, hasHtmx);\n        },\n        { signal }\n      );\n    });\n\n    // Keyboard navigation on container and menu\n    this.addEventListener(\"keydown\", (e) => this.#handleKeydown(e), { signal });\n    this.#menu.addEventListener(\"keydown\", (e) => this.#handleKeydown(e), {\n      signal,\n    });\n\n    // Click outside to close\n    document.addEventListener(\n      \"click\",\n      (e) => {\n        if (\n          this.#isOpen &&\n          !this.contains(e.target) &&\n          !this.#menu.contains(e.target)\n        ) {\n          this.close();\n        }\n      },\n      { signal }\n    );\n  }\n\n  #moveToPortal() {\n    // Skip if any option has HTMX attributes (needs DOM tree for \"closest\" selectors to work)\n    const hasHtmxOptions = this.#options.some(\n      (opt) =>\n        opt.hasAttribute(\"hx-post\") ||\n        opt.hasAttribute(\"hx-get\") ||\n        opt.hasAttribute(\"hx-put\") ||\n        opt.hasAttribute(\"hx-delete\") ||\n        opt.hasAttribute(\"hx-patch\")\n    );\n\n    if (this.#portal && this.#menu && !hasHtmxOptions) {\n      // Store original parent for restoration\n      this.#menuOriginalParent = this.#menu.parentElement;\n      this.#menu.remove();\n      this.#portal.appendChild(this.#menu);\n    }\n  }\n\n  #restoreFromPortal() {\n    // Restore menu to original position before element is removed\n    if (\n      this.#menu &&\n      this.#menu.parentElement === this.#portal &&\n      this.#menuOriginalParent\n    ) {\n      this.#menu.remove();\n      this.#menuOriginalParent.appendChild(this.#menu);\n    }\n  }\n\n  // ============================================\n  // PUBLIC API\n  // ============================================\n\n  toggle() {\n    this.#isOpen ? this.close() : this.open();\n  }\n\n  open() {\n    // Close any other open dropdowns first\n    dropdownRegistry.forEach((dropdown) => {\n      if (dropdown !== this && dropdown.isOpen) {\n        dropdown.close();\n      }\n    });\n\n    this.#isOpen = true;\n    this.#menu.style.display = \"block\";\n    this.#positionMenu();\n    this.#trigger.setAttribute(\"aria-expanded\", \"true\");\n\n    // Close on scroll (except scrolling within the dropdown menu itself)\n    this.#scrollAbortController = new AbortController();\n    window.addEventListener(\n      \"scroll\",\n      (e) => {\n        if (!this.#menu.contains(e.target)) {\n          this.close();\n        }\n      },\n      { capture: true, passive: true, signal: this.#scrollAbortController.signal }\n    );\n  }\n\n  close() {\n    if (!this.#isOpen) return;\n\n    this.#isOpen = false;\n    this.#menu.style.display = \"none\";\n    this.#trigger.setAttribute(\"aria-expanded\", \"false\");\n\n    // Remove scroll listener\n    this.#scrollAbortController?.abort();\n    this.#scrollAbortController = null;\n  }\n\n  /**\n   * Select an option\n   * @param {HTMLElement} opt - Option element to select\n   * @param {boolean} isHtmx - Whether this option has HTMX attributes\n   */\n  select(opt, isHtmx = false) {\n    // For HTMX options, just close - HTMX will handle the rest and replace the element\n    if (isHtmx) {\n      this.close();\n      return;\n    }\n\n    const value = opt.dataset.value;\n    const label = opt.textContent.trim();\n\n    // Update trigger label\n    if (this.#labelEl) {\n      this.#labelEl.textContent = label;\n    }\n\n    // Update hidden input and dispatch change event\n    if (this.#input) {\n      this.#input.value = value;\n      this.#input.dispatchEvent(new Event(\"change\", { bubbles: true }));\n    }\n\n    // Update selected state and ARIA\n    this.#options.forEach((o) => {\n      o.removeAttribute(\"data-selected\");\n      o.setAttribute(\"aria-selected\", \"false\");\n    });\n    opt.setAttribute(\"data-selected\", \"true\");\n    opt.setAttribute(\"aria-selected\", \"true\");\n\n    // Update aria-activedescendant on trigger\n    this.#trigger.setAttribute(\"aria-activedescendant\", opt.id);\n\n    this.close();\n  }\n\n  /**\n   * Reset dropdown to a specific value\n   * @param {string} value - Value to reset to (default: empty string)\n   */\n  reset(value = \"\") {\n    const opt = this.#options.find((o) => o.dataset.value === value);\n    if (opt) {\n      if (this.#labelEl) {\n        this.#labelEl.textContent = opt.textContent.trim();\n      }\n      // Update selected state and ARIA\n      this.#options.forEach((o) => {\n        o.removeAttribute(\"data-selected\");\n        o.setAttribute(\"aria-selected\", \"false\");\n      });\n      opt.setAttribute(\"data-selected\", \"true\");\n      opt.setAttribute(\"aria-selected\", \"true\");\n      this.#trigger.setAttribute(\"aria-activedescendant\", opt.id);\n      if (this.#input) {\n        this.#input.value = value;\n      }\n    }\n  }\n\n  // Getters\n  get isOpen() {\n    return this.#isOpen;\n  }\n\n  get value() {\n    return this.#input?.value ?? \"\";\n  }\n\n  set value(val) {\n    this.reset(val);\n  }\n\n  // ============================================\n  // PRIVATE METHODS\n  // ============================================\n\n  #positionMenu() {\n    const triggerRect = this.#trigger.getBoundingClientRect();\n    const viewportHeight = window.innerHeight;\n    const spaceBelow =\n      viewportHeight - triggerRect.bottom - CONFIG.VIEWPORT_MARGIN;\n    const spaceAbove = triggerRect.top - CONFIG.VIEWPORT_MARGIN;\n\n    // Set width - use minWidth to allow CSS to override, or match trigger if wider\n    const menuMinWidth =\n      parseInt(getComputedStyle(this.#menu).minWidth) || 0;\n    const menuWidth = Math.max(triggerRect.width, menuMinWidth);\n    this.#menu.style.width = `${menuWidth}px`;\n    this.#menu.style.left = `${triggerRect.left}px`;\n\n    // Decide direction: open upward if not enough space below but more space above\n    if (spaceBelow < CONFIG.DEFAULT_MAX_HEIGHT && spaceAbove > spaceBelow) {\n      // Open upward\n      const maxHeight = Math.max(\n        CONFIG.MIN_HEIGHT,\n        Math.min(CONFIG.DEFAULT_MAX_HEIGHT, spaceAbove)\n      );\n      this.#menu.style.maxHeight = `${maxHeight}px`;\n      this.#menu.style.top = `${\n        triggerRect.top -\n        Math.min(this.#menu.scrollHeight, maxHeight) -\n        CONFIG.TRIGGER_GAP\n      }px`;\n    } else {\n      // Open downward (default)\n      const maxHeight = Math.max(\n        CONFIG.MIN_HEIGHT,\n        Math.min(CONFIG.DEFAULT_MAX_HEIGHT, spaceBelow)\n      );\n      this.#menu.style.maxHeight = `${maxHeight}px`;\n      this.#menu.style.top = `${triggerRect.bottom + CONFIG.TRIGGER_GAP}px`;\n    }\n  }\n\n  #handleKeydown(e) {\n    switch (e.key) {\n      case \"Escape\":\n        this.close();\n        this.#trigger.focus();\n        break;\n\n      case \"Enter\":\n        if (!this.#isOpen) {\n          e.preventDefault();\n          this.open();\n        } else {\n          // Select focused option\n          const focused = this.#menu.querySelector(\"[data-option]:focus\");\n          if (focused) {\n            e.preventDefault();\n            this.select(focused);\n          }\n        }\n        break;\n\n      case \"ArrowDown\":\n      case \"ArrowUp\":\n        if (this.#isOpen) {\n          e.preventDefault();\n          this.#navigateOptions(e.key === \"ArrowDown\" ? 1 : -1);\n        }\n        break;\n    }\n  }\n\n  #navigateOptions(direction) {\n    const items = this.#options;\n    const currentIndex = items.findIndex(\n      (o) =>\n        o === document.activeElement ||\n        o.getAttribute(\"data-selected\") === \"true\"\n    );\n    let nextIndex;\n\n    if (direction === 1) {\n      nextIndex = currentIndex < items.length - 1 ? currentIndex + 1 : 0;\n    } else {\n      nextIndex = currentIndex > 0 ? currentIndex - 1 : items.length - 1;\n    }\n\n    const nextItem = items[nextIndex];\n    if (nextItem) {\n      nextItem.focus();\n      // Update aria-activedescendant on trigger for screen readers\n      this.#trigger.setAttribute(\"aria-activedescendant\", nextItem.id);\n    }\n  }\n}\n\n// ============================================\n// REGISTER CUSTOM ELEMENT\n// ============================================\n\ncustomElements.define(\"ec-dropdown\", EcDropdown);\n\n// ============================================\n// BACKWARD COMPATIBILITY\n// ============================================\n\n// Expose for external access\nwindow.EcDropdown = EcDropdown;\nwindow.dropdowns = dropdownRegistry;\n\n// Legacy API (for gradual migration)\nwindow.Dropdown = EcDropdown;\nwindow.initDropdown = (el) => {\n  // Web Components auto-initialize, this is a no-op\n  if (el.tagName === \"EC-DROPDOWN\") return el;\n  console.warn(\n    \"initDropdown() called on non-ec-dropdown element. Migrate to <ec-dropdown>.\"\n  );\n  return null;\n};\n", "/**\n * ec-drawer - Slide-out drawer Web Component\n *\n * Features:\n * - Slide-out panel with backdrop\n * - HTMX content loading\n * - Dirty form tracking (warns on close if unsaved changes)\n * - Focus trap for accessibility\n * - Focus restoration on close\n * - Escape key / backdrop click to close\n * - Server-triggered close via custom event\n *\n * Usage:\n * <ec-drawer>\n *   <div data-backdrop></div>\n *   <aside data-panel role=\"dialog\" aria-modal=\"true\">\n *     <header data-header>\n *       <h2 data-title></h2>\n *       <button data-close>X</button>\n *     </header>\n *     <div data-content></div>\n *   </aside>\n * </ec-drawer>\n *\n * API:\n * window.drawerOpen('Title', '/url');  // Open with title and optional URL\n * window.drawerClose();                // Close with dirty check\n * window.drawerClose(true);            // Force close\n * window.drawerIsDirty();              // Check for unsaved changes\n * window.drawerIsOpen();               // Check if open\n */\n\nclass EcDrawer extends HTMLElement {\n  // ============================================\n  // CONFIGURATION\n  // ============================================\n\n  static FOCUSABLE_SELECTOR =\n    'button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), ' +\n    'textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"]):not([disabled])';\n\n  static ANIMATION_DURATION = 200;\n\n  // ============================================\n  // PRIVATE STATE\n  // ============================================\n\n  #isOpen = false;\n  #initialFormData = null;\n  #previouslyFocusedElement = null;\n  #abortController = null;\n  #focusTrapController = null;\n\n  // Element references\n  #backdrop = null;\n  #panel = null;\n  #title = null;\n  #content = null;\n  #closeBtn = null;\n\n  // ============================================\n  // LIFECYCLE\n  // ============================================\n\n  connectedCallback() {\n    // Find server-rendered elements\n    this.#backdrop = this.querySelector(\"[data-backdrop]\");\n    this.#panel = this.querySelector(\"[data-panel]\");\n    this.#title = this.querySelector(\"[data-title]\");\n    this.#content = this.querySelector(\"[data-content]\");\n    this.#closeBtn = this.querySelector(\"[data-close]\");\n\n    if (!this.#backdrop || !this.#panel) {\n      console.warn(\"ec-drawer: Missing [data-backdrop] or [data-panel]\", this);\n      return;\n    }\n\n    // Setup event listeners\n    this.#abortController = new AbortController();\n    this.#setupListeners(this.#abortController.signal);\n\n    // Register global API\n    window.drawerOpen = this.open.bind(this);\n    window.drawerClose = this.close.bind(this);\n    window.drawerIsDirty = this.isDirty.bind(this);\n    window.drawerIsOpen = () => this.#isOpen;\n  }\n\n  disconnectedCallback() {\n    this.#abortController?.abort();\n    this.#focusTrapController?.abort();\n\n    // Clear global references\n    if (window.drawerOpen === this.open.bind(this)) {\n      window.drawerOpen = null;\n      window.drawerClose = null;\n      window.drawerIsDirty = null;\n      window.drawerIsOpen = null;\n    }\n  }\n\n  // ============================================\n  // PUBLIC API\n  // ============================================\n\n  /**\n   * Open the drawer and optionally load content via HTMX\n   * @param {string} drawerTitle - Title to display in the drawer header\n   * @param {string} [url] - Optional URL to fetch content from\n   */\n  open(drawerTitle, url) {\n    if (!document.body) return;\n    if (!this.#backdrop || !this.#panel) return;\n\n    // Set title\n    if (this.#title && drawerTitle) {\n      this.#title.textContent = drawerTitle;\n    }\n\n    // Show loading state and fetch content if URL provided\n    if (url && this.#content) {\n      this.#content.innerHTML =\n        '<div class=\"p-6 flex items-center justify-center\"><span class=\"animate-spin\">&#8635;</span></div>';\n      htmx.ajax(\"GET\", url, {\n        target: this.#content,\n        swap: \"innerHTML\",\n      });\n    }\n\n    // Open drawer\n    this.#backdrop.classList.add(\"open\");\n    this.#panel.classList.add(\"open\");\n    this.#isOpen = true;\n\n    // Prevent body scroll\n    document.body.style.overflow = \"hidden\";\n\n    // Store the element that triggered the drawer for focus restoration\n    this.#previouslyFocusedElement = document.activeElement;\n\n    // Set up focus trap\n    this.#setupFocusTrap();\n\n    // Focus the panel for accessibility\n    this.#panel.focus();\n  }\n\n  /**\n   * Close the drawer, with optional dirty form check\n   * @param {boolean} [force=false] - Skip dirty check if true\n   * @returns {boolean} - Whether the drawer was closed\n   */\n  close(force = false) {\n    if (!this.#isOpen) return true;\n\n    // Check for unsaved changes\n    if (!force && this.isDirty()) {\n      const confirmed = confirm(\n        \"You have unsaved changes. Are you sure you want to close?\"\n      );\n      if (!confirmed) return false;\n    }\n\n    if (!this.#backdrop || !this.#panel) return true;\n\n    // Close drawer\n    this.#backdrop.classList.remove(\"open\");\n    this.#panel.classList.remove(\"open\");\n    this.#isOpen = false;\n\n    // Re-enable body scroll\n    document.body.style.overflow = \"\";\n\n    // Remove focus trap\n    this.#removeFocusTrap();\n\n    // Restore focus to the element that opened the drawer\n    if (\n      this.#previouslyFocusedElement &&\n      typeof this.#previouslyFocusedElement.focus === \"function\"\n    ) {\n      this.#previouslyFocusedElement.focus();\n    }\n    this.#previouslyFocusedElement = null;\n\n    // Clear content after animation\n    setTimeout(() => {\n      if (this.#content) this.#content.innerHTML = \"\";\n      this.#initialFormData = null;\n    }, EcDrawer.ANIMATION_DURATION);\n\n    return true;\n  }\n\n  /**\n   * Check if the form has unsaved changes\n   * @returns {boolean}\n   */\n  isDirty() {\n    if (!this.#content || !this.#initialFormData) return false;\n\n    const form = this.#content.querySelector(\"form\");\n    if (!form) return false;\n\n    const currentData = this.#serializeForm(form);\n    return this.#initialFormData !== currentData;\n  }\n\n  /**\n   * Check if drawer is currently open\n   * @returns {boolean}\n   */\n  get isOpen() {\n    return this.#isOpen;\n  }\n\n  // ============================================\n  // PRIVATE METHODS\n  // ============================================\n\n  /**\n   * Setup event listeners\n   * @param {AbortSignal} signal\n   */\n  #setupListeners(signal) {\n    // Backdrop click to close\n    this.#backdrop?.addEventListener(\n      \"click\",\n      () => this.close(),\n      { signal }\n    );\n\n    // Close button click\n    this.#closeBtn?.addEventListener(\n      \"click\",\n      () => this.close(),\n      { signal }\n    );\n\n    // Escape key to close\n    document.addEventListener(\n      \"keydown\",\n      (e) => {\n        if (e.key === \"Escape\" && this.#isOpen) {\n          this.close();\n        }\n      },\n      { signal }\n    );\n\n    // Listen for HTMX content swap to capture initial form state\n    document.addEventListener(\n      \"htmx:afterSwap\",\n      (e) => {\n        if (e.detail.target === this.#content) {\n          // Small delay to ensure form is fully rendered\n          setTimeout(() => {\n            this.#captureFormState();\n\n            // Focus the first focusable element in the new content\n            if (this.#isOpen && this.#panel) {\n              const firstFocusable = this.#panel.querySelector(\n                EcDrawer.FOCUSABLE_SELECTOR\n              );\n              if (firstFocusable) {\n                firstFocusable.focus();\n              }\n            }\n          }, 50);\n        }\n      },\n      { signal }\n    );\n\n    // Listen for custom closeDrawer event from server (HX-Trigger header)\n    document.addEventListener(\n      \"closeDrawer\",\n      () => this.close(true),\n      { signal }\n    );\n  }\n\n  /**\n   * Set up focus trap within the drawer panel\n   */\n  #setupFocusTrap() {\n    this.#focusTrapController = new AbortController();\n    const { signal } = this.#focusTrapController;\n\n    document.addEventListener(\n      \"keydown\",\n      (e) => {\n        if (e.key !== \"Tab\" || !this.#isOpen) return;\n\n        const focusableElements = this.#panel.querySelectorAll(\n          EcDrawer.FOCUSABLE_SELECTOR\n        );\n        if (focusableElements.length === 0) return;\n\n        const firstFocusable = focusableElements[0];\n        const lastFocusable = focusableElements[focusableElements.length - 1];\n\n        if (e.shiftKey) {\n          // Shift+Tab: If on first element, wrap to last\n          if (\n            document.activeElement === firstFocusable ||\n            document.activeElement === this.#panel\n          ) {\n            e.preventDefault();\n            lastFocusable.focus();\n          }\n        } else {\n          // Tab: If on last element, wrap to first\n          if (document.activeElement === lastFocusable) {\n            e.preventDefault();\n            firstFocusable.focus();\n          }\n        }\n      },\n      { signal }\n    );\n  }\n\n  /**\n   * Remove focus trap handler\n   */\n  #removeFocusTrap() {\n    this.#focusTrapController?.abort();\n    this.#focusTrapController = null;\n  }\n\n  /**\n   * Capture initial form state for dirty tracking\n   */\n  #captureFormState() {\n    if (!this.#content) return;\n\n    const form = this.#content.querySelector(\"form\");\n    if (!form) return;\n\n    this.#initialFormData = this.#serializeForm(form);\n  }\n\n  /**\n   * Serialize form data to a string for comparison\n   * @param {HTMLFormElement} form\n   * @returns {string}\n   */\n  #serializeForm(form) {\n    const formData = new FormData(form);\n    const entries = [];\n\n    for (const [key, value] of formData.entries()) {\n      // Skip CSRF token as it doesn't represent user changes\n      if (key === \"csrf_token\") continue;\n      entries.push(`${key}=${value}`);\n    }\n\n    return entries.sort().join(\"&\");\n  }\n}\n\n// ============================================\n// REGISTER CUSTOM ELEMENT\n// ============================================\n\ncustomElements.define(\"ec-drawer\", EcDrawer);\n\n// ============================================\n// BACKWARD COMPATIBILITY\n// ============================================\n\n// Expose class for external use\nwindow.EcDrawer = EcDrawer;\n", "/**\n * ec-tag-select - Multi-select tag dropdown Web Component\n *\n * Features:\n * - Multi-select with checkboxes\n * - Live filtering as user types\n * - Inline tag creation via API\n * - Chip display of selected tags\n * - Keyboard navigation (Escape to close, Enter to create)\n * - Click outside to close\n * - HTMX integration\n *\n * Usage:\n * <ec-tag-select field-name=\"tag_ids\">\n *   <div data-trigger>\n *     <div data-chips>...</div>\n *     <span data-placeholder>Select tags...</span>\n *   </div>\n *   <div data-dropdown class=\"hidden\">\n *     <input data-filter placeholder=\"Filter...\">\n *     <div data-options>\n *       <label data-option data-name=\"Tag Name\">\n *         <input type=\"checkbox\" data-id=\"1\" value=\"1\">\n *         <span>Tag Name</span>\n *       </label>\n *     </div>\n *     <div data-create class=\"hidden\">\n *       <button data-create-btn>Create \"<span data-create-name></span>\"</button>\n *     </div>\n *   </div>\n * </ec-tag-select>\n */\n\nclass EcTagSelect extends HTMLElement {\n  // ============================================\n  // CONFIGURATION\n  // ============================================\n\n  static CREATE_TAG_ENDPOINT = \"/admin/tags/create-inline\";\n  static DEFAULT_PLACEHOLDER = \"Select tags...\";\n\n  // ============================================\n  // PRIVATE STATE\n  // ============================================\n\n  #isOpen = false;\n  #abortController = null;\n\n  // Element references\n  #trigger = null;\n  #dropdown = null;\n  #filterInput = null;\n  #optionsContainer = null;\n  #chipsContainer = null;\n  #placeholder = null;\n  #createSection = null;\n  #createBtn = null;\n  #createNameSpan = null;\n\n  // ============================================\n  // LIFECYCLE\n  // ============================================\n\n  connectedCallback() {\n    // Find server-rendered elements\n    this.#trigger = this.querySelector(\"[data-trigger]\");\n    this.#dropdown = this.querySelector(\"[data-dropdown]\");\n    this.#filterInput = this.querySelector(\"[data-filter]\");\n    this.#optionsContainer = this.querySelector(\"[data-options]\");\n    this.#chipsContainer = this.querySelector(\"[data-chips]\");\n    this.#placeholder = this.querySelector(\"[data-placeholder]\");\n    this.#createSection = this.querySelector(\"[data-create]\");\n    this.#createBtn = this.querySelector(\"[data-create-btn]\");\n    this.#createNameSpan = this.querySelector(\"[data-create-name]\");\n\n    if (!this.#trigger || !this.#dropdown) {\n      console.warn(\"ec-tag-select: Missing [data-trigger] or [data-dropdown]\", this);\n      return;\n    }\n\n    // Setup event listeners\n    this.#abortController = new AbortController();\n    this.#setupListeners(this.#abortController.signal);\n  }\n\n  disconnectedCallback() {\n    this.#abortController?.abort();\n  }\n\n  // ============================================\n  // GETTERS\n  // ============================================\n\n  get fieldName() {\n    return this.getAttribute(\"field-name\") || \"tag_ids\";\n  }\n\n  // ============================================\n  // PRIVATE METHODS\n  // ============================================\n\n  #setupListeners(signal) {\n    // Trigger click - open/close dropdown\n    this.#trigger.addEventListener(\n      \"click\",\n      (e) => {\n        // Don't toggle if clicking remove button\n        if (e.target.closest(\"[data-remove]\")) return;\n        this.#toggleDropdown();\n      },\n      { signal }\n    );\n\n    // Chips container click - handle remove buttons\n    if (this.#chipsContainer) {\n      this.#chipsContainer.addEventListener(\n        \"click\",\n        (e) => {\n          const removeBtn = e.target.closest(\"[data-remove]\");\n          if (removeBtn) {\n            e.stopPropagation();\n            this.#removeTag(removeBtn.dataset.remove);\n          }\n        },\n        { signal }\n      );\n    }\n\n    // Filter input\n    if (this.#filterInput) {\n      this.#filterInput.addEventListener(\n        \"input\",\n        (e) => this.#filterOptions(e.target.value),\n        { signal }\n      );\n\n      // Prevent click from closing dropdown\n      this.#filterInput.addEventListener(\n        \"click\",\n        (e) => e.stopPropagation(),\n        { signal }\n      );\n    }\n\n    // Options change - update chips when checkbox changes\n    if (this.#optionsContainer) {\n      this.#optionsContainer.addEventListener(\n        \"change\",\n        (e) => {\n          if (e.target.matches('input[type=\"checkbox\"]')) {\n            this.#updateChips();\n          }\n        },\n        { signal }\n      );\n    }\n\n    // Create button\n    if (this.#createBtn) {\n      this.#createBtn.addEventListener(\n        \"click\",\n        (e) => {\n          e.stopPropagation();\n          const name = this.#createNameSpan?.textContent?.trim();\n          if (name) {\n            this.#createTag(name);\n          }\n        },\n        { signal }\n      );\n    }\n\n    // Click outside to close\n    document.addEventListener(\n      \"click\",\n      (e) => {\n        if (this.#isOpen && !this.contains(e.target)) {\n          this.#toggleDropdown(false);\n        }\n      },\n      { signal }\n    );\n\n    // Keyboard navigation\n    this.addEventListener(\n      \"keydown\",\n      (e) => {\n        if (e.key === \"Escape\" && this.#isOpen) {\n          this.#toggleDropdown(false);\n          this.#trigger.focus();\n        }\n        if (e.key === \"Enter\" && this.#filterInput === document.activeElement) {\n          e.preventDefault();\n          if (this.#createSection && !this.#createSection.classList.contains(\"hidden\")) {\n            const name = this.#createNameSpan?.textContent?.trim();\n            if (name) this.#createTag(name);\n          }\n        }\n      },\n      { signal }\n    );\n  }\n\n  #toggleDropdown(open) {\n    this.#isOpen = open !== undefined ? open : !this.#isOpen;\n    this.#dropdown.classList.toggle(\"hidden\", !this.#isOpen);\n\n    if (this.#isOpen && this.#filterInput) {\n      this.#filterInput.focus();\n      this.#filterInput.value = \"\";\n      this.#filterOptions(\"\");\n    }\n  }\n\n  #filterOptions(query) {\n    if (!this.#optionsContainer) return;\n\n    const normalizedQuery = query.toLowerCase().trim();\n    const options = this.#optionsContainer.querySelectorAll(\"[data-option]\");\n    let hasExactMatch = false;\n\n    options.forEach((option) => {\n      const name = option.dataset.name?.toLowerCase() || \"\";\n      const matches = normalizedQuery === \"\" || name.includes(normalizedQuery);\n      option.hidden = !matches;\n      if (name === normalizedQuery) hasExactMatch = true;\n    });\n\n    // Show/hide create option\n    if (this.#createSection && this.#createNameSpan) {\n      if (normalizedQuery && !hasExactMatch) {\n        this.#createSection.classList.remove(\"hidden\");\n        this.#createNameSpan.textContent = query.trim();\n      } else {\n        this.#createSection.classList.add(\"hidden\");\n      }\n    }\n  }\n\n  #updateChips() {\n    if (!this.#chipsContainer || !this.#optionsContainer) return;\n\n    const checkboxes = this.#optionsContainer.querySelectorAll(\n      'input[type=\"checkbox\"]:checked'\n    );\n    this.#chipsContainer.innerHTML = \"\";\n\n    checkboxes.forEach((cb) => {\n      const option = cb.closest(\"[data-option]\");\n      const name = option?.dataset.name || \"\";\n      const id = cb.dataset.id;\n\n      const chip = document.createElement(\"span\");\n      chip.className = \"tag-chip\";\n      chip.dataset.tagId = id;\n      chip.innerHTML = `\n        ${this.#escapeHtml(name)}\n        <button type=\"button\" class=\"tag-chip-remove\" data-remove=\"${id}\" aria-label=\"Remove ${this.#escapeHtml(name)}\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n            <path d=\"M18 6 6 18\"></path>\n            <path d=\"m6 6 12 12\"></path>\n          </svg>\n        </button>\n      `;\n      this.#chipsContainer.appendChild(chip);\n    });\n\n    // Update placeholder visibility\n    if (this.#placeholder) {\n      this.#placeholder.textContent =\n        checkboxes.length === 0 ? EcTagSelect.DEFAULT_PLACEHOLDER : \"\";\n    }\n  }\n\n  #removeTag(tagId) {\n    if (!this.#optionsContainer) return;\n\n    const checkbox = this.#optionsContainer.querySelector(\n      `input[data-id=\"${tagId}\"]`\n    );\n    if (checkbox) {\n      checkbox.checked = false;\n      this.#updateChips();\n    }\n  }\n\n  async #createTag(name) {\n    const slug = this.#slugify(name);\n\n    try {\n      const response = await fetch(EcTagSelect.CREATE_TAG_ENDPOINT, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\",\n          \"X-CSRF-Token\": this.#getCSRFToken(),\n        },\n        body: `name=${encodeURIComponent(name)}&slug=${encodeURIComponent(slug)}`,\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const tag = await response.json();\n\n      // Add new option to the list\n      if (this.#optionsContainer) {\n        const newOption = document.createElement(\"label\");\n        newOption.className = \"tag-select-option\";\n        newOption.dataset.option = \"\";\n        newOption.dataset.name = tag.name;\n        newOption.innerHTML = `\n          <input type=\"checkbox\" name=\"${this.fieldName}\" value=\"${tag.id}\" \n                 data-id=\"${tag.id}\" checked />\n          <span>${this.#escapeHtml(tag.name)}</span>\n        `;\n        this.#optionsContainer.appendChild(newOption);\n      }\n\n      // Update UI\n      this.#updateChips();\n      if (this.#filterInput) this.#filterInput.value = \"\";\n      if (this.#createSection) this.#createSection.classList.add(\"hidden\");\n      this.#filterOptions(\"\");\n    } catch (error) {\n      console.error(\"Failed to create tag:\", error);\n      // Use toast if available\n      if (typeof window.showToast === \"function\") {\n        window.showToast(\"Failed to create tag. Please try again.\", \"error\");\n      }\n    }\n  }\n\n  // ============================================\n  // UTILITY METHODS\n  // ============================================\n\n  #slugify(str) {\n    return str\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, \"\")\n      .replace(/[\\s_-]+/g, \"-\")\n      .replace(/^-+|-+$/g, \"\");\n  }\n\n  #escapeHtml(text) {\n    const div = document.createElement(\"div\");\n    div.textContent = text;\n    return div.innerHTML;\n  }\n\n  #getCSRFToken() {\n    // Try body hx-headers first\n    const hxHeaders = document.body?.getAttribute(\"hx-headers\");\n    if (hxHeaders) {\n      try {\n        const headers = JSON.parse(hxHeaders);\n        if (headers[\"X-CSRF-Token\"]) {\n          return headers[\"X-CSRF-Token\"];\n        }\n      } catch (e) {\n        // Ignore JSON parse errors\n      }\n    }\n    // Fallback to form hidden input\n    const input = document.querySelector('input[name=\"csrf_token\"]');\n    return input?.value || \"\";\n  }\n}\n\n// Register custom element\ncustomElements.define(\"ec-tag-select\", EcTagSelect);\n", "/**\n * ec-mobile-nav - Mobile navigation Web Component\n *\n * Features:\n * - Bottom sheet drawer with scale effect on content\n * - Auto-hide bottom bar on scroll down\n * - Close on backdrop click, Escape key, scroll attempt\n * - Loading indicator during page transitions\n * - HTMX integration\n *\n * Usage:\n * <ec-mobile-nav>\n *   <div class=\"nav-drawer-backdrop\"></div>\n *   <nav class=\"nav-drawer\">...</nav>\n *   <div class=\"mobile-bottom-bar\">\n *     <button data-toggle>...</button>\n *   </div>\n *   <div class=\"nav-loading-indicator\">...</div>\n * </ec-mobile-nav>\n *\n * API:\n * window.navDrawer.open()\n * window.navDrawer.close()\n * window.navDrawer.toggle()\n * window.navDrawer.isOpen()\n */\n\nclass EcMobileNav extends HTMLElement {\n  // ============================================\n  // CONFIGURATION\n  // ============================================\n\n  static SCROLL_THRESHOLD = 10;\n  static SCROLL_TOP_ZONE = 50;\n\n  // ============================================\n  // PRIVATE STATE\n  // ============================================\n\n  #isOpen = false;\n  #isBarHidden = false;\n  #lastScrollY = 0;\n  #ticking = false;\n  #abortController = null;\n\n  // Element references\n  #drawer = null;\n  #backdrop = null;\n  #bar = null;\n  #loadingIndicator = null;\n  #scrollContainer = null;\n\n  // ============================================\n  // LIFECYCLE\n  // ============================================\n\n  connectedCallback() {\n    // Find server-rendered elements\n    this.#drawer = this.querySelector(\".nav-drawer\");\n    this.#backdrop = this.querySelector(\".nav-drawer-backdrop\");\n    this.#bar = this.querySelector(\".mobile-bottom-bar\");\n    this.#loadingIndicator = this.querySelector(\".nav-loading-indicator\");\n\n    if (!this.#drawer) {\n      console.warn(\"ec-mobile-nav: Missing .nav-drawer\", this);\n      return;\n    }\n\n    // Find scroll container\n    this.#scrollContainer = this.#findScrollContainer();\n\n    // Setup event listeners\n    this.#abortController = new AbortController();\n    this.#setupListeners(this.#abortController.signal);\n\n    // Register global API\n    window.navDrawer = {\n      open: this.open.bind(this),\n      close: this.close.bind(this),\n      toggle: this.toggle.bind(this),\n      isOpen: () => this.#isOpen,\n    };\n  }\n\n  disconnectedCallback() {\n    this.#abortController?.abort();\n\n    // Clean up body state if open\n    if (this.#isOpen) {\n      document.body.classList.remove(\"nav-drawer-open\");\n      document.body.style.overflow = \"\";\n    }\n\n    // Clear global reference\n    if (window.navDrawer?.open === this.open.bind(this)) {\n      window.navDrawer = null;\n    }\n  }\n\n  // ============================================\n  // PRIVATE METHODS\n  // ============================================\n\n  #findScrollContainer() {\n    const mainScroll = document.querySelector(\".main-content-scroll\");\n    if (mainScroll && mainScroll.scrollHeight > mainScroll.clientHeight) {\n      return mainScroll;\n    }\n    return window;\n  }\n\n  #setupListeners(signal) {\n    // Toggle button in bottom bar\n    const toggleBtn = this.#bar?.querySelector(\"[data-toggle]\");\n    if (toggleBtn) {\n      toggleBtn.addEventListener(\"click\", () => this.toggle(), { signal });\n    }\n\n    // Close on backdrop click\n    if (this.#backdrop) {\n      this.#backdrop.addEventListener(\"click\", () => this.close(), { signal });\n    }\n\n    // Close on escape key\n    document.addEventListener(\"keydown\", (e) => this.#handleEscape(e), {\n      signal,\n    });\n\n    // Handle nav link clicks (internal links only)\n    const navLinks = this.#drawer.querySelectorAll('a[href^=\"/\"]');\n    navLinks.forEach((link) => {\n      link.addEventListener(\"click\", (e) => this.#handleNavClick(e), {\n        signal,\n      });\n    });\n\n    // Scroll hide for bottom bar\n    if (this.#scrollContainer === window) {\n      window.addEventListener(\"scroll\", (e) => this.#onScroll(e), {\n        passive: true,\n        signal,\n      });\n    } else if (this.#scrollContainer) {\n      this.#scrollContainer.addEventListener(\n        \"scroll\",\n        (e) => this.#onScroll(e),\n        { passive: true, signal }\n      );\n    }\n\n    // HTMX integration - hide loading and reset after page swap\n    document.addEventListener(\n      \"htmx:afterSettle\",\n      () => {\n        this.#hideLoading();\n\n        if (this.#isOpen) {\n          this.close();\n        }\n\n        // Reset scroll tracking\n        this.#lastScrollY = 0;\n        this.#showBar();\n\n        // Re-find scroll container (DOM may have changed)\n        this.#scrollContainer = this.#findScrollContainer();\n      },\n      { signal }\n    );\n  }\n\n  #handleEscape(e) {\n    if (e.key === \"Escape\" && this.#isOpen) {\n      this.close();\n    }\n  }\n\n  #handleNavClick(e) {\n    // Show loading indicator\n    this.#showLoading();\n\n    // Close drawer immediately\n    this.close();\n\n    // Navigation happens via htmx-boost, view transition handles the animation\n  }\n\n  #closeOnScroll = () => {\n    if (this.#isOpen) {\n      this.close();\n    }\n  };\n\n  #onScroll(e) {\n    // Don't process scroll if drawer is open\n    if (this.#isOpen) return;\n\n    if (!this.#ticking) {\n      requestAnimationFrame(() => {\n        this.#updateBarVisibility(e);\n        this.#ticking = false;\n      });\n      this.#ticking = true;\n    }\n  }\n\n  #updateBarVisibility(e) {\n    let currentScrollY;\n\n    if (e.target === document || e.target === window || !e.target.scrollTop) {\n      currentScrollY = window.scrollY || window.pageYOffset;\n    } else {\n      currentScrollY = e.target.scrollTop;\n    }\n\n    const scrollDelta = currentScrollY - this.#lastScrollY;\n\n    // Only act if scroll exceeds threshold\n    if (Math.abs(scrollDelta) < EcMobileNav.SCROLL_THRESHOLD) {\n      return;\n    }\n\n    // At top of page - always show\n    if (currentScrollY < EcMobileNav.SCROLL_TOP_ZONE) {\n      this.#showBar();\n    }\n    // Scrolling down - hide\n    else if (scrollDelta > 0) {\n      this.#hideBar();\n    }\n    // Scrolling up - show\n    else {\n      this.#showBar();\n    }\n\n    this.#lastScrollY = currentScrollY;\n  }\n\n  #showBar() {\n    if (this.#isBarHidden && this.#bar) {\n      this.#bar.classList.remove(\"scroll-hidden\");\n      this.#isBarHidden = false;\n    }\n  }\n\n  #hideBar() {\n    if (!this.#isBarHidden && this.#bar) {\n      this.#bar.classList.add(\"scroll-hidden\");\n      this.#isBarHidden = true;\n    }\n  }\n\n  #showLoading() {\n    if (this.#loadingIndicator) {\n      this.#loadingIndicator.classList.add(\"active\");\n    }\n  }\n\n  #hideLoading() {\n    if (this.#loadingIndicator) {\n      this.#loadingIndicator.classList.remove(\"active\");\n    }\n  }\n\n  // ============================================\n  // PUBLIC API\n  // ============================================\n\n  open() {\n    if (this.#isOpen || !this.#drawer) return;\n\n    this.#isOpen = true;\n    document.body.classList.add(\"nav-drawer-open\");\n    this.#drawer.classList.add(\"open\");\n    document.body.style.overflow = \"hidden\";\n\n    // Show bottom bar when drawer opens (if it was hidden)\n    this.#showBar();\n\n    // Add scroll listeners to close drawer on scroll attempt\n    document.addEventListener(\"wheel\", this.#closeOnScroll, { passive: true });\n    document.addEventListener(\"touchmove\", this.#closeOnScroll, {\n      passive: true,\n    });\n\n    // Focus first nav item for accessibility\n    setTimeout(() => {\n      const firstLink = this.#drawer.querySelector(\"a[href]\");\n      if (firstLink) firstLink.focus();\n    }, 200);\n  }\n\n  close() {\n    if (!this.#isOpen || !this.#drawer) return;\n\n    this.#isOpen = false;\n    document.body.classList.remove(\"nav-drawer-open\");\n    this.#drawer.classList.remove(\"open\");\n    document.body.style.overflow = \"\";\n\n    // Remove scroll listeners\n    document.removeEventListener(\"wheel\", this.#closeOnScroll);\n    document.removeEventListener(\"touchmove\", this.#closeOnScroll);\n  }\n\n  toggle() {\n    if (this.#isOpen) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n}\n\n// Register custom element\ncustomElements.define(\"ec-mobile-nav\", EcMobileNav);\n", "/**\n * ec-markdown-toolbar - Floating markdown formatting toolbar Web Component\n *\n * Features:\n * - Shows on text selection in target textarea\n * - Positions above selection\n * - Inserts markdown syntax around selected text\n * - Keyboard shortcuts (Ctrl/Cmd + B, I, K, `)\n *\n * Usage:\n * <ec-markdown-toolbar target=\"content\">\n *   <button type=\"button\" data-action=\"bold\" title=\"Bold (Ctrl+B)\">B</button>\n *   <button type=\"button\" data-action=\"italic\" title=\"Italic (Ctrl+I)\">I</button>\n *   <button type=\"button\" data-action=\"code\" title=\"Code (Ctrl+`)\"><code>&lt;/&gt;</code></button>\n *   <button type=\"button\" data-action=\"link\" title=\"Link (Ctrl+K)\">Link</button>\n *   <button type=\"button\" data-action=\"heading\" title=\"Heading\">H</button>\n *   <button type=\"button\" data-action=\"quote\" title=\"Quote\">\"</button>\n * </ec-markdown-toolbar>\n *\n * Attributes:\n * - target: ID of the textarea to attach to\n */\n\nclass EcMarkdownToolbar extends HTMLElement {\n  // ============================================\n  // CONFIGURATION\n  // ============================================\n\n  static MARKDOWN_ACTIONS = {\n    bold: { prefix: \"**\", suffix: \"**\", placeholder: \"bold text\" },\n    italic: { prefix: \"_\", suffix: \"_\", placeholder: \"italic text\" },\n    code: { prefix: \"`\", suffix: \"`\", placeholder: \"code\" },\n    link: { prefix: \"[\", suffix: \"](url)\", placeholder: \"link text\" },\n    heading: { prefix: \"## \", suffix: \"\", placeholder: \"Heading\", lineStart: true },\n    quote: { prefix: \"> \", suffix: \"\", placeholder: \"quote\", lineStart: true },\n  };\n\n  static KEYBOARD_SHORTCUTS = {\n    \"b\": \"bold\",\n    \"i\": \"italic\",\n    \"k\": \"link\",\n    \"`\": \"code\",\n  };\n\n  // ============================================\n  // PRIVATE STATE\n  // ============================================\n\n  #targetTextarea = null;\n  #abortController = null;\n  #isVisible = false;\n  #hideTimeout = null;\n\n  // ============================================\n  // LIFECYCLE\n  // ============================================\n\n  connectedCallback() {\n    const targetId = this.getAttribute(\"target\");\n    if (!targetId) {\n      console.warn(\"ec-markdown-toolbar: Missing 'target' attribute\");\n      return;\n    }\n\n    // Wait for DOM to be ready\n    requestAnimationFrame(() => {\n      this.#targetTextarea = document.getElementById(targetId);\n      if (!this.#targetTextarea) {\n        console.warn(`ec-markdown-toolbar: Target #${targetId} not found`);\n        return;\n      }\n\n      this.#abortController = new AbortController();\n      this.#setupListeners(this.#abortController.signal);\n    });\n  }\n\n  disconnectedCallback() {\n    this.#abortController?.abort();\n    this.#clearHideTimeout();\n  }\n\n  // ============================================\n  // EVENT LISTENERS\n  // ============================================\n\n  #setupListeners(signal) {\n    // Listen for selection changes on the textarea\n    this.#targetTextarea.addEventListener(\n      \"select\",\n      () => this.#handleSelection(),\n      { signal }\n    );\n\n    // Also listen for mouseup to catch selection via mouse\n    this.#targetTextarea.addEventListener(\n      \"mouseup\",\n      () => setTimeout(() => this.#handleSelection(), 10),\n      { signal }\n    );\n\n    // Hide on blur (with delay to allow button clicks)\n    this.#targetTextarea.addEventListener(\n      \"blur\",\n      () => this.#scheduleHide(),\n      { signal }\n    );\n\n    // Cancel hide if focusing on toolbar\n    this.addEventListener(\n      \"mousedown\",\n      (e) => {\n        e.preventDefault(); // Prevent textarea blur\n        this.#clearHideTimeout();\n      },\n      { signal }\n    );\n\n    // Handle toolbar button clicks\n    this.addEventListener(\n      \"click\",\n      (e) => {\n        const button = e.target.closest(\"[data-action]\");\n        if (button) {\n          const action = button.dataset.action;\n          this.#applyAction(action);\n        }\n      },\n      { signal }\n    );\n\n    // Keyboard shortcuts\n    this.#targetTextarea.addEventListener(\n      \"keydown\",\n      (e) => this.#handleKeydown(e),\n      { signal }\n    );\n\n    // Hide on scroll\n    this.#targetTextarea.addEventListener(\n      \"scroll\",\n      () => this.#hide(),\n      { signal }\n    );\n\n    // Re-position on window resize\n    window.addEventListener(\n      \"resize\",\n      () => {\n        if (this.#isVisible) this.#updatePosition();\n      },\n      { signal }\n    );\n  }\n\n  // ============================================\n  // SELECTION HANDLING\n  // ============================================\n\n  #handleSelection() {\n    const { selectionStart, selectionEnd } = this.#targetTextarea;\n    const hasSelection = selectionStart !== selectionEnd;\n\n    if (hasSelection) {\n      this.#show();\n      this.#updatePosition();\n    } else {\n      this.#hide();\n    }\n  }\n\n  #updatePosition() {\n    if (!this.#targetTextarea) return;\n\n    const textarea = this.#targetTextarea;\n    const { selectionStart, selectionEnd } = textarea;\n\n    // Get textarea position\n    const textareaRect = textarea.getBoundingClientRect();\n\n    // Create a temporary span to measure cursor position\n    // This is a common technique to position elements relative to cursor in textarea\n    const textBeforeCursor = textarea.value.substring(0, selectionStart);\n    const lines = textBeforeCursor.split(\"\\n\");\n    const lineNumber = lines.length - 1;\n    const lineHeight = parseInt(getComputedStyle(textarea).lineHeight) || 24;\n\n    // Calculate approximate position\n    const scrollTop = textarea.scrollTop;\n    const paddingTop = parseInt(getComputedStyle(textarea).paddingTop) || 0;\n    const paddingLeft = parseInt(getComputedStyle(textarea).paddingLeft) || 0;\n\n    // Position toolbar above the selection\n    const top = textareaRect.top + paddingTop + (lineNumber * lineHeight) - scrollTop - this.offsetHeight - 8;\n    const left = textareaRect.left + paddingLeft + Math.min(100, lines[lineNumber].length * 8);\n\n    // Ensure toolbar stays within viewport\n    const maxLeft = window.innerWidth - this.offsetWidth - 16;\n    const maxTop = Math.max(8, top);\n\n    this.style.top = `${maxTop}px`;\n    this.style.left = `${Math.min(left, maxLeft)}px`;\n  }\n\n  // ============================================\n  // SHOW/HIDE\n  // ============================================\n\n  #show() {\n    this.#clearHideTimeout();\n    if (!this.#isVisible) {\n      this.classList.add(\"visible\");\n      this.#isVisible = true;\n    }\n  }\n\n  #hide() {\n    this.#clearHideTimeout();\n    if (this.#isVisible) {\n      this.classList.remove(\"visible\");\n      this.#isVisible = false;\n    }\n  }\n\n  #scheduleHide() {\n    this.#clearHideTimeout();\n    this.#hideTimeout = setTimeout(() => this.#hide(), 150);\n  }\n\n  #clearHideTimeout() {\n    if (this.#hideTimeout) {\n      clearTimeout(this.#hideTimeout);\n      this.#hideTimeout = null;\n    }\n  }\n\n  // ============================================\n  // MARKDOWN ACTIONS\n  // ============================================\n\n  #applyAction(actionName) {\n    const action = EcMarkdownToolbar.MARKDOWN_ACTIONS[actionName];\n    if (!action) return;\n\n    const textarea = this.#targetTextarea;\n    const { selectionStart, selectionEnd, value } = textarea;\n    const selectedText = value.substring(selectionStart, selectionEnd);\n\n    let newText;\n    let newCursorStart;\n    let newCursorEnd;\n\n    if (action.lineStart) {\n      // For line-start actions (heading, quote), insert at start of line\n      const lineStart = value.lastIndexOf(\"\\n\", selectionStart - 1) + 1;\n      const beforeLine = value.substring(0, lineStart);\n      const afterSelection = value.substring(selectionEnd);\n      const lineContent = selectedText || action.placeholder;\n\n      newText = beforeLine + action.prefix + lineContent + action.suffix + afterSelection;\n      newCursorStart = lineStart + action.prefix.length;\n      newCursorEnd = newCursorStart + lineContent.length;\n    } else {\n      // For wrap actions (bold, italic, code, link)\n      const before = value.substring(0, selectionStart);\n      const after = value.substring(selectionEnd);\n      const content = selectedText || action.placeholder;\n\n      newText = before + action.prefix + content + action.suffix + after;\n      newCursorStart = selectionStart + action.prefix.length;\n      newCursorEnd = newCursorStart + content.length;\n    }\n\n    // Update textarea\n    textarea.value = newText;\n\n    // Restore selection\n    textarea.setSelectionRange(newCursorStart, newCursorEnd);\n    textarea.focus();\n\n    // Trigger input event for any listeners (like auto-save)\n    textarea.dispatchEvent(new Event(\"input\", { bubbles: true }));\n\n    // Hide toolbar\n    this.#hide();\n  }\n\n  // ============================================\n  // KEYBOARD SHORTCUTS\n  // ============================================\n\n  #handleKeydown(e) {\n    // Check for Ctrl/Cmd + key\n    if (!(e.ctrlKey || e.metaKey)) return;\n\n    const action = EcMarkdownToolbar.KEYBOARD_SHORTCUTS[e.key.toLowerCase()];\n    if (action) {\n      e.preventDefault();\n      this.#applyAction(action);\n    }\n  }\n}\n\n// ============================================\n// REGISTER CUSTOM ELEMENT\n// ============================================\n\ncustomElements.define(\"ec-markdown-toolbar\", EcMarkdownToolbar);\n\n// Expose class for external use\nwindow.EcMarkdownToolbar = EcMarkdownToolbar;\n", "/**\n * EditorCore - Abstract interface for content editors\n *\n * This defines the contract that all editor implementations must follow.\n * Allows swapping between different editor backends (textarea, TipTap, etc.)\n * without changing the rest of the application.\n *\n * Usage:\n * 1. Extend this class\n * 2. Implement all abstract methods\n * 3. Register with EditorCore.register('type', YourEditorClass)\n * 4. Create instances with EditorCore.create('type', container, options)\n *\n * Example:\n * class MarkdownEditor extends EditorCore {\n *   constructor(container, options) {\n *     super(container, options);\n *     // Setup textarea, etc.\n *   }\n *   getContent() { return this.textarea.value; }\n *   // ... implement other methods\n * }\n *\n * EditorCore.register('markdown', MarkdownEditor);\n * const editor = EditorCore.create('markdown', container, { placeholder: '...' });\n */\n\nclass EditorCore {\n  // ============================================\n  // STATIC REGISTRY\n  // ============================================\n\n  static #registry = new Map();\n\n  /**\n   * Register an editor implementation\n   * @param {string} type - Editor type identifier\n   * @param {typeof EditorCore} EditorClass - Editor class that extends EditorCore\n   */\n  static register(type, EditorClass) {\n    if (!(EditorClass.prototype instanceof EditorCore)) {\n      throw new Error(`${EditorClass.name} must extend EditorCore`);\n    }\n    EditorCore.#registry.set(type, EditorClass);\n  }\n\n  /**\n   * Create an editor instance\n   * @param {string} type - Editor type identifier\n   * @param {HTMLElement} container - Container element\n   * @param {Object} options - Editor options\n   * @returns {EditorCore} Editor instance\n   */\n  static create(type, container, options = {}) {\n    const EditorClass = EditorCore.#registry.get(type);\n    if (!EditorClass) {\n      throw new Error(`Unknown editor type: ${type}. Available: ${[...EditorCore.#registry.keys()].join(', ')}`);\n    }\n    return new EditorClass(container, options);\n  }\n\n  /**\n   * Get all registered editor types\n   * @returns {string[]}\n   */\n  static getRegisteredTypes() {\n    return [...EditorCore.#registry.keys()];\n  }\n\n  // ============================================\n  // INSTANCE PROPERTIES\n  // ============================================\n\n  /** @type {HTMLElement} */\n  container = null;\n\n  /** @type {Object} */\n  options = {};\n\n  /** @type {Function[]} */\n  #changeCallbacks = [];\n\n  /** @type {Function[]} */\n  #selectionCallbacks = [];\n\n  // ============================================\n  // CONSTRUCTOR\n  // ============================================\n\n  /**\n   * @param {HTMLElement} container - Container element for the editor\n   * @param {Object} options - Editor configuration options\n   */\n  constructor(container, options = {}) {\n    if (new.target === EditorCore) {\n      throw new Error('EditorCore is abstract and cannot be instantiated directly');\n    }\n    this.container = container;\n    this.options = options;\n  }\n\n  // ============================================\n  // ABSTRACT METHODS (must be implemented)\n  // ============================================\n\n  /**\n   * Get the current content\n   * @returns {string} The editor content\n   * @abstract\n   */\n  getContent() {\n    throw new Error('getContent() must be implemented');\n  }\n\n  /**\n   * Set the editor content\n   * @param {string} content - The content to set\n   * @abstract\n   */\n  setContent(content) {\n    throw new Error('setContent() must be implemented');\n  }\n\n  /**\n   * Get the current selection\n   * @returns {{ start: number, end: number, text: string }} Selection info\n   * @abstract\n   */\n  getSelection() {\n    throw new Error('getSelection() must be implemented');\n  }\n\n  /**\n   * Insert text at the current cursor position\n   * @param {string} text - Text to insert\n   * @abstract\n   */\n  insertAtCursor(text) {\n    throw new Error('insertAtCursor() must be implemented');\n  }\n\n  /**\n   * Wrap the current selection with prefix and suffix\n   * @param {string} prefix - Text to insert before selection\n   * @param {string} suffix - Text to insert after selection\n   * @param {string} [placeholder] - Default text if no selection\n   * @abstract\n   */\n  wrapSelection(prefix, suffix, placeholder = '') {\n    throw new Error('wrapSelection() must be implemented');\n  }\n\n  /**\n   * Focus the editor\n   * @abstract\n   */\n  focus() {\n    throw new Error('focus() must be implemented');\n  }\n\n  /**\n   * Destroy the editor and clean up resources\n   * @abstract\n   */\n  destroy() {\n    throw new Error('destroy() must be implemented');\n  }\n\n  // ============================================\n  // EVENT METHODS (default implementations)\n  // ============================================\n\n  /**\n   * Register a callback for content changes\n   * @param {Function} callback - Called with (content: string) on change\n   */\n  onChange(callback) {\n    if (typeof callback === 'function') {\n      this.#changeCallbacks.push(callback);\n    }\n  }\n\n  /**\n   * Register a callback for selection changes\n   * @param {Function} callback - Called with (selection: { start, end, text }) on selection change\n   */\n  onSelectionChange(callback) {\n    if (typeof callback === 'function') {\n      this.#selectionCallbacks.push(callback);\n    }\n  }\n\n  /**\n   * Emit a content change event\n   * @protected\n   */\n  _emitChange() {\n    const content = this.getContent();\n    this.#changeCallbacks.forEach(cb => cb(content));\n  }\n\n  /**\n   * Emit a selection change event\n   * @protected\n   */\n  _emitSelectionChange() {\n    const selection = this.getSelection();\n    this.#selectionCallbacks.forEach(cb => cb(selection));\n  }\n\n  // ============================================\n  // OPTIONAL METHODS (can be overridden)\n  // ============================================\n\n  /**\n   * Check if the editor is empty\n   * @returns {boolean}\n   */\n  isEmpty() {\n    return this.getContent().trim() === '';\n  }\n\n  /**\n   * Get word count\n   * @returns {number}\n   */\n  getWordCount() {\n    const content = this.getContent().trim();\n    if (!content) return 0;\n    return content.split(/\\s+/).length;\n  }\n\n  /**\n   * Get character count\n   * @returns {number}\n   */\n  getCharacterCount() {\n    return this.getContent().length;\n  }\n\n  /**\n   * Register a slash command (for future /command support)\n   * @param {string} trigger - Command trigger (e.g., '/image')\n   * @param {Function} handler - Command handler function\n   */\n  registerCommand(trigger, handler) {\n    // Default: no-op, can be overridden by implementations that support commands\n    console.warn('Commands not supported by this editor implementation');\n  }\n}\n\n// Export for ES modules\nexport { EditorCore };\n\n// Also expose globally for backward compatibility\nwindow.EditorCore = EditorCore;\n", "/**\n * MarkdownEditor - Markdown editor implementation extending EditorCore\n *\n * A simple textarea-based markdown editor with floating toolbar support.\n * Designed to be swappable with richer editors (TipTap) in the future.\n *\n * Usage:\n * const editor = EditorCore.create('markdown', container, {\n *   placeholder: 'Write your story...',\n *   initialContent: '# Hello',\n *   toolbar: document.querySelector('ec-markdown-toolbar')\n * });\n *\n * Features:\n * - Wraps existing textarea or creates one\n * - Integrates with ec-markdown-toolbar for floating toolbar\n * - Keyboard shortcuts (Ctrl/Cmd + B, I, K, `)\n * - Change and selection events\n */\n\nclass MarkdownEditor extends EditorCore {\n  // ============================================\n  // PRIVATE STATE\n  // ============================================\n\n  /** @type {HTMLTextAreaElement} */\n  #textarea = null;\n\n  /** @type {AbortController} */\n  #abortController = null;\n\n  /** @type {HTMLElement} */\n  #toolbar = null;\n\n  // Markdown formatting actions\n  static ACTIONS = {\n    bold: { prefix: '**', suffix: '**', placeholder: 'bold text' },\n    italic: { prefix: '_', suffix: '_', placeholder: 'italic text' },\n    code: { prefix: '`', suffix: '`', placeholder: 'code' },\n    link: { prefix: '[', suffix: '](url)', placeholder: 'link text' },\n    heading: { prefix: '## ', suffix: '', placeholder: 'Heading', lineStart: true },\n    quote: { prefix: '> ', suffix: '', placeholder: 'quote', lineStart: true },\n  };\n\n  static KEYBOARD_SHORTCUTS = {\n    'b': 'bold',\n    'i': 'italic',\n    'k': 'link',\n    '`': 'code',\n  };\n\n  // ============================================\n  // CONSTRUCTOR\n  // ============================================\n\n  constructor(container, options = {}) {\n    super(container, options);\n\n    // Find or create textarea\n    this.#textarea = container.querySelector('textarea') || this.#createTextarea();\n\n    // Set initial content if provided\n    if (options.initialContent) {\n      this.setContent(options.initialContent);\n    }\n\n    // Connect toolbar if provided\n    if (options.toolbar) {\n      this.#toolbar = options.toolbar;\n    }\n\n    // Setup event listeners\n    this.#abortController = new AbortController();\n    this.#setupListeners();\n  }\n\n  // ============================================\n  // ABSTRACT METHOD IMPLEMENTATIONS\n  // ============================================\n\n  getContent() {\n    return this.#textarea.value;\n  }\n\n  setContent(content) {\n    this.#textarea.value = content;\n    this._emitChange();\n  }\n\n  getSelection() {\n    const { selectionStart, selectionEnd, value } = this.#textarea;\n    return {\n      start: selectionStart,\n      end: selectionEnd,\n      text: value.substring(selectionStart, selectionEnd),\n    };\n  }\n\n  insertAtCursor(text) {\n    const { selectionStart, selectionEnd, value } = this.#textarea;\n    const before = value.substring(0, selectionStart);\n    const after = value.substring(selectionEnd);\n\n    this.#textarea.value = before + text + after;\n    \n    // Position cursor after inserted text\n    const newPos = selectionStart + text.length;\n    this.#textarea.setSelectionRange(newPos, newPos);\n    \n    this._emitChange();\n    this.focus();\n  }\n\n  wrapSelection(prefix, suffix, placeholder = '') {\n    const { selectionStart, selectionEnd, value } = this.#textarea;\n    const selectedText = value.substring(selectionStart, selectionEnd) || placeholder;\n    const before = value.substring(0, selectionStart);\n    const after = value.substring(selectionEnd);\n\n    this.#textarea.value = before + prefix + selectedText + suffix + after;\n\n    // Select the wrapped text (or placeholder)\n    const newStart = selectionStart + prefix.length;\n    const newEnd = newStart + selectedText.length;\n    this.#textarea.setSelectionRange(newStart, newEnd);\n\n    this._emitChange();\n    this.focus();\n  }\n\n  focus() {\n    this.#textarea.focus();\n  }\n\n  destroy() {\n    this.#abortController?.abort();\n    this.#toolbar = null;\n  }\n\n  // ============================================\n  // MARKDOWN-SPECIFIC METHODS\n  // ============================================\n\n  /**\n   * Apply a markdown formatting action\n   * @param {string} actionName - Name of the action (bold, italic, etc.)\n   */\n  applyAction(actionName) {\n    const action = MarkdownEditor.ACTIONS[actionName];\n    if (!action) return;\n\n    if (action.lineStart) {\n      this.#applyLineStartAction(action);\n    } else {\n      this.wrapSelection(action.prefix, action.suffix, action.placeholder);\n    }\n  }\n\n  /**\n   * Apply an action that affects the start of a line\n   * @private\n   */\n  #applyLineStartAction(action) {\n    const { selectionStart, selectionEnd, value } = this.#textarea;\n    const selectedText = value.substring(selectionStart, selectionEnd) || action.placeholder;\n\n    // Find the start of the current line\n    const lineStart = value.lastIndexOf('\\n', selectionStart - 1) + 1;\n    const beforeLine = value.substring(0, lineStart);\n    const afterSelection = value.substring(selectionEnd);\n\n    this.#textarea.value = beforeLine + action.prefix + selectedText + action.suffix + afterSelection;\n\n    // Select the text\n    const newStart = lineStart + action.prefix.length;\n    const newEnd = newStart + selectedText.length;\n    this.#textarea.setSelectionRange(newStart, newEnd);\n\n    this._emitChange();\n    this.focus();\n  }\n\n  // ============================================\n  // PRIVATE METHODS\n  // ============================================\n\n  #createTextarea() {\n    const textarea = document.createElement('textarea');\n    textarea.className = 'editor-content';\n    textarea.placeholder = this.options.placeholder || 'Write your content...';\n    this.container.appendChild(textarea);\n    return textarea;\n  }\n\n  #setupListeners() {\n    const { signal } = this.#abortController;\n\n    // Content changes\n    this.#textarea.addEventListener('input', () => {\n      this._emitChange();\n    }, { signal });\n\n    // Selection changes\n    this.#textarea.addEventListener('select', () => {\n      this._emitSelectionChange();\n    }, { signal });\n\n    this.#textarea.addEventListener('mouseup', () => {\n      setTimeout(() => this._emitSelectionChange(), 10);\n    }, { signal });\n\n    this.#textarea.addEventListener('keyup', (e) => {\n      // Emit selection change on arrow keys\n      if (['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'].includes(e.key)) {\n        this._emitSelectionChange();\n      }\n    }, { signal });\n\n    // Keyboard shortcuts\n    this.#textarea.addEventListener('keydown', (e) => {\n      if (!(e.ctrlKey || e.metaKey)) return;\n\n      const action = MarkdownEditor.KEYBOARD_SHORTCUTS[e.key.toLowerCase()];\n      if (action) {\n        e.preventDefault();\n        this.applyAction(action);\n      }\n    }, { signal });\n  }\n}\n\n// Register with EditorCore\nEditorCore.register('markdown', MarkdownEditor);\n\n// Expose class for external use\nwindow.MarkdownEditor = MarkdownEditor;\n", "/**\n * Post Editor - Orchestrator for the post editor experience\n *\n * Features:\n * - Title sync (content input -> header display)\n * - Auto-save with debouncing (2 seconds after typing stops)\n * - Save/Publish/Unpublish actions\n * - Status indicator with relative time\n * - Sidebar field sync to hidden form fields\n * - Cover image preview\n * - Publish dropdown toggle\n */\n\n(function () {\n  \"use strict\";\n\n  // ============================================\n  // CONFIGURATION\n  // ============================================\n\n  const AUTOSAVE_DELAY = 2000; // 2 seconds after typing stops\n  const COVER_PREVIEW_DELAY = 500; // Debounce for cover image preview\n  const TIME_UPDATE_INTERVAL = 60000; // Update relative time every minute\n\n  // ============================================\n  // STATE\n  // ============================================\n\n  let autosaveTimeout = null;\n  let coverPreviewTimeout = null;\n  let timeUpdateInterval = null;\n  let lastSavedContent = null;\n  let isNewPost = false;\n\n  // Element references\n  let editorLayout = null;\n  let form = null;\n  let titleInput = null;\n  let contentTextarea = null;\n  let titleDisplay = null;\n  let statusEl = null;\n  let actionField = null;\n\n  // ============================================\n  // INITIALIZATION\n  // ============================================\n\n  function init() {\n    editorLayout = document.querySelector(\"[data-editor]\");\n    if (!editorLayout) return; // Not on editor page\n\n    form = document.getElementById(\"post-editor-form\");\n    if (!form) return;\n\n    isNewPost = editorLayout.dataset.isNew === \"true\";\n    \n    titleInput = document.getElementById(\"title\");\n    contentTextarea = document.getElementById(\"content\");\n    titleDisplay = document.querySelector(\"[data-title-display]\");\n    statusEl = document.querySelector(\"[data-status]\");\n    actionField = document.querySelector(\"[data-action-field]\");\n\n    // Setup change tracking on textarea\n    if (contentTextarea) {\n      contentTextarea.addEventListener('input', handleEditorChange);\n    }\n\n    // Store initial content for change detection\n    lastSavedContent = getContentSnapshot();\n\n    // Setup features\n    setupTitleSync();\n    setupAutosave();\n    setupSidebarSync();\n    setupActionButtons();\n    setupPublishDropdown();\n    setupCoverImagePreview();\n    setupRelativeTimeUpdates();\n\n    // Auto-generate slug from title for new posts\n    if (isNewPost) {\n      setupSlugGeneration();\n    }\n  }\n\n  // ============================================\n  // EDITOR CHANGE HANDLING\n  // ============================================\n\n  function handleEditorChange() {\n    // Show unsaved indicator\n    checkForUnsavedChanges();\n\n    // Clear any pending autosave\n    if (autosaveTimeout) {\n      clearTimeout(autosaveTimeout);\n    }\n\n    // Schedule new autosave (only for existing posts)\n    if (!isNewPost) {\n      autosaveTimeout = setTimeout(() => {\n        performSave(\"save\");\n      }, AUTOSAVE_DELAY);\n    }\n  }\n\n  // ============================================\n  // CONTENT SNAPSHOT\n  // ============================================\n\n  function getContentSnapshot() {\n    return {\n      title: titleInput?.value || \"\",\n      content: contentTextarea?.value || \"\",\n      slug: document.getElementById(\"slug\")?.value || \"\",\n      excerpt: document.getElementById(\"excerpt\")?.value || \"\",\n      cover_image: document.getElementById(\"cover_image\")?.value || \"\",\n    };\n  }\n\n  function hasUnsavedChanges() {\n    if (!lastSavedContent) return false;\n    const current = getContentSnapshot();\n    return (\n      current.title !== lastSavedContent.title ||\n      current.content !== lastSavedContent.content ||\n      current.slug !== lastSavedContent.slug ||\n      current.excerpt !== lastSavedContent.excerpt ||\n      current.cover_image !== lastSavedContent.cover_image\n    );\n  }\n\n  function checkForUnsavedChanges() {\n    if (hasUnsavedChanges()) {\n      updateStatus(\"unsaved\");\n    }\n  }\n\n  // ============================================\n  // TITLE SYNC\n  // ============================================\n\n  function setupTitleSync() {\n    if (!titleInput || !titleDisplay) return;\n\n    titleInput.addEventListener(\"input\", () => {\n      const title = titleInput.value.trim() || \"Untitled\";\n      titleDisplay.textContent = title;\n    });\n  }\n\n  // ============================================\n  // AUTO-SAVE\n  // ============================================\n\n  function setupAutosave() {\n    if (isNewPost) return; // No autosave for new posts\n\n    const autosaveUrl = form.dataset.autosave;\n    if (!autosaveUrl) return;\n\n    // Listen for changes on main inputs\n    titleInput?.addEventListener(\"input\", handleEditorChange);\n\n    // Also listen on sidebar inputs\n    document.querySelectorAll(\"[data-sync]\").forEach((input) => {\n      input.addEventListener(\"input\", handleEditorChange);\n    });\n  }\n\n  async function performSave(action) {\n    if (isNewPost && action === \"save\") {\n      // For new posts, we need to submit the form normally\n      // Auto-save doesn't work for unsaved posts\n      return;\n    }\n\n    const autosaveUrl = form.dataset.autosave;\n    if (!autosaveUrl) return;\n\n    // Update status\n    updateStatus(\"saving\");\n\n    try {\n      // Get CSRF token\n      const csrfInput = form.querySelector('input[name=\"csrf_token\"]');\n      const csrfToken = csrfInput?.value || \"\";\n\n      // Set action\n      if (actionField) {\n        actionField.value = action;\n      }\n\n      // Collect all form data\n      const formData = new FormData(form);\n\n      const response = await fetch(autosaveUrl, {\n        method: \"PATCH\",\n        headers: {\n          \"X-CSRF-Token\": csrfToken,\n        },\n        body: formData,\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        lastSavedContent = getContentSnapshot();\n\n        // Update status with new timestamp\n        updateStatus(\"saved\", data.updated_at);\n\n        // Update UI based on publish state\n        if (data.is_draft !== undefined) {\n          updatePublishState(data.is_draft);\n        }\n      } else {\n        const errorText = await response.text();\n        console.error(\"Save failed:\", errorText);\n        updateStatus(\"error\", null, errorText);\n      }\n    } catch (error) {\n      console.error(\"Save error:\", error);\n      updateStatus(\"error\", null, error.message);\n    }\n  }\n\n  // ============================================\n  // STATUS DISPLAY\n  // ============================================\n\n  function updateStatus(state, timestamp, errorMessage) {\n    if (!statusEl) return;\n\n    switch (state) {\n      case \"saving\":\n        statusEl.innerHTML = '<span class=\"editor-status-saving\">Saving...</span>';\n        break;\n      case \"saved\":\n        const timeStr = timestamp ? formatRelativeTime(new Date(timestamp)) : \"just now\";\n        statusEl.innerHTML = `<span class=\"editor-status-saved\" data-updated-at=\"${timestamp || new Date().toISOString()}\">Last saved: ${timeStr}</span>`;\n        break;\n      case \"unsaved\":\n        statusEl.innerHTML = '<span class=\"editor-status-unsaved\">Unsaved changes</span>';\n        break;\n      case \"error\":\n        const msg = errorMessage || \"Save failed\";\n        statusEl.innerHTML = `<span class=\"editor-status-error\">${msg}</span>`;\n        break;\n    }\n  }\n\n  function formatRelativeTime(date) {\n    const now = new Date();\n    const diff = now - date;\n    const seconds = Math.floor(diff / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const hours = Math.floor(minutes / 60);\n    const days = Math.floor(hours / 24);\n\n    if (seconds < 60) return \"just now\";\n    if (minutes === 1) return \"1 minute ago\";\n    if (minutes < 60) return `${minutes} minutes ago`;\n    if (hours === 1) return \"1 hour ago\";\n    if (hours < 24) return `${hours} hours ago`;\n    if (days === 1) return \"yesterday\";\n\n    return date.toLocaleDateString(\"en-US\", {\n      month: \"short\",\n      day: \"numeric\",\n      year: date.getFullYear() !== now.getFullYear() ? \"numeric\" : undefined,\n    });\n  }\n\n  function setupRelativeTimeUpdates() {\n    // Update relative time every minute\n    timeUpdateInterval = setInterval(() => {\n      const savedSpan = statusEl?.querySelector(\"[data-updated-at]\");\n      if (savedSpan) {\n        const timestamp = savedSpan.dataset.updatedAt;\n        if (timestamp) {\n          const timeStr = formatRelativeTime(new Date(timestamp));\n          savedSpan.textContent = `Last saved: ${timeStr}`;\n        }\n      }\n    }, TIME_UPDATE_INTERVAL);\n  }\n\n  // ============================================\n  // ACTION BUTTONS\n  // ============================================\n\n  function setupActionButtons() {\n    // Save button\n    document.querySelectorAll('[data-action-btn=\"save\"]').forEach((btn) => {\n      btn.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        if (isNewPost) {\n          // For new posts, submit normally with save action\n          if (actionField) actionField.value = \"save\";\n          // Set is_draft to true for save\n          const draftInput = document.getElementById(\"is_draft\");\n          if (draftInput) draftInput.value = \"true\";\n          form.submit();\n        } else {\n          performSave(\"save\");\n        }\n      });\n    });\n\n    // Publish button\n    document.querySelectorAll('[data-action-btn=\"publish\"]').forEach((btn) => {\n      btn.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        if (isNewPost) {\n          // For new posts, submit normally with publish action\n          if (actionField) actionField.value = \"publish\";\n          const draftInput = document.getElementById(\"is_draft\");\n          if (draftInput) draftInput.value = \"false\";\n          form.submit();\n        } else {\n          performSave(\"publish\");\n        }\n      });\n    });\n\n    // Unpublish button\n    document.querySelectorAll('[data-action-btn=\"unpublish\"]').forEach((btn) => {\n      btn.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        performSave(\"unpublish\");\n      });\n    });\n  }\n\n  function updatePublishState(isDraft) {\n    // This would update the publish button UI\n    // For now, we might need to reload to reflect the state\n    // In future, we can swap the button dynamically\n  }\n\n  // ============================================\n  // PUBLISH DROPDOWN\n  // ============================================\n\n  function setupPublishDropdown() {\n    const dropdown = document.querySelector(\"[data-dropdown-container]\");\n    if (!dropdown) return;\n\n    const trigger = dropdown.querySelector(\"[data-dropdown-trigger]\");\n    const menu = dropdown.querySelector(\"[data-dropdown-menu]\");\n\n    if (!trigger || !menu) return;\n\n    trigger.addEventListener(\"click\", (e) => {\n      e.stopPropagation();\n      dropdown.classList.toggle(\"open\");\n    });\n\n    // Close on outside click\n    document.addEventListener(\"click\", (e) => {\n      if (!dropdown.contains(e.target)) {\n        dropdown.classList.remove(\"open\");\n      }\n    });\n\n    // Close on escape\n    document.addEventListener(\"keydown\", (e) => {\n      if (e.key === \"Escape\") {\n        dropdown.classList.remove(\"open\");\n      }\n    });\n  }\n\n  // ============================================\n  // SIDEBAR SYNC\n  // ============================================\n\n  function setupSidebarSync() {\n    // Sync sidebar inputs to hidden form fields\n    document.querySelectorAll(\"[data-sync]\").forEach((input) => {\n      const targetId = input.dataset.sync;\n      const hiddenInput = document.getElementById(targetId);\n\n      if (!hiddenInput) return;\n\n      input.addEventListener(\"input\", () => {\n        if (input.type === \"checkbox\") {\n          hiddenInput.value = input.checked ? \"true\" : \"false\";\n        } else {\n          hiddenInput.value = input.value;\n        }\n      });\n    });\n\n    // Handle tag selection sync\n    const tagSelect = document.querySelector(\"ec-tag-select\");\n    if (tagSelect) {\n      tagSelect.addEventListener(\"change\", () => {\n        syncTagsToForm();\n      });\n\n      // Also listen for checkbox changes inside the tag select\n      tagSelect.addEventListener(\"click\", (e) => {\n        if (e.target.type === \"checkbox\") {\n          setTimeout(syncTagsToForm, 0);\n        }\n      });\n    }\n  }\n\n  function syncTagsToForm() {\n    const container = document.getElementById(\"tag-ids-container\");\n    if (!container) return;\n\n    // Clear existing tag inputs\n    container.innerHTML = \"\";\n\n    // Get selected tags from sidebar\n    const selectedTags = document.querySelectorAll(\n      'input[name=\"sidebar_tag_ids\"]:checked'\n    );\n\n    // Add hidden inputs for each selected tag\n    selectedTags.forEach((tag) => {\n      const hiddenInput = document.createElement(\"input\");\n      hiddenInput.type = \"hidden\";\n      hiddenInput.name = \"tag_ids\";\n      hiddenInput.value = tag.value;\n      hiddenInput.dataset.tagId = tag.value;\n      container.appendChild(hiddenInput);\n    });\n  }\n\n  // ============================================\n  // COVER IMAGE PREVIEW\n  // ============================================\n\n  function setupCoverImagePreview() {\n    const coverInput = document.querySelector(\"[data-preview-trigger]\");\n    const previewContainer = document.querySelector(\"[data-cover-preview]\");\n\n    if (!coverInput || !previewContainer) return;\n\n    coverInput.addEventListener(\"input\", () => {\n      // Debounce\n      if (coverPreviewTimeout) {\n        clearTimeout(coverPreviewTimeout);\n      }\n\n      coverPreviewTimeout = setTimeout(() => {\n        updateCoverPreview(coverInput.value, previewContainer);\n      }, COVER_PREVIEW_DELAY);\n    });\n  }\n\n  function updateCoverPreview(url, container) {\n    // Remove existing image\n    const existingImg = container.querySelector(\"img\");\n    if (existingImg) {\n      existingImg.remove();\n    }\n\n    // Reset error state\n    container.classList.remove(\"error\");\n\n    if (!url) return;\n\n    // Create new image\n    const img = document.createElement(\"img\");\n    img.src = url;\n    img.alt = \"Cover preview\";\n    img.className = \"cover-image-preview-img\";\n\n    img.onload = () => {\n      container.classList.remove(\"error\");\n    };\n\n    img.onerror = () => {\n      container.classList.add(\"error\");\n    };\n\n    container.insertBefore(img, container.firstChild);\n  }\n\n  // ============================================\n  // SLUG GENERATION\n  // ============================================\n\n  function setupSlugGeneration() {\n    if (!titleInput) return;\n\n    const slugInput = document.getElementById(\"slug\");\n    const sidebarSlug = document.getElementById(\"sidebar-slug\");\n\n    let userEditedSlug = false;\n\n    // Track if user manually edits slug\n    if (sidebarSlug) {\n      sidebarSlug.addEventListener(\"input\", () => {\n        userEditedSlug = true;\n      });\n    }\n\n    titleInput.addEventListener(\"input\", () => {\n      // Only auto-generate if user hasn't manually edited\n      if (userEditedSlug) return;\n\n      const slug = generateSlug(titleInput.value);\n\n      if (slugInput) {\n        slugInput.value = slug;\n      }\n      if (sidebarSlug) {\n        sidebarSlug.value = slug;\n      }\n    });\n  }\n\n  function generateSlug(text) {\n    return text\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, \"\") // Remove non-word chars\n      .replace(/\\s+/g, \"-\") // Replace spaces with hyphens\n      .replace(/-+/g, \"-\") // Replace multiple hyphens with single\n      .substring(0, 100); // Limit length\n  }\n\n  // ============================================\n  // CLEANUP\n  // ============================================\n\n  function cleanup() {\n    if (autosaveTimeout) clearTimeout(autosaveTimeout);\n    if (coverPreviewTimeout) clearTimeout(coverPreviewTimeout);\n    if (timeUpdateInterval) clearInterval(timeUpdateInterval);\n  }\n\n  // ============================================\n  // STARTUP\n  // ============================================\n\n  // Initialize when DOM is ready\n  if (document.readyState === \"loading\") {\n    document.addEventListener(\"DOMContentLoaded\", init);\n  } else {\n    init();\n  }\n\n  // Cleanup on page unload\n  window.addEventListener(\"beforeunload\", cleanup);\n\n  // Re-initialize on HTMX content swaps\n  document.addEventListener(\"htmx:afterSettle\", init);\n})();\n", "/**\n * Split Markdown Editor\n * \n * A full-featured markdown editor with:\n * - Split view (editor + live preview)\n * - Fixed toolbar with formatting actions\n * - Image upload via drag & drop\n * - Keyboard shortcuts\n * - Auto-save\n * - Syntax highlighting in preview\n */\n\n(function () {\n  \"use strict\";\n\n  // ============================================\n  // CONFIGURATION\n  // ============================================\n\n  const AUTOSAVE_DELAY = 2000; // 2 seconds after typing stops\n  const PREVIEW_DELAY = 300; // 300ms debounce for preview updates\n  const COVER_PREVIEW_DELAY = 500;\n  const TIME_UPDATE_INTERVAL = 60000;\n\n  // Markdown formatting actions\n  const MARKDOWN_ACTIONS = {\n    bold: { prefix: \"**\", suffix: \"**\", placeholder: \"bold text\" },\n    italic: { prefix: \"_\", suffix: \"_\", placeholder: \"italic text\" },\n    strikethrough: { prefix: \"~~\", suffix: \"~~\", placeholder: \"strikethrough\" },\n    code: { prefix: \"`\", suffix: \"`\", placeholder: \"code\" },\n    link: { prefix: \"[\", suffix: \"](url)\", placeholder: \"link text\" },\n    image: { prefix: \"![\", suffix: \"](url)\", placeholder: \"alt text\" },\n    heading: { prefix: \"## \", suffix: \"\", placeholder: \"Heading\", lineStart: true },\n    quote: { prefix: \"> \", suffix: \"\", placeholder: \"quote\", lineStart: true },\n    ul: { prefix: \"- \", suffix: \"\", placeholder: \"list item\", lineStart: true },\n    ol: { prefix: \"1. \", suffix: \"\", placeholder: \"list item\", lineStart: true },\n    hr: { prefix: \"\\n---\\n\", suffix: \"\", placeholder: \"\", insert: true },\n    codeblock: { \n      prefix: \"```\\n\", \n      suffix: \"\\n```\", \n      placeholder: \"code here\",\n      block: true \n    },\n    table: {\n      prefix: \"\",\n      suffix: \"\",\n      placeholder: \"\",\n      template: `| Header 1 | Header 2 | Header 3 |\n|----------|----------|----------|\n| Cell 1   | Cell 2   | Cell 3   |\n| Cell 4   | Cell 5   | Cell 6   |`,\n      insert: true\n    }\n  };\n\n  const KEYBOARD_SHORTCUTS = {\n    \"b\": \"bold\",\n    \"i\": \"italic\",\n    \"k\": \"link\",\n    \"`\": \"code\",\n    \"h\": \"heading\",\n    \"p\": \"toggle-preview\"\n  };\n\n  // ============================================\n  // STATE\n  // ============================================\n\n  let editorLayout = null;\n  let form = null;\n  let titleInput = null;\n  let contentTextarea = null;\n  let titleDisplay = null;\n  let previewTitle = null;\n  let previewContent = null;\n  let previewPane = null;\n  let sidebar = null;\n  let toolbar = null;\n  let statusEl = null;\n  let actionField = null;\n  let dropzone = null;\n  let dropzoneOverlay = null;\n  let imageInput = null;\n\n  let autosaveTimeout = null;\n  let previewTimeout = null;\n  let coverPreviewTimeout = null;\n  let timeUpdateInterval = null;\n  let lastSavedContent = null;\n  let isNewPost = false;\n  let uploadUrl = \"\";\n  let previewVisible = true;\n  let sidebarVisible = true;\n\n  // ============================================\n  // INITIALIZATION\n  // ============================================\n\n  function init() {\n    editorLayout = document.querySelector('[data-editor-type=\"split-markdown\"]');\n    if (!editorLayout) return;\n\n    form = document.getElementById(\"post-editor-form\");\n    if (!form) return;\n\n    // Get configuration\n    isNewPost = editorLayout.dataset.isNew === \"true\";\n    uploadUrl = editorLayout.dataset.uploadUrl || \"/admin/uploads/image\";\n\n    // Get elements\n    titleInput = document.getElementById(\"title\");\n    contentTextarea = document.getElementById(\"content\");\n    titleDisplay = document.querySelector(\"[data-title-display]\");\n    previewTitle = document.querySelector(\"[data-preview-title]\");\n    previewContent = document.querySelector(\"[data-preview-content]\");\n    previewPane = document.querySelector(\"[data-preview-pane]\");\n    sidebar = document.querySelector(\"[data-sidebar]\");\n    toolbar = document.querySelector(\"[data-toolbar]\");\n    statusEl = document.querySelector(\"[data-status]\");\n    actionField = document.querySelector(\"[data-action-field]\");\n    dropzone = document.querySelector(\"[data-dropzone]\");\n    dropzoneOverlay = document.querySelector(\"[data-dropzone-overlay]\");\n    imageInput = document.querySelector(\"[data-image-input]\");\n\n    // Store initial content\n    lastSavedContent = getContentSnapshot();\n\n    // Configure marked.js\n    if (typeof marked !== \"undefined\") {\n      marked.setOptions({\n        breaks: true,\n        gfm: true,\n        highlight: function (code, lang) {\n          if (typeof hljs !== \"undefined\" && lang && hljs.getLanguage(lang)) {\n            try {\n              return hljs.highlight(code, { language: lang }).value;\n            } catch (e) {\n              console.error(\"Highlight error:\", e);\n            }\n          }\n          return code;\n        }\n      });\n    }\n\n    // Setup features\n    setupTitleSync();\n    setupPreview();\n    setupToolbar();\n    setupKeyboardShortcuts();\n    setupAutosave();\n    setupSidebarSync();\n    setupActionButtons();\n    setupPublishDropdown();\n    setupCoverImagePreview();\n    setupRelativeTimeUpdates();\n    setupImageUpload();\n    setupToggleButtons();\n\n    // Auto-generate slug from title for new posts\n    if (isNewPost) {\n      setupSlugGeneration();\n    }\n\n    // Initial preview render\n    updatePreview();\n\n    console.log(\"Split Markdown Editor initialized\");\n  }\n\n  // ============================================\n  // CONTENT SNAPSHOT\n  // ============================================\n\n  function getContentSnapshot() {\n    return {\n      title: titleInput?.value || \"\",\n      content: contentTextarea?.value || \"\",\n      slug: document.getElementById(\"slug\")?.value || \"\",\n      excerpt: document.getElementById(\"excerpt\")?.value || \"\",\n      cover_image: document.getElementById(\"cover_image\")?.value || \"\",\n    };\n  }\n\n  function hasUnsavedChanges() {\n    if (!lastSavedContent) return false;\n    const current = getContentSnapshot();\n    return (\n      current.title !== lastSavedContent.title ||\n      current.content !== lastSavedContent.content ||\n      current.slug !== lastSavedContent.slug ||\n      current.excerpt !== lastSavedContent.excerpt ||\n      current.cover_image !== lastSavedContent.cover_image\n    );\n  }\n\n  // ============================================\n  // TITLE SYNC\n  // ============================================\n\n  function setupTitleSync() {\n    if (!titleInput) return;\n\n    titleInput.addEventListener(\"input\", () => {\n      const title = titleInput.value.trim() || \"Untitled\";\n      if (titleDisplay) titleDisplay.textContent = title;\n      if (previewTitle) previewTitle.textContent = title;\n    });\n  }\n\n  // ============================================\n  // LIVE PREVIEW\n  // ============================================\n\n  function setupPreview() {\n    if (!contentTextarea || !previewContent) return;\n\n    contentTextarea.addEventListener(\"input\", () => {\n      if (previewTimeout) clearTimeout(previewTimeout);\n      previewTimeout = setTimeout(updatePreview, PREVIEW_DELAY);\n    });\n  }\n\n  function updatePreview() {\n    if (!contentTextarea || !previewContent) return;\n\n    const markdown = contentTextarea.value;\n    \n    if (!markdown.trim()) {\n      previewContent.innerHTML = '<p class=\"text-muted-foreground\">Start writing to see preview...</p>';\n      return;\n    }\n\n    if (typeof marked !== \"undefined\") {\n      try {\n        const html = marked.parse(markdown);\n        previewContent.innerHTML = html;\n        \n        // Apply syntax highlighting to code blocks\n        if (typeof hljs !== \"undefined\") {\n          previewContent.querySelectorAll(\"pre code\").forEach((block) => {\n            hljs.highlightElement(block);\n          });\n        }\n      } catch (e) {\n        console.error(\"Markdown parse error:\", e);\n        previewContent.innerHTML = '<p class=\"text-destructive\">Error rendering preview</p>';\n      }\n    } else {\n      // Fallback if marked.js not loaded\n      previewContent.innerHTML = '<pre class=\"text-sm\">' + escapeHtml(markdown) + '</pre>';\n    }\n  }\n\n  function escapeHtml(text) {\n    const div = document.createElement(\"div\");\n    div.textContent = text;\n    return div.innerHTML;\n  }\n\n  // ============================================\n  // TOOLBAR\n  // ============================================\n\n  function setupToolbar() {\n    if (!toolbar) return;\n\n    toolbar.addEventListener(\"click\", (e) => {\n      const button = e.target.closest(\"button[data-action]\");\n      if (!button) return;\n\n      const action = button.dataset.action;\n      if (action === \"toggle-preview\") {\n        togglePreview();\n      } else if (MARKDOWN_ACTIONS[action]) {\n        applyMarkdownAction(action);\n      }\n    });\n  }\n\n  function applyMarkdownAction(actionName) {\n    const action = MARKDOWN_ACTIONS[actionName];\n    if (!action || !contentTextarea) return;\n\n    // Special handling for image action - trigger file picker\n    if (actionName === \"image\") {\n      if (imageInput) {\n        imageInput.click();\n      }\n      return;\n    }\n\n    const { selectionStart, selectionEnd, value } = contentTextarea;\n    const selectedText = value.substring(selectionStart, selectionEnd);\n\n    let newText;\n    let newCursorStart;\n    let newCursorEnd;\n\n    if (action.insert || action.template) {\n      // Insert template at cursor\n      const template = action.template || action.prefix;\n      const before = value.substring(0, selectionStart);\n      const after = value.substring(selectionEnd);\n\n      newText = before + template + after;\n      newCursorStart = selectionStart + template.length;\n      newCursorEnd = newCursorStart;\n    } else if (action.lineStart) {\n      // Insert at start of line\n      const lineStart = value.lastIndexOf(\"\\n\", selectionStart - 1) + 1;\n      const beforeLine = value.substring(0, lineStart);\n      const afterSelection = value.substring(selectionEnd);\n      const content = selectedText || action.placeholder;\n\n      newText = beforeLine + action.prefix + content + action.suffix + afterSelection;\n      newCursorStart = lineStart + action.prefix.length;\n      newCursorEnd = newCursorStart + content.length;\n    } else if (action.block) {\n      // Block format (e.g., code block)\n      const before = value.substring(0, selectionStart);\n      const after = value.substring(selectionEnd);\n      const content = selectedText || action.placeholder;\n\n      newText = before + action.prefix + content + action.suffix + after;\n      newCursorStart = selectionStart + action.prefix.length;\n      newCursorEnd = newCursorStart + content.length;\n    } else {\n      // Wrap selection\n      const before = value.substring(0, selectionStart);\n      const after = value.substring(selectionEnd);\n      const content = selectedText || action.placeholder;\n\n      newText = before + action.prefix + content + action.suffix + after;\n      newCursorStart = selectionStart + action.prefix.length;\n      newCursorEnd = newCursorStart + content.length;\n    }\n\n    contentTextarea.value = newText;\n    contentTextarea.setSelectionRange(newCursorStart, newCursorEnd);\n    contentTextarea.focus();\n\n    // Trigger input event for preview update and autosave\n    contentTextarea.dispatchEvent(new Event(\"input\", { bubbles: true }));\n  }\n\n  // ============================================\n  // KEYBOARD SHORTCUTS\n  // ============================================\n\n  function setupKeyboardShortcuts() {\n    if (!contentTextarea) return;\n\n    contentTextarea.addEventListener(\"keydown\", (e) => {\n      if (!(e.ctrlKey || e.metaKey)) return;\n\n      const action = KEYBOARD_SHORTCUTS[e.key.toLowerCase()];\n      if (action) {\n        e.preventDefault();\n        if (action === \"toggle-preview\") {\n          togglePreview();\n        } else {\n          applyMarkdownAction(action);\n        }\n      }\n    });\n  }\n\n  // ============================================\n  // TOGGLE BUTTONS\n  // ============================================\n\n  function setupToggleButtons() {\n    // Preview toggle is handled in toolbar click handler\n    \n    // Sidebar toggle\n    const sidebarToggle = document.querySelector('[data-action-btn=\"toggle-sidebar\"]');\n    if (sidebarToggle) {\n      sidebarToggle.addEventListener(\"click\", toggleSidebar);\n    }\n  }\n\n  function togglePreview() {\n    previewVisible = !previewVisible;\n    \n    if (previewPane) {\n      previewPane.style.display = previewVisible ? \"\" : \"none\";\n    }\n    \n    const toggleBtn = document.querySelector(\"[data-preview-toggle]\");\n    if (toggleBtn) {\n      toggleBtn.classList.toggle(\"active\", previewVisible);\n    }\n\n    // Update editor layout class\n    if (editorLayout) {\n      editorLayout.classList.toggle(\"preview-hidden\", !previewVisible);\n    }\n  }\n\n  function toggleSidebar() {\n    sidebarVisible = !sidebarVisible;\n    \n    if (sidebar) {\n      sidebar.style.display = sidebarVisible ? \"\" : \"none\";\n    }\n\n    if (editorLayout) {\n      editorLayout.classList.toggle(\"sidebar-hidden\", !sidebarVisible);\n    }\n  }\n\n  // ============================================\n  // IMAGE UPLOAD\n  // ============================================\n\n  function setupImageUpload() {\n    if (!dropzone || !contentTextarea) return;\n\n    // Drag and drop\n    dropzone.addEventListener(\"dragenter\", handleDragEnter);\n    dropzone.addEventListener(\"dragover\", handleDragOver);\n    dropzone.addEventListener(\"dragleave\", handleDragLeave);\n    dropzone.addEventListener(\"drop\", handleDrop);\n\n    // File input\n    if (imageInput) {\n      imageInput.addEventListener(\"change\", handleFileSelect);\n    }\n  }\n\n  function handleDragEnter(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (dropzoneOverlay) dropzoneOverlay.classList.add(\"active\");\n  }\n\n  function handleDragOver(e) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  function handleDragLeave(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    // Only hide overlay if we're leaving the dropzone completely\n    const rect = dropzone.getBoundingClientRect();\n    const x = e.clientX;\n    const y = e.clientY;\n    \n    if (x < rect.left || x > rect.right || y < rect.top || y > rect.bottom) {\n      if (dropzoneOverlay) dropzoneOverlay.classList.remove(\"active\");\n    }\n  }\n\n  function handleDrop(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (dropzoneOverlay) dropzoneOverlay.classList.remove(\"active\");\n\n    const files = e.dataTransfer?.files;\n    if (files && files.length > 0) {\n      uploadImages(files);\n    }\n  }\n\n  function handleFileSelect(e) {\n    const files = e.target.files;\n    if (files && files.length > 0) {\n      uploadImages(files);\n    }\n    // Reset input so same file can be selected again\n    e.target.value = \"\";\n  }\n\n  async function uploadImages(files) {\n    for (const file of files) {\n      if (!file.type.startsWith(\"image/\")) {\n        showToast(\"error\", `${file.name} is not an image`);\n        continue;\n      }\n\n      try {\n        const url = await uploadImage(file);\n        insertImageMarkdown(file.name, url);\n        showToast(\"success\", \"Image uploaded successfully\");\n      } catch (error) {\n        console.error(\"Upload failed:\", error);\n        showToast(\"error\", `Failed to upload ${file.name}`);\n      }\n    }\n  }\n\n  async function uploadImage(file) {\n    const formData = new FormData();\n    formData.append(\"image\", file);\n\n    // Get CSRF token\n    const csrfInput = form?.querySelector('input[name=\"csrf_token\"]');\n    const csrfToken = csrfInput?.value || \"\";\n\n    const response = await fetch(uploadUrl, {\n      method: \"POST\",\n      headers: {\n        \"X-CSRF-Token\": csrfToken\n      },\n      body: formData\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || \"Upload failed\");\n    }\n\n    const data = await response.json();\n    return data.url;\n  }\n\n  function insertImageMarkdown(filename, url) {\n    if (!contentTextarea) return;\n\n    const { selectionStart, value } = contentTextarea;\n    const before = value.substring(0, selectionStart);\n    const after = value.substring(selectionStart);\n\n    // Insert on a new line if not at the start of a line\n    const needsNewline = before.length > 0 && !before.endsWith(\"\\n\");\n    const imageMarkdown = `${needsNewline ? \"\\n\" : \"\"}![${filename}](${url})\\n`;\n\n    contentTextarea.value = before + imageMarkdown + after;\n    \n    // Position cursor after the inserted image\n    const newPos = selectionStart + imageMarkdown.length;\n    contentTextarea.setSelectionRange(newPos, newPos);\n    contentTextarea.focus();\n\n    // Trigger input event\n    contentTextarea.dispatchEvent(new Event(\"input\", { bubbles: true }));\n  }\n\n  // ============================================\n  // AUTO-SAVE\n  // ============================================\n\n  function setupAutosave() {\n    if (isNewPost) return;\n\n    const autosaveUrl = form?.dataset.autosave;\n    if (!autosaveUrl) return;\n\n    const handleChange = () => {\n      if (hasUnsavedChanges()) {\n        updateStatus(\"unsaved\");\n      }\n\n      if (autosaveTimeout) clearTimeout(autosaveTimeout);\n      autosaveTimeout = setTimeout(() => {\n        performSave(\"save\");\n      }, AUTOSAVE_DELAY);\n    };\n\n    titleInput?.addEventListener(\"input\", handleChange);\n    contentTextarea?.addEventListener(\"input\", handleChange);\n\n    document.querySelectorAll(\"[data-sync]\").forEach((input) => {\n      input.addEventListener(\"input\", handleChange);\n    });\n  }\n\n  async function performSave(action) {\n    if (isNewPost && action === \"save\") return;\n\n    const autosaveUrl = form?.dataset.autosave;\n    if (!autosaveUrl) return;\n\n    updateStatus(\"saving\");\n\n    try {\n      const csrfInput = form?.querySelector('input[name=\"csrf_token\"]');\n      const csrfToken = csrfInput?.value || \"\";\n\n      if (actionField) actionField.value = action;\n\n      const formData = new FormData(form);\n\n      const response = await fetch(autosaveUrl, {\n        method: \"PATCH\",\n        headers: { \"X-CSRF-Token\": csrfToken },\n        body: formData\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        lastSavedContent = getContentSnapshot();\n        updateStatus(\"saved\", data.updated_at);\n\n        if (data.is_draft !== undefined) {\n          updatePublishState(data.is_draft);\n        }\n      } else {\n        const errorText = await response.text();\n        console.error(\"Save failed:\", errorText);\n        updateStatus(\"error\", null, errorText);\n      }\n    } catch (error) {\n      console.error(\"Save error:\", error);\n      updateStatus(\"error\", null, error.message);\n    }\n  }\n\n  // ============================================\n  // STATUS DISPLAY\n  // ============================================\n\n  function updateStatus(state, timestamp, errorMessage) {\n    if (!statusEl) return;\n\n    switch (state) {\n      case \"saving\":\n        statusEl.innerHTML = '<span class=\"editor-status-saving\">Saving...</span>';\n        break;\n      case \"saved\":\n        const timeStr = timestamp ? formatRelativeTime(new Date(timestamp)) : \"just now\";\n        statusEl.innerHTML = `<span class=\"editor-status-saved\" data-updated-at=\"${timestamp || new Date().toISOString()}\">Last saved: ${timeStr}</span>`;\n        break;\n      case \"unsaved\":\n        statusEl.innerHTML = '<span class=\"editor-status-unsaved\">Unsaved changes</span>';\n        break;\n      case \"error\":\n        const msg = errorMessage || \"Save failed\";\n        statusEl.innerHTML = `<span class=\"editor-status-error\">${msg}</span>`;\n        break;\n    }\n  }\n\n  function formatRelativeTime(date) {\n    const now = new Date();\n    const diff = now - date;\n    const seconds = Math.floor(diff / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const hours = Math.floor(minutes / 60);\n    const days = Math.floor(hours / 24);\n\n    if (seconds < 60) return \"just now\";\n    if (minutes === 1) return \"1 minute ago\";\n    if (minutes < 60) return `${minutes} minutes ago`;\n    if (hours === 1) return \"1 hour ago\";\n    if (hours < 24) return `${hours} hours ago`;\n    if (days === 1) return \"yesterday\";\n\n    return date.toLocaleDateString(\"en-US\", {\n      month: \"short\",\n      day: \"numeric\",\n      year: date.getFullYear() !== now.getFullYear() ? \"numeric\" : undefined,\n    });\n  }\n\n  function setupRelativeTimeUpdates() {\n    timeUpdateInterval = setInterval(() => {\n      const savedSpan = statusEl?.querySelector(\"[data-updated-at]\");\n      if (savedSpan) {\n        const timestamp = savedSpan.dataset.updatedAt;\n        if (timestamp) {\n          const timeStr = formatRelativeTime(new Date(timestamp));\n          savedSpan.textContent = `Last saved: ${timeStr}`;\n        }\n      }\n    }, TIME_UPDATE_INTERVAL);\n  }\n\n  // ============================================\n  // ACTION BUTTONS\n  // ============================================\n\n  function setupActionButtons() {\n    document.querySelectorAll('[data-action-btn=\"save\"]').forEach((btn) => {\n      btn.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        if (isNewPost) {\n          if (actionField) actionField.value = \"save\";\n          const draftInput = document.getElementById(\"is_draft\");\n          if (draftInput) draftInput.value = \"true\";\n          form?.submit();\n        } else {\n          performSave(\"save\");\n        }\n      });\n    });\n\n    document.querySelectorAll('[data-action-btn=\"publish\"]').forEach((btn) => {\n      btn.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        if (isNewPost) {\n          if (actionField) actionField.value = \"publish\";\n          const draftInput = document.getElementById(\"is_draft\");\n          if (draftInput) draftInput.value = \"false\";\n          form?.submit();\n        } else {\n          performSave(\"publish\");\n        }\n      });\n    });\n\n    document.querySelectorAll('[data-action-btn=\"unpublish\"]').forEach((btn) => {\n      btn.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        performSave(\"unpublish\");\n      });\n    });\n  }\n\n  function updatePublishState(isDraft) {\n    // Could update button UI dynamically here\n    // For now, state change takes effect on page reload\n  }\n\n  // ============================================\n  // PUBLISH DROPDOWN\n  // ============================================\n\n  function setupPublishDropdown() {\n    const dropdown = document.querySelector(\"[data-dropdown-container]\");\n    if (!dropdown) return;\n\n    const trigger = dropdown.querySelector(\"[data-dropdown-trigger]\");\n    const menu = dropdown.querySelector(\"[data-dropdown-menu]\");\n\n    if (!trigger || !menu) return;\n\n    trigger.addEventListener(\"click\", (e) => {\n      e.stopPropagation();\n      dropdown.classList.toggle(\"open\");\n    });\n\n    document.addEventListener(\"click\", (e) => {\n      if (!dropdown.contains(e.target)) {\n        dropdown.classList.remove(\"open\");\n      }\n    });\n\n    document.addEventListener(\"keydown\", (e) => {\n      if (e.key === \"Escape\") {\n        dropdown.classList.remove(\"open\");\n      }\n    });\n  }\n\n  // ============================================\n  // SIDEBAR SYNC\n  // ============================================\n\n  function setupSidebarSync() {\n    document.querySelectorAll(\"[data-sync]\").forEach((input) => {\n      const targetId = input.dataset.sync;\n      const hiddenInput = document.getElementById(targetId);\n\n      if (!hiddenInput) return;\n\n      input.addEventListener(\"input\", () => {\n        if (input.type === \"checkbox\") {\n          hiddenInput.value = input.checked ? \"true\" : \"false\";\n        } else {\n          hiddenInput.value = input.value;\n        }\n      });\n    });\n\n    // Tag selection sync\n    const tagSelect = document.querySelector(\"ec-tag-select\");\n    if (tagSelect) {\n      tagSelect.addEventListener(\"change\", syncTagsToForm);\n      tagSelect.addEventListener(\"click\", (e) => {\n        if (e.target.type === \"checkbox\") {\n          setTimeout(syncTagsToForm, 0);\n        }\n      });\n    }\n  }\n\n  function syncTagsToForm() {\n    const container = document.getElementById(\"tag-ids-container\");\n    if (!container) return;\n\n    container.innerHTML = \"\";\n\n    const selectedTags = document.querySelectorAll('input[name=\"sidebar_tag_ids\"]:checked');\n    selectedTags.forEach((tag) => {\n      const hiddenInput = document.createElement(\"input\");\n      hiddenInput.type = \"hidden\";\n      hiddenInput.name = \"tag_ids\";\n      hiddenInput.value = tag.value;\n      hiddenInput.dataset.tagId = tag.value;\n      container.appendChild(hiddenInput);\n    });\n  }\n\n  // ============================================\n  // COVER IMAGE PREVIEW\n  // ============================================\n\n  function setupCoverImagePreview() {\n    const coverInput = document.querySelector(\"[data-preview-trigger]\");\n    const previewContainer = document.querySelector(\"[data-cover-preview]\");\n\n    if (!coverInput || !previewContainer) return;\n\n    coverInput.addEventListener(\"input\", () => {\n      if (coverPreviewTimeout) clearTimeout(coverPreviewTimeout);\n      coverPreviewTimeout = setTimeout(() => {\n        updateCoverPreview(coverInput.value, previewContainer);\n      }, COVER_PREVIEW_DELAY);\n    });\n  }\n\n  function updateCoverPreview(url, container) {\n    const existingImg = container.querySelector(\"img\");\n    if (existingImg) existingImg.remove();\n\n    container.classList.remove(\"error\");\n\n    if (!url) return;\n\n    const img = document.createElement(\"img\");\n    img.src = url;\n    img.alt = \"Cover preview\";\n    img.className = \"cover-image-preview-img\";\n\n    img.onload = () => container.classList.remove(\"error\");\n    img.onerror = () => container.classList.add(\"error\");\n\n    container.insertBefore(img, container.firstChild);\n  }\n\n  // ============================================\n  // SLUG GENERATION\n  // ============================================\n\n  function setupSlugGeneration() {\n    if (!titleInput) return;\n\n    const slugInput = document.getElementById(\"slug\");\n    const sidebarSlug = document.getElementById(\"sidebar-slug\");\n\n    let userEditedSlug = false;\n\n    if (sidebarSlug) {\n      sidebarSlug.addEventListener(\"input\", () => {\n        userEditedSlug = true;\n      });\n    }\n\n    titleInput.addEventListener(\"input\", () => {\n      if (userEditedSlug) return;\n\n      const slug = generateSlug(titleInput.value);\n      if (slugInput) slugInput.value = slug;\n      if (sidebarSlug) sidebarSlug.value = slug;\n    });\n  }\n\n  function generateSlug(text) {\n    return text\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, \"\")\n      .replace(/\\s+/g, \"-\")\n      .replace(/-+/g, \"-\")\n      .substring(0, 100);\n  }\n\n  // ============================================\n  // TOAST HELPER\n  // ============================================\n\n  function showToast(type, message) {\n    const toastContainer = document.querySelector(\"ec-toast-container\");\n    if (toastContainer && typeof toastContainer.show === \"function\") {\n      toastContainer.show(message, type);\n    } else {\n      console.log(`[${type}] ${message}`);\n    }\n  }\n\n  // ============================================\n  // CLEANUP\n  // ============================================\n\n  function cleanup() {\n    if (autosaveTimeout) clearTimeout(autosaveTimeout);\n    if (previewTimeout) clearTimeout(previewTimeout);\n    if (coverPreviewTimeout) clearTimeout(coverPreviewTimeout);\n    if (timeUpdateInterval) clearInterval(timeUpdateInterval);\n  }\n\n  // ============================================\n  // STARTUP\n  // ============================================\n\n  if (document.readyState === \"loading\") {\n    document.addEventListener(\"DOMContentLoaded\", init);\n  } else {\n    init();\n  }\n\n  window.addEventListener(\"beforeunload\", cleanup);\n  document.addEventListener(\"htmx:afterSettle\", init);\n})();\n"],
  "mappings": "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",
  "names": ["init", "CONFIG", "init", "init", "CONFIG", "EditorCore", "EditorCore", "init", "init", "escapeHtml"]
}
